<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)</title>
<meta content="Göran Selander" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Höglund" name="author">
<meta content="
       This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.
It utilizes Ephemeral Diffie-Hellman Over COSE (EDHOC) for achieving mutual authentication between an ACE-OAuth client and resource server, and it binds an authentication credential of the client to an ACE-OAuth access token.
EDHOC also establishes an Object Security for Constrained RESTful Environments (OSCORE) Security Context, which is used to secure communications between the client and resource server when accessing protected resources according to the authorization information indicated in the access token.
This profile can be used to delegate management of authorization information from a resource-constrained server to a trusted host with less severe limitations regarding processing power and memory. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-ace-edhoc-oscore-profile-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-ace-edhoc-oscore-profile.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EDHOC and OSCORE profile of ACE</td>
<td class="right">July 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Selander, et al.</td>
<td class="center">Expires 6 January 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-edhoc-oscore-profile-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-07-05" class="published">5 July 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-01-06">6 January 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE</div>
</div>
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.
It utilizes Ephemeral Diffie-Hellman Over COSE (EDHOC) for achieving mutual authentication between an ACE-OAuth client and resource server, and it binds an authentication credential of the client to an ACE-OAuth access token.
EDHOC also establishes an Object Security for Constrained RESTful Environments (OSCORE) Security Context, which is used to secure communications between the client and resource server when accessing protected resources according to the authorization information indicated in the access token.
This profile can be used to delegate management of authorization information from a resource-constrained server to a trusted host with less severe limitations regarding processing power and memory.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-ace-edhoc-oscore-profile/">https://datatracker.ietf.org/doc/draft-ietf-ace-edhoc-oscore-profile/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Authentication and Authorization for Constrained Environments (ace) Working Group mailing list (<span><a href="mailto:ace@ietf.org">mailto:ace@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/ace/">https://mailarchive.ietf.org/arch/browse/ace/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/ace/">https://www.ietf.org/mailman/listinfo/ace/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ace-wg/ace-edhoc-oscore-profile">https://github.com/ace-wg/ace-edhoc-oscore-profile</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 January 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-client-as-communication" class="internal xref">Client-AS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-c-to-as-post-to-token-endpo" class="internal xref">C-to-AS: POST to /token endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-token-series" class="internal xref">Token Series</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-as-to-c-response" class="internal xref">AS-to-C: Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-access-token" class="internal xref">Access Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-processing-at-c" class="internal xref">Processing at C</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-update-of-access-rights" class="internal xref">Update of Access Rights</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-edhoc_information" class="internal xref">EDHOC_Information</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-client-rs-communication" class="internal xref">Client-RS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-ead-items-for-access-token-" class="internal xref">EAD items for Access Token and Session Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-edhoc-session" class="internal xref">EDHOC Session</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-forward-message-flow" class="internal xref">Forward Message Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-edhoc-message_1" class="internal xref">EDHOC message_1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-edhoc-message_2" class="internal xref">EDHOC message_2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="auto internal xref">4.3.3</a>.  <a href="#name-edhoc-message_3" class="internal xref">EDHOC message_3</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-reverse-message-flow" class="internal xref">Reverse Message Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-trigger-message" class="internal xref">Trigger Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-edhoc-message_1-2" class="internal xref">EDHOC message_1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-edhoc-message_2-2" class="internal xref">EDHOC message_2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="auto internal xref">4.4.4</a>.  <a href="#name-edhoc-message_3-2" class="internal xref">EDHOC message_3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.5">
                    <p id="section-toc.1-1.4.2.4.2.5.1"><a href="#section-4.4.5" class="auto internal xref">4.4.5</a>.  <a href="#name-edhoc-message_4" class="internal xref">EDHOC message_4</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-oscore-security-context" class="internal xref">OSCORE Security Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-update-of-access-rights-2" class="internal xref">Update of Access Rights</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="auto internal xref">4.6.1</a>.  <a href="#name-c-to-rs-post-to-authz-info-" class="internal xref">C-to-RS: POST to /authz-info endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.2">
                    <p id="section-toc.1-1.4.2.6.2.2.1"><a href="#section-4.6.2" class="auto internal xref">4.6.2</a>.  <a href="#name-rs-to-c-201-created" class="internal xref">RS-to-C: 2.01 (Created)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-discarding-the-oscore-secur" class="internal xref">Discarding the OSCORE Security Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-establishing-a-new-oscore-s" class="internal xref">Establishing a New OSCORE Security Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-access-rights-verification" class="internal xref">Access Rights Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="auto internal xref">4.10</a>. <a href="#name-access-token-invalidity" class="internal xref">Access Token Invalidity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.11">
                <p id="section-toc.1-1.4.2.11.1"><a href="#section-4.11" class="auto internal xref">4.11</a>. <a href="#name-authentication-credential-i" class="internal xref">Authentication Credential Invalidity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.12">
                <p id="section-toc.1-1.4.2.12.1"><a href="#section-4.12" class="auto internal xref">4.12</a>. <a href="#name-edhoc-session-invalidity" class="internal xref">EDHOC Session Invalidity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.13">
                <p id="section-toc.1-1.4.2.13.1"><a href="#section-4.13" class="auto internal xref">4.13</a>. <a href="#name-using-as-request-creation-h" class="internal xref">Using AS Request Creation Hints</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.14">
                <p id="section-toc.1-1.4.2.14.1"><a href="#section-4.14" class="auto internal xref">4.14</a>. <a href="#name-requesting-authentication-c" class="internal xref">Requesting Authentication Credential By Value</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-secure-communication-with-a" class="internal xref">Secure Communication with AS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-cwt-confirmation-methods" class="internal xref">CWT Confirmation Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-ordered-chain-of-x509-certi" class="internal xref">Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-unordered-bag-of-x509-certi" class="internal xref">Unordered Bag of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-hash-of-an-x509-certificate" class="internal xref">Hash of an X.509 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-uri-pointing-to-an-ordered-" class="internal xref">URI Pointing to an Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-ordered-chain-of-c509-certi" class="internal xref">Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-unordered-bag-of-c509-certi" class="internal xref">Unordered Bag of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-hash-of-a-c509-certificate" class="internal xref">Hash of a C509 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-uri-pointing-to-an-ordered-c" class="internal xref">URI Pointing to an Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-cwt-containing-a-cose_key" class="internal xref">CWT Containing a COSE_Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-ccs-containing-a-cose_key" class="internal xref">CCS Containing a COSE_Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-jwt-confirmation-methods" class="internal xref">JWT Confirmation Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-ordered-chain-of-x509-certif" class="internal xref">Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-unordered-bag-of-x509-certif" class="internal xref">Unordered Bag of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-hash-of-an-x509-certificate-2" class="internal xref">Hash of an X.509 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-uri-pointing-to-an-ordered-ch" class="internal xref">URI Pointing to an Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-ordered-chain-of-c509-certif" class="internal xref">Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-unordered-bag-of-c509-certif" class="internal xref">Unordered Bag of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-hash-of-a-c09-certificate" class="internal xref">Hash of a C09 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-uri-pointing-to-an-ordered-cha" class="internal xref">URI Pointing to an Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-cwt-containing-a-cose_key-2" class="internal xref">CWT Containing a COSE_Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="auto internal xref">7.10</a>. <a href="#name-ccs-containing-a-cose_key-2" class="internal xref">CCS Containing a COSE_Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-edhoc-endpoint-identity-typ" class="internal xref">EDHOC Endpoint Identity Types</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-edhoc-transports" class="internal xref">EDHOC Transports</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-edhoc-trust-anchor-purposes" class="internal xref">EDHOC Trust Anchor Purposes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-edhoc-trust-anchor-types" class="internal xref">EDHOC Trust Anchor Types</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-ace-profiles-registry" class="internal xref">ACE Profiles Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-oauth-parameters-registry" class="internal xref">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="internal xref">OAuth Parameters CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="auto internal xref">14.4</a>.  <a href="#name-json-web-token-claims-regis" class="internal xref">JSON Web Token Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="auto internal xref">14.5</a>.  <a href="#name-cbor-web-token-cwt-claims-r" class="internal xref">CBOR Web Token (CWT) Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="auto internal xref">14.6</a>.  <a href="#name-jwt-confirmation-methods-re" class="internal xref">JWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#section-14.7" class="auto internal xref">14.7</a>.  <a href="#name-cwt-confirmation-methods-re" class="internal xref">CWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.8">
                <p id="section-toc.1-1.14.2.8.1"><a href="#section-14.8" class="auto internal xref">14.8</a>.  <a href="#name-edhoc-external-authorizatio" class="internal xref">EDHOC External Authorization Data Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.9">
                <p id="section-toc.1-1.14.2.9.1"><a href="#section-14.9" class="auto internal xref">14.9</a>.  <a href="#name-edhoc-information-registry" class="internal xref">EDHOC Information Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.10">
                <p id="section-toc.1-1.14.2.10.1"><a href="#section-14.10" class="auto internal xref">14.10</a>. <a href="#name-edhoc-endpoint-identity-types" class="internal xref">EDHOC Endpoint Identity Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.11">
                <p id="section-toc.1-1.14.2.11.1"><a href="#section-14.11" class="auto internal xref">14.11</a>. <a href="#name-edhoc-transports-registry" class="internal xref">EDHOC Transports Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.12">
                <p id="section-toc.1-1.14.2.12.1"><a href="#section-14.12" class="auto internal xref">14.12</a>. <a href="#name-edhoc-trust-anchor-purposes-" class="internal xref">EDHOC Trust Anchor Purposes Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.13">
                <p id="section-toc.1-1.14.2.13.1"><a href="#section-14.13" class="auto internal xref">14.13</a>. <a href="#name-edhoc-trust-anchor-types-re" class="internal xref">EDHOC Trust Anchor Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.14">
                <p id="section-toc.1-1.14.2.14.1"><a href="#section-14.14" class="auto internal xref">14.14</a>. <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-workflow-without-optimizati" class="internal xref">Workflow without Optimizations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-workflow-with-optimizations" class="internal xref">Workflow with Optimizations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-profile-requirements" class="internal xref">Profile Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-cddl-model" class="internal xref">CDDL Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-version-07-to-08" class="internal xref">Version -07 to -08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-version-06-to-07" class="internal xref">Version -06 to -07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#appendix-D.3" class="auto internal xref">D.3</a>.  <a href="#name-version-05-to-06" class="internal xref">Version -05 to -06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4">
                <p id="section-toc.1-1.19.2.4.1"><a href="#appendix-D.4" class="auto internal xref">D.4</a>.  <a href="#name-version-04-to-05" class="internal xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.5">
                <p id="section-toc.1-1.19.2.5.1"><a href="#appendix-D.5" class="auto internal xref">D.5</a>.  <a href="#name-version-03-to-04" class="internal xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.6">
                <p id="section-toc.1-1.19.2.6.1"><a href="#appendix-D.6" class="auto internal xref">D.6</a>.  <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.7">
                <p id="section-toc.1-1.19.2.7.1"><a href="#appendix-D.7" class="auto internal xref">D.7</a>.  <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.8">
                <p id="section-toc.1-1.19.2.8.1"><a href="#appendix-D.8" class="auto internal xref">D.8</a>.  <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines the "coap_edhoc_oscore" profile of the ACE-OAuth framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. This profile addresses a "zero-touch" constrained setting where authenticated and authorized operations can be performed with low overhead without endpoint specific configurations.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Like in the "coap_oscore" profile <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, also in this profile a client (C) and a resource server (RS) use the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> to communicate, and Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> to protect their communications. However, this profile uses the Ephemeral Diffie-Hellman Over COSE (EDHOC) protocol <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> to establish the OSCORE Security Context. The processing of requests for specific protected resources is identical to what is defined in the "coap_oscore" profile.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">When using this profile, C accesses protected resources hosted at RS according to the authorization information specified in an access token, which is issued by a trusted authorization server (AS) and is bound to an authentication credential of C. This differs from the "coap_oscore" profile, where the access token is bound to a secret that is generated by AS and is used to derive the OSCORE Security Context.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Whereas <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> recommends the use of CBOR Web Tokens (CWTs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> as access tokens, this profile requires it (see <a href="#access-token" class="auto internal xref">Section 3.3.1</a>). Furthermore, this profile requires that, for messages exchanged between C and AS to request and provide an access token, the payload is encoded in CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> (see <a href="#c-as" class="auto internal xref">Section 3.1</a> and <a href="#as-c" class="auto internal xref">Section 3.3</a>), which ACE requires if CoAP is used (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5" class="relref">Section 5</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>) and recommends otherwise (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-3" class="relref">Section 3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">An authentication credential can be a raw public key, e.g., encoded as a CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>; or a public key certificate, e.g., an X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> or a CBOR-encoded C509 certificate <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>); or a different type of data structure containing the public key of the peer in question.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The ACE framework establishes what those authentication credentials are, and may transport the actual authentication credentials by value or uniquely refer to them. If an authentication credential is pre-provisioned or can be obtained over less constrained links, then it suffices that ACE provides a unique reference such as a certificate hash (e.g., by using the COSE header parameter "x5t" <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>). This is in the same spirit as EDHOC, where the authentication credentials specified in the ID_CRED_x message fields can be transported by value or referred to (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3" class="relref">Section 3.5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">In general, AS and RS are likely to have trusted access to each other's authentication credentials, since AS acts on behalf of RS as per the trust model of ACE. Also, AS needs to have some information about C, including the relevant authentication credential, in order to identify C when it requests an access token and to determine what access rights it can be granted. However, the authentication credential of C may potentially be conveyed (or uniquely referred to) within the request for an access token that C makes to AS.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">The establishment of an association between RS and AS in an ACE ecosystem is out of scope, but one solution is to build on the same primitives as used in this document, i.e., EDHOC for authentication and OSCORE for communication security, using for example <span>[<a href="#I-D.ietf-lake-authz" class="cite xref">I-D.ietf-lake-authz</a>]</span> for onboarding RS with AS and <span>[<a href="#I-D.ietf-ace-coap-est-oscore" class="cite xref">I-D.ietf-ace-coap-est-oscore</a>]</span> for establishing a trust anchor in RS. A similar procedure can also be applied between C and AS for registering a client and for the establishment of a trust anchor.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Certain security-related terms such as "authentication", "authorization", "confidentiality", "(data) integrity", "Message Authentication Code (MAC)", "Hash-based Message Authentication Code (HMAC)", and "verify" are taken from <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">RESTful terminology follows HTTP <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">Readers are expected to be familiar with the terms and concepts defined in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Readers are also expected to be familiar with the terms and concepts of the ACE framework described in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">Terminology for entities in the architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, such as the client (C), the resource server (RS), and the authorization server (AS).  It is assumed in this document that a given resource on a specific RS is associated with a unique AS.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">Note that the term "endpoint" is used here, as in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, following its OAuth definition, which is to denote resources such as /token and /introspect at AS, and /authz-info at RS. The CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> definition, which is "An entity participating in the CoAP protocol", is not used in this document.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8">The authorization information (authz-info) resource refers to the authorization information endpoint as specified in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. The term "claim" is used in this document with the same semantics as in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, i.e., it denotes information carried in the access token or returned from introspection.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9">Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span><span>[<a href="#RFC8742" class="cite xref">RFC8742</a>]</span> and Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> are used in this document. CDDL predefined type names, especially bstr for CBOR byte strings and tstr for CBOR text strings, are used extensively in this document.<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10">Examples throughout this document are expressed in CBOR diagnostic notation as defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. Diagnostic notation comments are often used to provide a textual representation of the numeric parameter names and values.<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<p id="section-1.1-11">In the CBOR diagnostic notation used in this document, constructs of the form e'SOME_NAME' are replaced by the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 11</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix C</a>. For example, {e'session_id' : h'01', e'cipher_suites': 3} stands for {0 : h'01', 2 : 3}.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12">Note to RFC Editor: Please delete the paragraph immediately preceding this note. Also, in the CBOR diagnostic notation used in this document, please replace the constructs of the form e'SOME_NAME' with the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 11</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix C</a>. Finally, please delete this note.<a href="#section-1.1-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">This section gives an overview of how to use the ACE framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> together with the lightweight authenticated key exchange protocol EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. By doing so, the client (C) and the resource server (RS) generate an OSCORE Security Context <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> associated with authorization information, and use that Security Context to protect their communications. The parameters needed by C to negotiate the use of this profile with the authorization server (AS), as well as the OSCORE setup process, are described in detail in the following sections.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">RS maintains a collection of authentication credentials. These are associated with OSCORE Security Contexts and with authorization information for all clients that RS is communicating with. The authorization information is used to enforce policies for processing requests from those clients.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The ACE framework describes how integrity protected authorization information propagates from AS to RS. This profile describes how C requests from AS an access token specifying authorization information for the resources that C wants to access at RS, by sending an access token request to the /token endpoint at AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">Section 5.8</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">If the request is granted, then AS can provide C with an access token when sending a response to C, or instead upload the access token directly to RS as per the alternative workflow defined in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>. The latter option is not detailed further in this document.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">After that, C and RS run the EDHOC protocol, with C using the authentication credential of RS obtained from AS. If C has obtained an access token from AS, then C specifies the access token within an External Authorization Data (EAD) field of an EDHOC message sent during the EDHOC session (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). RS uses the authentication credential of C bound to and specified in the access token. How C and RS run EDHOC is detailed in <a href="#edhoc-exec" class="auto internal xref">Section 4.2</a>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">If C and RS successfully complete the EDHOC execution and the validation of each other's authentication credential, they are mutually authenticated and derive the OSCORE Security Context as per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7"><a href="#protocol-overview" class="auto internal xref">Figure 1</a> outlines an example of the message flow. A more detailed description of the message flow is shown in <a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a>.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">From then on and as long as there is a valid access token, C effectively gains authorized and secure access to protected resources at RS using the established OSCORE Security Context. When RS receives a request from C protected with an OSCORE Security Context derived from an EDHOC session implementing this profile, then that OSCORE Security Context is used to retrieve the uniquely associated access token determining the access rights of C.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">The OSCORE Security Context is discarded when an access token (whether the same or a different one) is used to successfully derive a new OSCORE Security Context for C.<a href="#section-2-9" class="pilcrow">¶</a></p>
<span id="name-protocol-outline-using-the-"></span><div id="protocol-overview">
<figure id="figure-1">
        <div id="section-2-10.1">
          <div class="alignLeft art-svg artwork" id="section-2-10.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="480" viewBox="0 0 480 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 32,48 L 32,256" fill="none" stroke="black"></path>
              <path d="M 32,304 L 32,480" fill="none" stroke="black"></path>
              <path d="M 264,160 L 264,368" fill="none" stroke="black"></path>
              <path d="M 264,416 L 264,480" fill="none" stroke="black"></path>
              <path d="M 472,48 L 472,480" fill="none" stroke="black"></path>
              <path d="M 48,62 L 80,62" fill="none" stroke="black"></path>
              <path d="M 48,66 L 80,66" fill="none" stroke="black"></path>
              <path d="M 424,62 L 456,62" fill="none" stroke="black"></path>
              <path d="M 424,66 L 456,66" fill="none" stroke="black"></path>
              <path d="M 32,96 L 96,96" fill="none" stroke="black"></path>
              <path d="M 216,96 L 464,96" fill="none" stroke="black"></path>
              <path d="M 40,128 L 304,128" fill="none" stroke="black"></path>
              <path d="M 424,128 L 472,128" fill="none" stroke="black"></path>
              <path d="M 32,176 L 88,176" fill="none" stroke="black"></path>
              <path d="M 208,176 L 256,176" fill="none" stroke="black"></path>
              <path d="M 40,224 L 88,224" fill="none" stroke="black"></path>
              <path d="M 208,224 L 264,224" fill="none" stroke="black"></path>
              <path d="M 32,320 L 88,320" fill="none" stroke="black"></path>
              <path d="M 208,320 L 256,320" fill="none" stroke="black"></path>
              <path d="M 32,432 L 72,432" fill="none" stroke="black"></path>
              <path d="M 208,432 L 256,432" fill="none" stroke="black"></path>
              <path d="M 40,464 L 72,464" fill="none" stroke="black"></path>
              <path d="M 216,464 L 256,464" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="472,96 460,90.4 460,101.6" fill="black" transform="rotate(0,464,96)"></polygon>
              <polygon class="arrowhead" points="464,64 452,58.4 452,69.6" fill="black" transform="rotate(0,456,64)"></polygon>
              <polygon class="arrowhead" points="264,432 252,426.4 252,437.6" fill="black" transform="rotate(0,256,432)"></polygon>
              <polygon class="arrowhead" points="264,320 252,314.4 252,325.6" fill="black" transform="rotate(0,256,320)"></polygon>
              <polygon class="arrowhead" points="264,176 252,170.4 252,181.6" fill="black" transform="rotate(0,256,176)"></polygon>
              <polygon class="arrowhead" points="56,64 44,58.4 44,69.6" fill="black" transform="rotate(180,48,64)"></polygon>
              <polygon class="arrowhead" points="48,464 36,458.4 36,469.6" fill="black" transform="rotate(180,40,464)"></polygon>
              <polygon class="arrowhead" points="48,224 36,218.4 36,229.6" fill="black" transform="rotate(180,40,224)"></polygon>
              <polygon class="arrowhead" points="48,128 36,122.4 36,133.6" fill="black" transform="rotate(180,40,128)"></polygon>
              <g class="text">
                <text x="32" y="36">C</text>
                <text x="268" y="36">RS</text>
                <text x="468" y="36">AS</text>
                <text x="264" y="52">|</text>
                <text x="116" y="68">Mutual</text>
                <text x="204" y="68">authentication</text>
                <text x="280" y="68">and</text>
                <text x="324" y="68">secure</text>
                <text x="384" y="68">channel</text>
                <text x="264" y="84">|</text>
                <text x="124" y="100">POST</text>
                <text x="172" y="100">/token</text>
                <text x="264" y="116">|</text>
                <text x="340" y="132">Access</text>
                <text x="392" y="132">Token</text>
                <text x="288" y="148">+</text>
                <text x="324" y="148">Access</text>
                <text x="400" y="148">Information</text>
                <text x="116" y="180">POST</text>
                <text x="164" y="180">/edhoc</text>
                <text x="100" y="196">(EDHOC</text>
                <text x="172" y="196">message_1)</text>
                <text x="116" y="228">2.04</text>
                <text x="168" y="228">Changed</text>
                <text x="100" y="244">(EDHOC</text>
                <text x="172" y="244">message_2)</text>
                <text x="8" y="276">/</text>
                <text x="60" y="276">Derivation</text>
                <text x="116" y="276">of</text>
                <text x="156" y="276">OSCORE</text>
                <text x="36" y="292">Security</text>
                <text x="104" y="292">Context</text>
                <text x="144" y="292">/</text>
                <text x="116" y="324">POST</text>
                <text x="164" y="324">/edhoc</text>
                <text x="84" y="340">(EDHOC</text>
                <text x="152" y="340">message_3</text>
                <text x="212" y="340">with</text>
                <text x="108" y="356">access_token</text>
                <text x="172" y="356">in</text>
                <text x="212" y="356">EAD_3)</text>
                <text x="168" y="388">/</text>
                <text x="220" y="388">Derivation</text>
                <text x="276" y="388">of</text>
                <text x="316" y="388">OSCORE</text>
                <text x="212" y="404">Security</text>
                <text x="280" y="404">Context</text>
                <text x="320" y="404">/</text>
                <text x="108" y="436">OSCORE</text>
                <text x="168" y="436">Request</text>
                <text x="108" y="468">OSCORE</text>
                <text x="172" y="468">Response</text>
              </g>
            </svg><a href="#section-2-10.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-outline-using-the-" class="selfRef">Protocol Outline using the EDHOC Forward Message Flow.</a>
        </figcaption></figure>
</div>
<p id="section-2-11">As long as the OSCORE Security Context and the access token are valid, C can contact AS to request an update of its access rights, by sending a similar request as described above to the /token endpoint. This request also includes a "session identifier" (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>) provided by AS in the response to the initial access token request, which allows AS to retrieve the data that it previously shared with C. The session identifier is assigned by AS and used to identify a series of access tokens, called a "token series" (see <a href="#token-series" class="auto internal xref">Section 3.2</a>).<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">If C has obtained an access token from AS for updating its access rights belonging to the same token series, then C transfers the access token to RS using the /authz-info endpoint as specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10" class="relref">Section 5.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, where the exchanged CoAP messages are protected by the previously established OSCORE Security Context (see <a href="#update-access-rights-c-rs" class="auto internal xref">Section 4.6</a>). If the access token is valid, RS replies to the request with a 2.01 (Created) response.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">Upon successful update of access rights, the new issued access token effectively becomes the latest in its token series also for RS, but the session identifier remains the same. When the latest access token of a token series becomes invalid (e.g., when it expires or gets revoked), that token series ends.<a href="#section-2-13" class="pilcrow">¶</a></p>
<p id="section-2-14"><a href="#update-overview" class="auto internal xref">Figure 2</a> outlines the message flow for updating access rights.<a href="#section-2-14" class="pilcrow">¶</a></p>
<span id="name-protocol-outline-for-updati"></span><div id="update-overview">
<figure id="figure-2">
        <div id="section-2-15.1">
          <div class="alignLeft art-svg artwork" id="section-2-15.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="400" width="456" viewBox="0 0 456 400" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,368" fill="none" stroke="black"></path>
              <path d="M 240,160 L 240,224" fill="none" stroke="black"></path>
              <path d="M 240,256 L 240,368" fill="none" stroke="black"></path>
              <path d="M 448,48 L 448,368" fill="none" stroke="black"></path>
              <path d="M 24,62 L 56,62" fill="none" stroke="black"></path>
              <path d="M 24,66 L 56,66" fill="none" stroke="black"></path>
              <path d="M 400,62 L 432,62" fill="none" stroke="black"></path>
              <path d="M 400,66 L 432,66" fill="none" stroke="black"></path>
              <path d="M 8,96 L 72,96" fill="none" stroke="black"></path>
              <path d="M 192,96 L 440,96" fill="none" stroke="black"></path>
              <path d="M 16,128 L 280,128" fill="none" stroke="black"></path>
              <path d="M 400,128 L 448,128" fill="none" stroke="black"></path>
              <path d="M 8,176 L 32,176" fill="none" stroke="black"></path>
              <path d="M 192,176 L 232,176" fill="none" stroke="black"></path>
              <path d="M 16,272 L 64,272" fill="none" stroke="black"></path>
              <path d="M 184,272 L 240,272" fill="none" stroke="black"></path>
              <path d="M 8,320 L 48,320" fill="none" stroke="black"></path>
              <path d="M 184,320 L 232,320" fill="none" stroke="black"></path>
              <path d="M 16,352 L 48,352" fill="none" stroke="black"></path>
              <path d="M 192,352 L 232,352" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="448,96 436,90.4 436,101.6" fill="black" transform="rotate(0,440,96)"></polygon>
              <polygon class="arrowhead" points="440,64 428,58.4 428,69.6" fill="black" transform="rotate(0,432,64)"></polygon>
              <polygon class="arrowhead" points="240,320 228,314.4 228,325.6" fill="black" transform="rotate(0,232,320)"></polygon>
              <polygon class="arrowhead" points="240,176 228,170.4 228,181.6" fill="black" transform="rotate(0,232,176)"></polygon>
              <polygon class="arrowhead" points="32,64 20,58.4 20,69.6" fill="black" transform="rotate(180,24,64)"></polygon>
              <polygon class="arrowhead" points="24,352 12,346.4 12,357.6" fill="black" transform="rotate(180,16,352)"></polygon>
              <polygon class="arrowhead" points="24,272 12,266.4 12,277.6" fill="black" transform="rotate(180,16,272)"></polygon>
              <polygon class="arrowhead" points="24,128 12,122.4 12,133.6" fill="black" transform="rotate(180,16,128)"></polygon>
              <g class="text">
                <text x="8" y="36">C</text>
                <text x="244" y="36">RS</text>
                <text x="444" y="36">AS</text>
                <text x="240" y="52">|</text>
                <text x="164" y="68">Existing</text>
                <text x="236" y="68">security</text>
                <text x="304" y="68">context</text>
                <text x="240" y="84">|</text>
                <text x="100" y="100">POST</text>
                <text x="148" y="100">/token</text>
                <text x="240" y="116">|</text>
                <text x="316" y="132">Access</text>
                <text x="368" y="132">Token</text>
                <text x="264" y="148">+</text>
                <text x="300" y="148">Access</text>
                <text x="376" y="148">Information</text>
                <text x="60" y="180">POST</text>
                <text x="128" y="180">/authz-info</text>
                <text x="56" y="196">(OSCORE</text>
                <text x="128" y="196">protected</text>
                <text x="188" y="196">with</text>
                <text x="84" y="212">access_token</text>
                <text x="148" y="212">in</text>
                <text x="196" y="212">payload)</text>
                <text x="136" y="244">/</text>
                <text x="176" y="244">Updated</text>
                <text x="236" y="244">access</text>
                <text x="292" y="244">rights</text>
                <text x="328" y="244">/</text>
                <text x="92" y="276">2.04</text>
                <text x="144" y="276">Changed</text>
                <text x="84" y="324">OSCORE</text>
                <text x="144" y="324">Request</text>
                <text x="84" y="356">OSCORE</text>
                <text x="148" y="356">Response</text>
              </g>
            </svg><a href="#section-2-15.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-protocol-outline-for-updati" class="selfRef">Protocol Outline for Updating Access Rights.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="c-as-comm">
<section id="section-3">
      <h2 id="name-client-as-communication">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-client-as-communication" class="section-name selfRef">Client-AS Communication</a>
      </h2>
<p id="section-3-1">The following subsections describe the details of the POST request and response to the /token endpoint between C and AS.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">In this exchange, C provides AS with its own authentication credential AUTH_CRED_C. Then, AS issues the access token as securely bound to AUTH_CRED_C, by including it or uniquely referring to it in the access token. Together with the access token, AS provides C with a set of parameters that enable C to run EDHOC with RS. In particular, these parameters include information about the authentication credential AUTH_CRED_RS of RS, which is transported by value or uniquely referred to.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The request to the /token endpoint and the corresponding response can include EDHOC_Information, which is a CBOR map object containing information related to an EDHOC implementation (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>). This object is transported in the "edhoc_info" parameter registered in <a href="#iana-oauth-params" class="auto internal xref">Section 14.2</a> and <a href="#iana-oauth-cbor-mappings" class="auto internal xref">Section 14.3</a>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="c-as">
<section id="section-3.1">
        <h3 id="name-c-to-as-post-to-token-endpo">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-c-to-as-post-to-token-endpo" class="section-name selfRef">C-to-AS: POST to /token endpoint</a>
        </h3>
<p id="section-3.1-1">The client-to-AS request is specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The client <span class="bcp14">MUST</span> send this POST request to the /token endpoint over a secure channel that guarantees authentication, message integrity, and confidentiality (see <a href="#secure-comm-as" class="auto internal xref">Section 5</a>).<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">When using this profile, the payload of the POST request <span class="bcp14">MUST</span> be encoded in CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, i.e., the request has media-type "application/ace+cbor". In order to reduce the number of libraries that C has to support, it is <span class="bcp14">RECOMMENDED</span> that C and AS use CoAP as message transfer protocol, OSCORE as security protocol, and EDHOC to establish an OSCORE Security Context.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">AUTH_CRED_C is specified in the "req_cnf" parameter <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span> of the POST request, either transported by value or uniquely referred to. AS could explicitly ask C to provide its authentication credential AUTH_CRED_C by value in the Access Token Request, e.g., by relying on the method defined in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">For AUTH_CRED_C, its authentication credential type <span class="bcp14">MUST</span> be one of those supported by EDHOC, e.g., CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Consequently, the "req_cnf" parameter <span class="bcp14">MUST</span> specify a confirmation method suitable for the type of AUTH_CRED_C, e.g., "x5chain" or "x5t" when AUTH_CRED_C is an X.509 certificate transported by value or referred to, respectively.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">Note that EDHOC does not admit the use of "naked" COSE_Keys as authentication credentials. The closest admitted authentication credential type is a CCS containing a COSE_Key in a "cnf" claim and possibly other claims, which can be transported by value using the confirmation method "kccs". Therefore, the "req_cnf" parameter <span class="bcp14">MUST NOT</span> specify the confirmation method "COSE_Key" (CBOR abbreviation: 1).<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">When receiving an Access Token request including the "req_cnf" parameter, AS checks whether it is already storing the authentication credential of C, namely AUTH_CRED_C, specified in "req_cnf" by value or reference.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">If this is not the case, AS retrieves AUTH_CRED_C, either using the "req_cnf" parameter or some other trusted source. After that, AS validates the actual AUTH_CRED_C.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">In either case, the AS also needs to verify that C is in possession of the private key corresponding to the public key associated with AUTH_CRED_C. This may already have been accomplished, for example, by C authenticating to AS using AUTH_CRED_C as authentication credential, or by some other trusted party vouching for C to the AS. Alternatively, it is possible to use an approach for achieving proof-of-possession similar to that in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-group-oscore-profile-04#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-ace-group-oscore-profile" class="cite xref">I-D.ietf-ace-group-oscore-profile</a>]</span>.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">In case of successful validations, AS stores AUTH_CRED_C as a valid authentication credential. Otherwise, the Client-to-AS request <span class="bcp14">MUST</span> be declined.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">An example of client-to-AS request is shown in <a href="#token-request" class="auto internal xref">Figure 3</a>. In this example, C specifies its own authentication credential by reference, as the hash of an X.509 certificate carried in the "x5t" field of the "req_cnf" parameter.<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<span id="name-example-of-c-to-as-post-tok"></span><div id="token-request">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.1-12.1">
<pre>
   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: application/ace+cbor
   Payload:
   {
     / audience / 5 : "tempSensor4711",
     / scope /    9 : "read",
     / req_cnf /  4 : {
       e'x5t' : [-15, h'79F2A41B510C1F9B']
     }
   }
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-c-to-as-post-tok" class="selfRef">Example of C-to-AS POST /token request for an access token.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-13">If C wants to update its access rights without changing an existing OSCORE Security Context, it <span class="bcp14">MUST</span> specify an EDHOC_Information object in the "edhoc_info" parameter of its POST request to the /token endpoint. The EDHOC_Information object <span class="bcp14">MUST</span> include the "session_id" field. This POST request <span class="bcp14">MUST NOT</span> include the "req_cnf" parameter. An example of such a request is shown in <a href="#token-request-update" class="auto internal xref">Figure 4</a>.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">The identifier "session_id" is assigned by AS as discussed in <a href="#token-series" class="auto internal xref">Section 3.2</a>, and identifies an ongoing token series associated with the pair (AUTH_CRED_C, AUTH_CRED_RS). That is, previous access tokens in that series were issued by AS to C, as bound to AUTH_CRED_C and intended for RS as identified by AUTH_CRED_RS.<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">Note that the same "session_id" value might identify multiple ongoing token series, e.g., if those are associated with the same client but different resource servers. In this case, AS can use the "session_id" value together with other information such as the targeted audience (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>) and the authenticated identity of C, in order to determine the exact token series to which the new requested access token has to be added.<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">If the identifier specified in the "session_id" parameter of the POST request identifies multiple, ongoing token series of which C has an access token, then C <span class="bcp14">MUST</span> specify the "audience" parameter in the POST request. In particular, the value of the "audience" parameter <span class="bcp14">MUST</span> be the same value of the "audience" parameter in the POST request that C previously sent to AS, for requesting the first access token in the token series to which the new requested access token has to be added.<a href="#section-3.1-16" class="pilcrow">¶</a></p>
<p id="section-3.1-17">AS <span class="bcp14">MUST</span> verify that the received "session_id" identifies a token series to which a still valid access token issued for C and RS belongs. If that is not the case, the Client-to-AS request <span class="bcp14">MUST</span> be declined with the error code "invalid_request" as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.1-17" class="pilcrow">¶</a></p>
<span id="name-example-of-c-to-as-post-toke"></span><div id="token-request-update">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.1-18.1">
<pre>
   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: application/ace+cbor
   Payload:
   {
     / audience /      5 : "tempSensor4711",
     / scope /         9 : "write",
     e'edhoc_info_param' : {
        e'session_id' : h'01'
     }
   }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-c-to-as-post-toke" class="selfRef">Example of C-to-AS POST /token request for updating access rights to an access token.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="token-series">
<section id="section-3.2">
        <h3 id="name-token-series">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-token-series" class="section-name selfRef">Token Series</a>
        </h3>
<p id="section-3.2-1">This document refers to "token series" as a series of access tokens that are sorted in chronological order of release and are characterized by the following properties:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">Issued by the same AS.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">Issued to the same C, and associated with the same authentication credential of C.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">Issued for the same RS as identified by the same authentication credential.<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">Upon a successful update of access rights (see <a href="#update-access-rights-c-as" class="auto internal xref">Section 3.3.3</a>), the new issued access token becomes the latest in its token series. When the latest access token of a token series becomes invalid (e.g., due to its expiration or revocation), the token series it belongs to ends.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">In this profile, a token series comprises access tokens that are used between a given pair (C, RS), are bound to the same authentication credential AUTH_CRED_C of C, and specify the same value in the "session_id" field of the EDHOC_Information object (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>) in their "edhoc_info" claim.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">AS assigns the value of "session_id" when issuing the first access token of a new series. That "session_id" value remains fixed throughout the series lifetime.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">When assigning the "session_id" value, AS <span class="bcp14">MUST</span> ensure that it was not used in a previous series whose access tokens share both the following properties with the access tokens of the new series, irrespective of the used ACE profile:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-7.1">
            <p id="section-3.2-7.1.1">issued to the same client C; and<a href="#section-3.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-7.2">
            <p id="section-3.2-7.2.1">issued for the same RS.<a href="#section-3.2-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-8">In case the access token is issued for a group-audience (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), what is defined above applies, with the difference that the token series is associated with all the RSs in the group-audience, as indicated by their respective AUTH_CRED_RS.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-c">
<section id="section-3.3">
        <h3 id="name-as-to-c-response">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-as-to-c-response" class="section-name selfRef">AS-to-C: Response</a>
        </h3>
<p id="section-3.3-1">After verifying the POST request to the /token endpoint and that C is authorized to access protected resources at RS, AS responds as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, with potential modifications as detailed below.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">When using this profile, consistent with what is specified in <a href="#c-as" class="auto internal xref">Section 3.1</a>, the payload of the response from AS <span class="bcp14">MUST</span> be encoded in CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, i.e., the response has media-type "application/ace+cbor".<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">If the request from C was invalid or not authorized, AS returns an error response as described in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">AS can signal that the use of EDHOC and OSCORE as per this profile is <span class="bcp14">REQUIRED</span> for a specific access token, by including the "ace_profile" parameter with the value "coap_edhoc_oscore" in the access token response. This means that C <span class="bcp14">MUST</span> use EDHOC with RS and derive an OSCORE Security Context, as specified in <a href="#edhoc-exec" class="auto internal xref">Section 4.2</a>. After that, C <span class="bcp14">MUST</span> use the established OSCORE Security Context to protect communications with RS, when accessing protected resources at RS according to the authorization information indicated in the access token. Usually, it is assumed that constrained devices will be pre-configured with the necessary profile, so that this kind of profile signaling can be omitted.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">According to this document, the AS provides the access token to C, by specifying it in the "access_token" parameter of the access token response. An alternative workflow where the access token is uploaded by AS directly to RS is described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">When issuing the first access token of a token series, AS <span class="bcp14">MUST</span> include the following data in the response to C.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-7.1">
            <p id="section-3.3-7.1.1">The "edhoc_info" parameter conveying an EDHOC_Information object (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>). The EDHOC_Information object <span class="bcp14">MUST</span> include the "session_id" field specifying the identifier of the token series which the issued access token belongs to.<a href="#section-3.3-7.1.1" class="pilcrow">¶</a></p>
<p id="section-3.3-7.1.2">
The EDHOC_Information object <span class="bcp14">MAY</span> include additional fields (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>) to convey information about RS. This information is based on knowledge that AS has about RS, e.g., from a previous onboarding process, with particular reference to what RS supports as EDHOC peer.<a href="#section-3.3-7.1.2" class="pilcrow">¶</a></p>
<p id="section-3.3-7.1.3">
In case the access token is issued for a group-audience (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), the information specified in the EDHOC_Information object refers to the group-audience as a whole. Therefore, it is appropriate for AS to define group-audiences comprising RSs that are all aligned in terms of supported EDHOC features and configurations.<a href="#section-3.3-7.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-7.2">
            <p id="section-3.3-7.2.1">A unique identification of the authentication credential of RS, AUTH_CRED_RS. This is specified in the "rs_cnf" parameter defined in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>. AUTH_CRED_RS can be transported by value or referred to by means of an appropriate identifier. C could explicitly ask AS to provide AUTH_CRED_RS by value in the Access Token Response, e.g., by relying on the method defined in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-3.3-7.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3-7.2.2">
When issuing the first access token ever to a pair (C, RS) using a pair of corresponding authentication credentials (AUTH_CRED_C, AUTH_CRED_RS), it is expected that the response to C includes AUTH_CRED_RS by value.<a href="#section-3.3-7.2.2" class="pilcrow">¶</a></p>
<p id="section-3.3-7.2.3">
When later issuing further access tokens to the same pair (C, RS) using the same AUTH_CRED_RS, it is expected that the response to C includes AUTH_CRED_RS by reference.<a href="#section-3.3-7.2.3" class="pilcrow">¶</a></p>
<p id="section-3.3-7.2.4">
For AUTH_CRED_RS, its authentication credential type <span class="bcp14">MUST</span> be one of those supported by EDHOC. Consequently, the "rs_cnf" parameter <span class="bcp14">MUST</span> specify a confirmation method suitable for the type of AUTH_CRED_RS. That is, the same considerations about AUTH_CRED_C and the "req_cnf" parameter made in <a href="#c-as" class="auto internal xref">Section 3.1</a> hold for AUTH_CRED_RS and the "rs_cnf" parameter.<a href="#section-3.3-7.2.4" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-8">When issuing an access token for dynamically updating access rights (i.e., the access token is not the first in its token series), the response from AS <span class="bcp14">MUST NOT</span> include the "edhoc_info" and "rs_cnf" parameters (see <a href="#update-access-rights-c-as" class="auto internal xref">Section 3.3.3</a>).<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9"><a href="#fig-token-response" class="auto internal xref">Figure 5</a> shows an example of an AS response. The "rs_cnf" parameter specifies the authentication credential of RS, as an X.509 certificate transported by value in the "x5chain" field. The access token and the authentication credential of RS have been truncated for readability.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<span id="name-example-of-as-to-c-access-t"></span><div id="fig-token-response">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-3.3-10.1">
<pre>
   Header: Created (Code=2.01)
      Content-Format: application/ace+cbor
      Payload:
      {
        / access_token / 1 : h'8343a1010aa2044c53...0f6a'
          / remainder of access token (CWT) omitted for brevity /,
        / ace_profile / 38 : e'coap_edhoc_oscore',
        / expires_in /   2 : 3600,
        / rs_cnf /      41 : {
          e'x5chain' : h'3081ee3081a1a00302...77bc'
            / remainder of the credential omitted for brevity /
        }
        e'edhoc_info_param' : {
          e'session_id'    : h'01',
          e'methods'       : [0, 1, 2, 3],
          e'cipher_suites' : 0
        }
      }
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-as-to-c-access-t" class="selfRef">Example of AS-to-C Access Token response with EDHOC and OSCORE profile.</a>
          </figcaption></figure>
</div>
<div id="access-token">
<section id="section-3.3.1">
          <h4 id="name-access-token">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-access-token" class="section-name selfRef">Access Token</a>
          </h4>
<p id="section-3.3.1-1">To avoid the complexity of different encodings, an access token of this profile <span class="bcp14">SHALL</span> be a CBOR Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">When issuing any access token of a token series, AS <span class="bcp14">MUST</span> include the following claims in the access token:<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-3.1">
              <p id="section-3.3.1-3.1.1">The "edhoc_info" claim defined in <a href="#iana-token-cwt-claims" class="auto internal xref">Section 14.5</a> and conveying an EDHOC_Information object (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>).<a href="#section-3.3.1-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3.1.2">
The EDHOC_Information object <span class="bcp14">MUST</span> include the "session_id" field specifying the identifier of the token series which the issued access token belongs to. The "session_id" value is the same one included in the EDHOC_Information object of the response to C from the /token endpoint (see <a href="#as-c" class="auto internal xref">Section 3.3</a>), when providing C with the first access token in the series.<a href="#section-3.3.1-3.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.1-3.2">
              <p id="section-3.3.1-3.2.1">The "cnf" claim, specifying the authentication credential AUTH_CRED_C that C specified in its POST request to the /token endpoint, when requesting the first access token in the series which the issued access token belongs to (see <a href="#c-as" class="auto internal xref">Section 3.1</a>).<a href="#section-3.3.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3.2.2">
In the access token, AUTH_CRED_C can be transported by value or uniquely referred to by means of an appropriate identifier. Yet, consistent with the considerations about AUTH_CRED_C and the "req_cnf" parameter made in <a href="#c-as" class="auto internal xref">Section 3.1</a>, the "cnf" claim of the access token <span class="bcp14">MUST</span> specify a confirmation method suitable for the type of AUTH_CRED_C.<a href="#section-3.3.1-3.2.2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3.2.3">
When issuing the first access token of a token series, the confirmation method used in the "cnf" claim <span class="bcp14">MUST</span> be the same one used in the "req_cnf" parameter of the corresponding POST request from C to the /token endpoint.<a href="#section-3.3.1-3.2.3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3.2.4">
When issuing the first access token ever to a pair (C, RS) using a pair of corresponding authentication credentials (AUTH_CRED_C, AUTH_CRED_RS), it is expected that AUTH_CRED_C is included by value in the "cnf" claim of the access token.<a href="#section-3.3.1-3.2.4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3.2.5">
When later issuing further access tokens to the same pair (C, RS) using the same AUTH_CRED_C, it is expected that AUTH_CRED_C is identified by reference in the "cnf" claim of the access token.<a href="#section-3.3.1-3.2.5" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.1-4">When issuing the first access token of a token series, AS <span class="bcp14">MAY</span> include additional fields in the EDHOC_Information object (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>) specified in the "edhoc_info" claim of the access token.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">The access token needs to be protected for various reasons. To prevent manipulation of the content, it needs to be integrity protected. Also, RS has to be able to verify that the access token is issued by a trusted AS, by achieving source authentication. Depending on the use case and deployment, the access token may need to be confidentiality protected, for example due to privacy reasons.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.3.1-6">AS protects the access token using a COSE method <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> as specified in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>. Depending on the audience, there can be different ways to most appropriately ensure the confidentiality of an access token. For an audience comprising a single RS, the CWT Claims Set may be wrapped in COSE_Encrypt / COSE_Encrypt0. Instead, if the access token needs to be read by multiple RSs, then the CWT Claims Set may be wrapped in COSE_Sign / COSE_Sign1 and confidentiality protection is applied during transport, by including the access token in the EAD_3 field of EDHOC message_3 sent by C to RS, when using the EDHOC forward message flow (see <a href="#edhoc-exec" class="auto internal xref">Section 4.2</a>).<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.3.1-7"><a href="#fig-token" class="auto internal xref">Figure 6</a> shows an example of CWT Claims Set, including the relevant EDHOC parameters in the "edhoc_info" claim. The "cnf" claim specifies the authentication credential of C, as an X.509 certificate transported by value in the "x5chain" field. The authentication credential of C has been truncated for readability.<a href="#section-3.3.1-7" class="pilcrow">¶</a></p>
<span id="name-example-of-cwt-claims-set-w"></span><div id="fig-token">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-3.3.1-8.1">
<pre>
   {
    / aud /   3 : "tempSensorInLivingRoom",
    / iat /   6 : 1563451500,
    / exp /   4 : 1563453000,
    / scope / 9 :  "temperature_g firmware_p",
    / cnf /   8 : {
      e'x5chain' : h'3081ee3081a1a00302...77bc'
        / remainder of the credential omitted for brevity /
    }
    e'edhoc_info_claim' : {
      e'session_id'    : h'01',
      e'methods'       : [0, 1, 2, 3],
      e'cipher_suites' : 0
    }
  }
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-cwt-claims-set-w" class="selfRef">Example of CWT Claims Set with EDHOC parameters.</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="processing-at-c">
<section id="section-3.3.2">
          <h4 id="name-processing-at-c">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-processing-at-c" class="section-name selfRef">Processing at C</a>
          </h4>
<p id="section-3.3.2-1">When receiving an access token response including the "rs_cnf" parameter, C checks whether it is already storing the authentication credential of RS, namely AUTH_CRED_RS, specified in "rs_cnf" by value or reference.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">If this is not the case, C retrieves AUTH_CRED_RS, either using the "rs_cnf" parameter or some other trusted source. After that, C validates the actual AUTH_CRED_RS. In case of successful validation, C stores AUTH_CRED_RS as a valid authentication credential. Otherwise, C <span class="bcp14">MUST</span> delete the access token.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-access-rights-c-as">
<section id="section-3.3.3">
          <h4 id="name-update-of-access-rights">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-update-of-access-rights" class="section-name selfRef">Update of Access Rights</a>
          </h4>
<p id="section-3.3.3-1">If C has a valid OSCORE Security Context associated with a valid access token, then C can send a request to AS for updating its access rights while preserving the same OSCORE Security Context.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">If the request is granted, then AS generates a new access token, where the EDHOC_Information object specified in the "edhoc_info" claim <span class="bcp14">MUST</span> include only the "session_id" field. The access token is provisioned to RS either via C as specified in this document, or directly as described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>. In either case, the access token response from AS to C <span class="bcp14">MUST NOT</span> include the "edhoc_info" and "rs_cnf" parameters.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3.3-3">As defined in <a href="#access-token" class="auto internal xref">Section 3.3.1</a>, the "session_id" field is included in the EDHOC_Information object specified in the "edhoc_info" claim of the new access token. This allows RS to identify the old access token to supersede, as well as the OSCORE Security Context already shared between C and RS and to be associated with the new access token.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="edhoc-parameters-object">
<section id="section-3.4">
        <h3 id="name-edhoc_information">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-edhoc_information" class="section-name selfRef">EDHOC_Information</a>
        </h3>
<p id="section-3.4-1">EDHOC_Information is an object including information that guides two peers towards executing the EDHOC protocol. In particular, the EDHOC_Information is defined to be serialized and transported between nodes, as specified by this document, but it can also be used by other specifications.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">In the "coap_edhoc_oscore" profile of the ACE-OAuth framework, which is specified in this document, the EDHOC_Information object <span class="bcp14">MUST</span> be encoded as CBOR. However, for easy applicability to other contexts, we define also the JSON encoding.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">The EDHOC_Information can be encoded either as a JSON object or as a CBOR map. The set of common fields that can appear in an EDHOC_Information can be found in the IANA "EDHOC Information" registry defined in <a href="#iana-edhoc-parameters" class="auto internal xref">Section 14.9</a> for extensibility.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">All EDHOC_Information parameters are optional. The initial set of parameters defined in this document is summarized in <a href="#_table-cbor-key-edhoc-params" class="auto internal xref">Table 1</a> and is specified below.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">EDHOC_Information parameters are also categorized, i.e., each has one of two possible types, namely prescriptive or non-prescriptive:<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">
            <p id="section-3.4-6.1.1">A prescriptive parameter is used to provide an authoritative statement about how an execution of EDHOC has to be performed. An example is the "message_4" parameter indicating whether the use of EDHOC message_4 in an EDHOC session is mandatory or not.<a href="#section-3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.2">
            <p id="section-3.4-6.2.1">A non-prescriptive parameter is used to provide convenient information to consider when executing EDHOC, e.g., in terms of features supported by other peers. Such information is not necessarily exhaustive. An example is the "methods" parameter indicating a set of supported EDHOC methods.<a href="#section-3.4-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-7">This categorization helps coordinate the use of EDHOC application profiles <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.9" class="relref">Section 3.9</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> in a robust way, e.g., by using the means defined in <span>[<a href="#I-D.ietf-lake-app-profiles" class="cite xref">I-D.ietf-lake-app-profiles</a>]</span>.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<span id="name-edhoc_information-parameter"></span><div id="_table-cbor-key-edhoc-params">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-edhoc_information-parameter" class="selfRef">EDHOC_Information Parameters. Types: P (Prescriptive), NP (Non-Prescriptive)</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">CBOR label</th>
              <th class="text-left" rowspan="1" colspan="1">CBOR type</th>
              <th class="text-left" rowspan="1" colspan="1">Registry</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">session_id</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">bstr</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Identifier of a session</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">methods</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Method Type registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported EDHOC methods</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cipher_suites</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Cipher Suites registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported EDHOC cipher suites</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">message_4</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Mandatory use of EDHOC message_4</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">comb_req</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Support for the EDHOC + OSCORE combined request</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">uri_path</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">URI-path of the EDHOC resource</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cred_types</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Authentication Credential Types registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported types of authentication credentials for EDHOC</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id_cred_types</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">int or tstr or array</td>
              <td class="text-left" rowspan="1" colspan="1">COSE Header Parameters registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported types of authentication credential identifiers for EDHOC</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">eads</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">uint or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC External Authorization Data registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported EDHOC External Authorization Data (EAD) items</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">initiator</td>
              <td class="text-left" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Support for the EDHOC Initiator role</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">responder</td>
              <td class="text-left" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Support for the EDHOC Responder role</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">max_msgsize</td>
              <td class="text-left" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">uint</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Maximum size of EDHOC messages in bytes</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">coap_ct</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">True of False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Mandatory use of the CoAP Content-Format Option in CoAP messages whose payload includes exclusively an EDHOC message, possibly prepended by an EDHOC connection identifier</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ep_id_types</td>
              <td class="text-left" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Endpoint Identity Types registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported types of endpoint identities for EDHOC</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">transports</td>
              <td class="text-left" rowspan="1" colspan="1">14</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Transports registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported means for transporting EDHOC messages</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">trust_anchors</td>
              <td class="text-left" rowspan="1" colspan="1">15</td>
              <td class="text-left" rowspan="1" colspan="1">map</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Trust Anchor Purposes registry and EDHOC Trust Anchor Types registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported trust anchors</td>
              <td class="text-left" rowspan="1" colspan="1">NP</td>
            </tr>
          </tbody>
        </table>
</div>
<ul class="normal">
<li class="normal" id="section-3.4-9.1">
            <p id="section-3.4-9.1.1">session_id: This parameter identifies a 'session' which the EDHOC information is associated with, but does not necessarily identify a specific EDHOC session. In this document, "session_id" identifies a token series. In JSON, the "session_id" value is a Base64 encoded byte string. In CBOR, the "session_id" type is a byte string, and has label 0.<a href="#section-3.4-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.2">
            <p id="section-3.4-9.2.1">methods: This parameter specifies a set of supported EDHOC methods (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single EDHOC method, this is encoded as an integer. Otherwise, the set is encoded as an array of integers, where each array element encodes one EDHOC method. In JSON, the "methods" value is an integer or an array of integers. In CBOR, the "methods" is an integer or an array of integers, and has label 1.<a href="#section-3.4-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.3">
            <p id="section-3.4-9.3.1">cipher_suites: This parameter specifies a set of supported EDHOC cipher suites (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single EDHOC cipher suite, this is encoded as an integer. Otherwise, the set is encoded as an array of integers, where each array element encodes one EDHOC cipher suite. In JSON, the "cipher_suites" value is an integer or an array of integers. In CBOR, the "cipher_suites" is an integer or an array of integers, and has label 2.<a href="#section-3.4-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.4">
            <p id="section-3.4-9.4.1">message_4: This parameter indicates whether the EDHOC message_4 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) is supported. In JSON, the "message_4" value is a boolean. In CBOR, "message_4" is the simple value <code>true</code> (0xf5) or <code>false</code> (0xf4), and has label 4.<a href="#section-3.4-9.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.5">
            <p id="section-3.4-9.5.1">comb_req: This parameter indicates whether the combined EDHOC + OSCORE request defined in <span>[<a href="#RFC9668" class="cite xref">RFC9668</a>]</span>) is supported. In JSON, the "comb_req" value is a boolean. In CBOR, "comb_req" is the simple value <code>true</code> (0xf5) or <code>false</code> (0xf4), and has label 5.<a href="#section-3.4-9.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.6">
            <p id="section-3.4-9.6.1">uri_path: This parameter specifies the path component of the URI of the EDHOC resource where EDHOC messages have to be sent as requests. In JSON, the "uri_path" value is a string. In CBOR, "uri_path" is a text string, and has label 6.<a href="#section-3.4-9.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.7">
            <p id="section-3.4-9.7.1">cred_types: This parameter specifies a set of supported types of authentication credentials for EDHOC (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.2" class="relref">Section 3.5.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single type of authentication credential, this is encoded as an integer. Otherwise, the set is encoded as an array of integers, where each array element encodes one type of authentication credential. In JSON, the "cred_types" value is an integer or an array of integers. In CBOR, "cred_types" is an integer or an array of integers, and has label 6. The integer values are taken from the "EDHOC Authentication Credential Types" registry defined in <span>[<a href="#RFC9668" class="cite xref">RFC9668</a>]</span>.<a href="#section-3.4-9.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.8">
            <p id="section-3.4-9.8.1">id_cred_types: This parameter specifies a set of supported types of authentication credential identifiers for EDHOC (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3" class="relref">Section 3.5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single type of authentication credential identifier, this is encoded as an integer or a text string. Otherwise, the set is encoded as an array, where each array element encodes one type of authentication credential identifier, as an integer or a text string. In JSON, the "id_cred_types" value is an integer, or a text string, or an array of integers and text strings. In CBOR, "id_cred_types" is an integer or a text string, or an array of integers and text strings, and has label 7. The integer or text string values are taken from the 'Label' column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>.<a href="#section-3.4-9.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.9">
            <p id="section-3.4-9.9.1">eads: This parameter specifies a set of supported EDHOC External Authorization Data (EAD) items, identified by their ead_label (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single ead_label, this is encoded as an unsigned integer. Otherwise, the set is encoded as an array of unsigned integers, where each array element encodes one ead_label. In JSON, the "eads" value is an unsigned integer or an array of unsigned integers. In CBOR, "eads" is an unsigned integer or an array of unsigned integers, and has label 8. The unsigned integer values are taken from the 'Label' column of the "EDHOC External Authorization Data" registry defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-3.4-9.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.10">
            <p id="section-3.4-9.10.1">initiator: This parameter specifies whether the EDHOC Initiator role is supported. In JSON, the "initiator" value is a boolean. In CBOR, "initiator" is the simple value <code>true</code> (0xf5) or <code>false</code> (0xf4), and has label 9.<a href="#section-3.4-9.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.11">
            <p id="section-3.4-9.11.1">responder: This parameter specifies whether the EDHOC Responder role is supported. In JSON, the "responder" value is a boolean. In CBOR, "responder" is the simple value <code>true</code> (0xf5) or <code>false</code> (0xf4), and has label 10.<a href="#section-3.4-9.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.12">
            <p id="section-3.4-9.12.1">max_msgsize: This parameter specifies the admitted maximum size of EDHOC messages in bytes. In JSON, the "max_msgsize" value is an unsigned integer. In CBOR, "max_msgsize" is an unsigned integer and has label 11.<a href="#section-3.4-9.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.13">
            <p id="section-3.4-9.13.1">coap_cf: This parameter specifies whether it is required that CoAP messages include the CoAP Content-Format Option with value 64 (application/edhoc+cbor-seq) or 65 (application/cid-edhoc+cbor-seq) as appropriate, when the message payload includes exclusively an EDHOC message possibly prepended by an EDHOC connection identifier (see Sections <a href="https://rfc-editor.org/rfc/rfc9528#section-3.4.1" class="relref">3.4.1</a> and <a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">A.2</a> of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). In JSON, the "coap_cf" value is a boolean. In CBOR, "coap_cf" is the simple value <code>true</code> (0xf5) or <code>false</code> (0xf4), and has label 12.<a href="#section-3.4-9.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.14">
            <p id="section-3.4-9.14.1">ep_id_types: This parameter specifies a set of supported types of endpoint identities for EDHOC. If the set is composed of a single type of endpoint identity, this is encoded as an integer. Otherwise, the set is encoded as an array, where each array element encodes one type of endpoint identity as an integer. In JSON, the "ep_id_types" value is an integer or an array of integers. In CBOR, "ep_id_types" is an integer or an array of integers, and has label 13. The integer values are taken from the 'CBOR Label' column of the "EDHOC Endpoint Identity Types" registry defined in <a href="#iana-edhoc-endpoint-identity-types" class="auto internal xref">Section 14.10</a> of this document.<a href="#section-3.4-9.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.15">
            <p id="section-3.4-9.15.1">transports: This parameter specifies a set of supported means for transporting EDHOC messages. If the set is composed of a single means for transporting EDHOC messages, this is encoded as an integer. Otherwise, the set is encoded as an array, where each array element encodes one means for transporting EDHOC messages as an integer. In JSON, the "transports" value is an integer or an array of integers. In CBOR, "transports" is an integer or an array of integers, and has label 14. The integer values are taken from the 'Transport ID' column of the "EDHOC Transports" Registry defined in <a href="#iana-edhoc-transports" class="auto internal xref">Section 14.11</a> of this document.<a href="#section-3.4-9.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.16">
            <p id="section-3.4-9.16.1">trust_anchors: This parameter specifies a collection of supported trust anchors for performing authentication. According to what is specified within the collection, these trust anchors are used for different purposes, e.g., for verifying authentication credentials of other EDHOC peers in EDHOC sessions.<a href="#section-3.4-9.16.1" class="pilcrow">¶</a></p>
<p id="section-3.4-9.16.2">
More in detail, the collection of trust anchors is composed of one or more sets. Each set includes one or more trust anchors to use for one specific purpose associated with that set.<a href="#section-3.4-9.16.2" class="pilcrow">¶</a></p>
<p id="section-3.4-9.16.3">
In particular, each set is composed of pairs, each of which specifies a trust anchor type and an identifier of a trust anchor of that type. If the set is composed of a single pair, this pair is specified as a single item. If the set is composed of multiple pairs, these pairs are specified as elements of an array.<a href="#section-3.4-9.16.3" class="pilcrow">¶</a></p>
<p id="section-3.4-9.16.4">
Trust anchor purposes are selected from the "EDHOC Trust Anchor Purposes" registry defined in <a href="#iana-edhoc-ta-purposes" class="auto internal xref">Section 14.12</a> of this document. Trust anchor types are selected from the "EDHOC Trust Anchor Types" registry defined in <a href="#iana-edhoc-ta-types" class="auto internal xref">Section 14.13</a> of this document.<a href="#section-3.4-9.16.4" class="pilcrow">¶</a></p>
<p id="section-3.4-9.16.5">
In JSON, the "trust_anchors" value is an object with one or more outer entries, each of which is associated with a trust anchor purpose. The following applies for each outer entry:<a href="#section-3.4-9.16.5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-9.16.6.1">
                <p id="section-3.4-9.16.6.1.1">The outer entry's key specifies the associated trust anchor purpose taken from the 'Name' column' of the "EDHOC Trust Anchor Purposes" registry.<a href="#section-3.4-9.16.6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4-9.16.6.2">
                <p id="section-3.4-9.16.6.2.1">The outer entry's value is an object or an array of at least two objects. Each object includes one inner entry, specifying the pair for a trust anchor TA of type TYPE. The inner entry is formatted as follows:<a href="#section-3.4-9.16.6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-9.16.6.2.2.1">
                    <p id="section-3.4-9.16.6.2.2.1.1">The inner entry's key specifies the TA's type TYPE taken from the 'Name' column of the "EDHOC Trust Anchor Types" registry.<a href="#section-3.4-9.16.6.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.4-9.16.6.2.2.2">
                    <p id="section-3.4-9.16.6.2.2.2.1">The inner entry's value is the identifier of TA, whose encoding depends on TYPE. Such an encoding is what results from applying the conversion in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> to the CBOR encoding of the identifier of TA when "trust_anchors" is encoded in CBOR (see below).<a href="#section-3.4-9.16.6.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-3.4-9.16.7">
In CBOR, the "trust_anchors" value is a map and has label 15. The map includes one or more outer entries, each of which is associated with a trust anchor purpose. The following applies for each outer entry:<a href="#section-3.4-9.16.7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-9.16.8.1">
                <p id="section-3.4-9.16.8.1.1">The outer entry's key specifies the associated trust anchor purpose encoded as a CBOR integer, with integer value taken from the 'CBOR label' column of the "EDHOC Trust Anchor Purposes" registry.<a href="#section-3.4-9.16.8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4-9.16.8.2">
                <p id="section-3.4-9.16.8.2.1">The outer entry's value is a map or an array of at least two maps. Each map includes one inner entry, specifying the pair for a trust anchor TA of type TYPE. The inner entry is formatted as follows:<a href="#section-3.4-9.16.8.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-9.16.8.2.2.1">
                    <p id="section-3.4-9.16.8.2.2.1.1">The inner entry's key specifies the TA's type TYPE encoded as a CBOR integer, with integer value taken from the 'CBOR label' column of the "EDHOC Trust Anchor Types" registry.<a href="#section-3.4-9.16.8.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.4-9.16.8.2.2.2">
                    <p id="section-3.4-9.16.8.2.2.2.1">The inner entry's value specifies the identifier of TA, whose encoding depends on TYPE and is specified by the 'Value type' column of the "EDHOC Trust Anchor Types" registry, for the registry entry that has TYPE as value of the 'Name' column.<a href="#section-3.4-9.16.8.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.4-10">An example of JSON EDHOC_Information is given in <a href="#fig-edhoc-info-json" class="auto internal xref">Figure 7</a>.<a href="#section-3.4-10" class="pilcrow">¶</a></p>
<span id="name-example-of-json-edhoc_infor"></span><div id="fig-edhoc-info-json">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-3.4-11.1">
<pre>
   "edhoc_info" : {
       "session_id"    : b64'AQ==',
       "methods"       : 1,
       "cipher_suites" : 0,
       "trust_anchors" : {
         "edhoc_cred" : [
           { "c5u" : "coap://certs.c509.example" },
           { "x5u" : "coap://certs.x509.example" }
         ]
       }
   }
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-of-json-edhoc_infor" class="selfRef">Example of JSON EDHOC_Information</a>
          </figcaption></figure>
</div>
<p id="section-3.4-12">An example of CBOR EDHOC_Information is given in <a href="#fig-edhoc-info-cbor" class="auto internal xref">Figure 8</a>.<a href="#section-3.4-12" class="pilcrow">¶</a></p>
<span id="name-example-of-cbor-edhoc_infor"></span><div id="fig-edhoc-info-cbor">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="section-3.4-13.1">
<pre>
   e'edhoc_info_param'  : {
     e'session_id'    : h'01',
     e'methods'       : 1,
     e'cipher_suites' : 0,
     e'trust_anchors' : {
       e'edhoc_cred' : [
         { e'c5t_ta_type' : [-15, h'81DC2F32CB87E163'] },
         { e'c5u_ta_type' : "coap://certs.c509.example" },
         { e'x5t_ta_type' : [-15, h'79F2A41B510C1F9B'] },
         { e'x5u_ta_type' : "coap://certs.x509.example" }
       ]
     }
   }
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-of-cbor-edhoc_infor" class="selfRef">Example of CBOR EDHOC_Information</a>
          </figcaption></figure>
</div>
<p id="section-3.4-14">The CDDL grammar describing the CBOR EDHOC_Information is:<a href="#section-3.4-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-15">
<pre>
EDHOC_Information = {
  ?  0 =&gt; bstr,                   ; id
  ?  1 =&gt; int / array,            ; methods
  ?  2 =&gt; int / array,            ; cipher_suites
  ?  3 =&gt; true / false,           ; message_4
  ?  4 =&gt; true / false,           ; comb_req
  ?  5 =&gt; tstr,                   ; uri_path
  ?  6 =&gt; int / array,            ; cred_types
  ?  7 =&gt; int / tstr / array,     ; id_cred_types
  ?  8 =&gt; uint / array,           ; eads
  ?  9 =&gt; true / false,           ; initiator
  ? 10 =&gt; true / false,           ; responder
  ? 11 =&gt; uint,                   ; max_msgsize
  ? 12 =&gt; true / false,           ; coap_ct
  ? 13 =&gt; int / array,            ; ep_id_types
  ? 14 =&gt; int / array,            ; transports
  ? 15 =&gt; map,                    ; trust_anchors
  * int / tstr =&gt; any
}
</pre><a href="#section-3.4-15" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="c-rs-comm">
<section id="section-4">
      <h2 id="name-client-rs-communication">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-client-rs-communication" class="section-name selfRef">Client-RS Communication</a>
      </h2>
<p id="section-4-1">This section describes the exchange between C and RS, including the execution of the EDHOC protocol and the uploading of the access token from C to RS. The alternative workflow, where AS uploads the access token directly to RS, is described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">C and RS run the EDHOC protocol (see <a href="#edhoc-exec" class="auto internal xref">Section 4.2</a>), and C uploads the access token in an EAD field (see <a href="#AT-in-EAD" class="auto internal xref">Section 4.1</a>) of an EDHOC message. Once successfully completed the EDHOC session, C and RS derive an OSCORE Security Context (see <a href="#oscore-security-context" class="auto internal xref">Section 4.5</a>). After that, OSCORE is used for protecting communications when C accesses resources at RS, as per the access rights specified in the access token (see <a href="#access-rights-verif" class="auto internal xref">Section 4.9</a>).<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Detailed examples are given in <a href="#examples" class="auto internal xref">Appendix A</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="AT-in-EAD">
<section id="section-4.1">
        <h3 id="name-ead-items-for-access-token-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-ead-items-for-access-token-" class="section-name selfRef">EAD items for Access Token and Session Identifier</a>
        </h3>
<p id="section-4.1-1">This document defines EAD items (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) for transporting an access token or a session identifier in EDHOC.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">EAD_ACCESS_TOKEN  = (ead_label, ead_value), where:<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1.2.1">
                <p id="section-4.1-2.1.2.1.1">ead_label is the integer value TBD registered in <a href="#iana-edhoc-ead" class="auto internal xref">Section 14.8</a>.<a href="#section-4.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.1.2.2">
                <p id="section-4.1-2.1.2.2.1">ead_value is a CBOR byte string equal to the value of the "access_token" field of the access token response from AS (see <a href="#as-c" class="auto internal xref">Section 3.3</a>).<a href="#section-4.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1-2.1.3">
This EAD item is critical, i.e., it is used only with the negative value of its ead_label, indicating that the receiving RS must progress the protocol using the received access token, or else abort the EDHOC session (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). A client or resource server supporting the profile of ACE defined in this document <span class="bcp14">MUST</span> support this EAD item.<a href="#section-4.1-2.1.3" class="pilcrow">¶</a></p>
<p id="section-4.1-2.1.4">
EAD_ACCESS_TOKEN is used only when uploading the first access token of a token series, but not for the update of access rights (see <a href="#update-access-rights-c-rs" class="auto internal xref">Section 4.6</a>).<a href="#section-4.1-2.1.4" class="pilcrow">¶</a></p>
<p id="section-4.1-2.1.5">
Editor's note: Add example.<a href="#section-4.1-2.1.5" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">EAD_SESSION_ID  = (ead_label, ead_value), where:<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.2.2.1">
                <p id="section-4.1-2.2.2.1.1">ead_label is the integer value TBD registered in <a href="#iana-edhoc-ead" class="auto internal xref">Section 14.8</a>.<a href="#section-4.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1-2.2.2.2">
                <p id="section-4.1-2.2.2.2.1">ead_value is a CBOR byte string equal to the value of the "session_id" field within the EDHOC_Information object specified by AS in the "edhoc_info" parameter of the response from the /token endpoint, when issuing the first access token of a token series (see <a href="#as-c" class="auto internal xref">Section 3.3</a>).<a href="#section-4.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.1-2.2.3">
This EAD item is critical, i.e., it is used only with the negative value of its ead_label, indicating that the receiving RS must progress the protocol using the access token associated with the identifier specified in "ead_value" and with the AUTH_CRED_C used in the EDHOC session, or else abort the EDHOC session (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). A client or resource server supporting the profile of ACE defined in this document <span class="bcp14">MUST</span> support this EAD item.<a href="#section-4.1-2.2.3" class="pilcrow">¶</a></p>
<p id="section-4.1-2.2.4">
EAD_SESSION_ID is used only if the access token has been provisioned to RS and is valid, but there is a need to establish a (new) OSCORE Security Context between C and RS through EDHOC.<a href="#section-4.1-2.2.4" class="pilcrow">¶</a></p>
<p id="section-4.1-2.2.5">
Editor's note: Add example.<a href="#section-4.1-2.2.5" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="edhoc-exec">
<section id="section-4.2">
        <h3 id="name-edhoc-session">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-edhoc-session" class="section-name selfRef">EDHOC Session</a>
        </h3>
<p id="section-4.2-1">In order to mutually authenticate and establish secure communication for authorized access according to the profile described in this document, C and RS run the EDHOC protocol augmented with an access token. During the EDHOC session, C specifies the access token to RS by value as conveyed in EAD item EAD_ACCESS_TOKEN, or by reference through a session identifier SESSION_ID conveyed in the EAD item EAD_SESSION_ID (see <a href="#AT-in-EAD" class="auto internal xref">Section 4.1</a>).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">As per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, EDHOC can be transferred over CoAP using either the forward or the reverse message flow, thus manifesting the two possible mappings between the ACE roles (client and resource server) and the EDHOC roles (Initiator and Responder), whereas the CoAP roles (client and server) remain the same. The choice of message flow and corresponding mapping depends on the deployment setting and in particular on which identity to protect the most, since EDHOC protects the identity of the Initiator against active attackers.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">In case the EDHOC forward message flow is used (see <a href="#forward" class="auto internal xref">Section 4.3</a>), C acts as EDHOC Initiator, and the access token <span class="bcp14">MUST</span> be specified by value or by reference in the EAD_3 field of EDHOC message_3. In case the EDHOC reverse message flow is used (see <a href="#reverse" class="auto internal xref">Section 4.4</a>), C acts as EDHOC Responder, and the access token <span class="bcp14">MUST</span> be specified by value or by reference either in the EAD_2 field of EDHOC message_2 or in the EAD_4 field of EDHOC message_4. By doing so, the access token or the associated session identifier gets at least the same confidentiality protection by EDHOC as provided to the authentication credential used by C in the EDHOC session (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">When RS processes the EAD item EAD_ACCESS_TOKEN or EAD_SESSION_ID, RS <span class="bcp14">MUST</span> verify that the authentication credential AUTH_CRED_C that C specifies in the ID_CRED_X field during the EDHOC session is the same authentication credential correlated with the EAD item. If such a verification fails, RS <span class="bcp14">MUST</span> abort the EDHOC session. Note that:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-5.1">
            <p id="section-4.2-5.1.1">The ID_CRED_X field in question is the ID_CRED_I or ID_CRED_R field, when using the EDHOC forward or reverse message flow, respectively.<a href="#section-4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.2">
            <p id="section-4.2-5.2.1">If the processed EAD item is EAD_ACCESS_TOKEN, then the authentication credential correlated with the EAD item is specified in the 'cnf' claim of the access token conveyed in the EAD item.<a href="#section-4.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.3">
            <p id="section-4.2-5.3.1">If the processed EAD item is EAD_SESSION_ID, then the authentication credential correlated with the EAD item is specified in the 'cnf' claim of an access token stored at the RS, which is associated with the authentication credential specified by ID_CRED_X and with the SESSION_ID conveyed in the EAD item.<a href="#section-4.2-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-6">RS <span class="bcp14">MUST</span> have successfully validated the access token before completing the EDHOC session. If completed successfully, then the EDHOC session is associated with both the access token and the pair (SESSION_ID, AUTH_CRED_C). If the EAD item used in the EDHOC session is EAD_ACCESS_TOKEN, then SESSION_ID is specified by the "session_id" field, within the EDHOC_Information object specified by the "cnf" claim of the access token.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">Any previous EDHOC session associated with the same access token and with the same pair (SESSION_ID, AUTH_CRED_C) <span class="bcp14">MUST</span> be deleted. The OSCORE Security Context derived from that EDHOC session <span class="bcp14">MUST</span> also be deleted.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">Depending on the message flow used, the EDHOC messages will be carried either in CoAP POST requests or in CoAP 2.04 (Changed) responses, as detailed in <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9">C <span class="bcp14">MUST</span> target the EDHOC resource at RS with the URI path specified in the "uri_path" field (if present) of the EDHOC_Information object within the access token response received from AS, through which C obtained the first access token of the token series (see <a href="#c-as" class="auto internal xref">Section 3.1</a>). If the "uri_path" field is not present in that EDHOC_Information object, C assumes the target resource at RS to be the well-known EDHOC resource at the path /.well-known/edhoc.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<p id="section-4.2-10">RS has to ensure that no requests can be performed on an EDHOC resource other than for running the EDHOC protocol. Specifically, it <span class="bcp14">SHOULD NOT</span> be possible to perform any other operation than POST on an EDHOC resource.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forward">
<section id="section-4.3">
        <h3 id="name-forward-message-flow">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-forward-message-flow" class="section-name selfRef">Forward Message Flow</a>
        </h3>
<p id="section-4.3-1">This section details the case where the EDHOC forward message flow is used (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.1" class="relref">Appendix A.2.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), i.e., where C acts as the Initiator I and RS acts as the Responder R.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">Consistently with the EDHOC forward message flow, C sends EDHOC message_1 and EDHOC message_3 to an EDHOC resource at RS, as CoAP POST requests. RS sends EDHOC message_2 and (optionally) EDHOC message_4 as CoAP 2.04 (Changed) responses.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div id="edhoc-message1">
<section id="section-4.3.1">
          <h4 id="name-edhoc-message_1">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-edhoc-message_1" class="section-name selfRef">EDHOC message_1</a>
          </h4>
<p id="section-4.3.1-1">The processing of EDHOC message_1 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with the following additions:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-2.1">
              <p id="section-4.3.1-2.1.1">The EDHOC method <span class="bcp14">MUST</span> be one of the EDHOC methods specified in the "methods" field (if present) of the EDHOC_Information object within the access token response received from AS, through which C obtained the first access token of the token series (see <a href="#c-as" class="auto internal xref">Section 3.1</a>)<a href="#section-4.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-2.2">
              <p id="section-4.3.1-2.2.1">The selected cipher suite <span class="bcp14">MUST</span> be an EDHOC cipher suite specified in the "cipher_suites" field (if present) of the EDHOC_Information object within the access token response received from AS, through which C obtained the first access token of the token series (see <a href="#c-as" class="auto internal xref">Section 3.1</a>)<a href="#section-4.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="edhoc-message2">
<section id="section-4.3.2">
          <h4 id="name-edhoc-message_2">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-edhoc-message_2" class="section-name selfRef">EDHOC message_2</a>
          </h4>
<p id="section-4.3.2-1">The processing of EDHOC message_2 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with the following additions:<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2-2.1">
              <p id="section-4.3.2-2.1.1">The authentication credential CRED_R specified by the message field ID_CRED_R is AUTH_CRED_RS.<a href="#section-4.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="edhoc-message3">
<section id="section-4.3.3">
          <h4 id="name-edhoc-message_3">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-edhoc-message_3" class="section-name selfRef">EDHOC message_3</a>
          </h4>
<p id="section-4.3.3-1">The processing of EDHOC message_3 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with the following additions:<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.3-2.1">
              <p id="section-4.3.3-2.1.1">The authentication credential CRED_I specified by the message field ID_CRED_I is AUTH_CRED_C.<a href="#section-4.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.3-2.2">
              <p id="section-4.3.3-2.2.1">Exactly one of the EAD items EAD_ACCESS_TOKEN or EAD_SESSION_ID <span class="bcp14">MUST</span> be included in the EAD_3 field. If this is not the case, RS <span class="bcp14">MUST</span> abort the EDHOC session.<a href="#section-4.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.3-2.3">
              <p id="section-4.3.3-2.3.1">If the EAD_3 field includes the EAD item EAD_ACCESS_TOKEN, then RS <span class="bcp14">MUST</span> ensure that the access token specified in the EAD item is valid. If the EAD_3 field includes the EAD item EAD_SESSION_ID, then RS <span class="bcp14">MUST</span> ensure that the access token associated with the session identifier SESSION_ID specified in the EAD item and with the AUTH_CRED_C used in the EDHOC session is valid.<a href="#section-4.3.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.3-2.3.2">
The validation follows the procedure specified in <a href="#rs-c" class="auto internal xref">Section 4.6.2</a>. If such validation fails, RS <span class="bcp14">MUST</span> reply to C with an EDHOC error message with ERR_CODE = 1 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6" class="relref">Section 6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) and it <span class="bcp14">MUST</span> abort the EDHOC session.<a href="#section-4.3.3-2.3.2" class="pilcrow">¶</a></p>
<p id="section-4.3.3-2.3.3">
Editor's note: Instead of ERR_CODE = 1, consider to use ERR_CODE = 3 "Access Denied" defined in draft-ietf-lake-authz<a href="#section-4.3.3-2.3.3" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="reverse">
<section id="section-4.4">
        <h3 id="name-reverse-message-flow">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-reverse-message-flow" class="section-name selfRef">Reverse Message Flow</a>
        </h3>
<p id="section-4.4-1">This section details the case where the EDHOC reverse message flow is used (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.2" class="relref">Appendix A.2.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), i.e., where C acts as the Responder R and RS acts as the Initiator I.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Consistently with the EDHOC reverse message flow, C sends a trigger message, EDHOC message_2, and (optionally) EDHOC message_4 to RS as CoAP POST requests. RS sends EDHOC message_1 and EDHOC message_3 as CoAP 2.04 (Changed) responses.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">In this profile of ACE, if RS implements the EDHOC reverse message flow, then RS <span class="bcp14">MUST</span> implement EDHOC message_4.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">Exactly one of the EAD items EAD_ACCESS_TOKEN or EAD_SESSION_ID <span class="bcp14">MUST</span> be included in either the EAD_2 field of EDHOC message_2 or the EAD_4 field of EDHOC message_4. If this is not the case, RS <span class="bcp14">MUST</span> abort the EDHOC session.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">Specific instructions for the different messages are provided in the following subsections.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<div id="trigger-message">
<section id="section-4.4.1">
          <h4 id="name-trigger-message">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-trigger-message" class="section-name selfRef">Trigger Message</a>
          </h4>
<p id="section-4.4.1-1">As specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.2" class="relref">Appendix A.2.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, the trigger message is an empty POST request that C sends to the EDHOC resource at RS, as intended to trigger a response conveying EDHOC message_1.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">In case the access token is issued for a group-audience (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), then C can perform an EDHOC "roll call", by sending the trigger message as a group request over IP multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>. For the sake of efficiency, it is expected that the group-audience is appropriately associated with a CoAP group and/or application group (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-14#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">I-D.ietf-core-groupcomm-bis</a>]</span>), so that only the RSs belonging to the group-audience receive the trigger message. After that, C can receive a different EDHOC message_1 from each of the targeted RSs and separately progresses the corresponding EDHOC sessions, by sending a different EDHOC message_2 to each RS that has replied with an EDHOC message_1.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-message1-1">
<section id="section-4.4.2">
          <h4 id="name-edhoc-message_1-2">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-edhoc-message_1-2" class="section-name selfRef">EDHOC message_1</a>
          </h4>
<p id="section-4.4.2-1">The processing of EDHOC message_1 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-message2-1">
<section id="section-4.4.3">
          <h4 id="name-edhoc-message_2-2">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-edhoc-message_2-2" class="section-name selfRef">EDHOC message_2</a>
          </h4>
<p id="section-4.4.3-1">The processing of EDHOC message_2 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with the following additions:<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.3-2.1">
              <p id="section-4.4.3-2.1.1">The authentication credential CRED_R specified by the message field ID_CRED_R is AUTH_CRED_C.<a href="#section-4.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.3-2.2">
              <p id="section-4.4.3-2.2.1">If the EAD_2 field includes the EAD item EAD_ACCESS_TOKEN, then RS <span class="bcp14">MUST</span> ensure that the access token specified in the EAD item is valid. If the EAD_2 field includes the EAD item EAD_SESSION_ID, then RS <span class="bcp14">MUST</span> ensure that the access token associated with the session identifier SESSION_ID specified in the EAD item and with the AUTH_CRED_C used in the EDHOC session is valid.<a href="#section-4.4.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2.2.2">
The validation follows the procedure specified in <a href="#rs-c" class="auto internal xref">Section 4.6.2</a>. If such validation fails, RS <span class="bcp14">MUST</span> reply to C with an EDHOC error message with ERR_CODE = 1 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6" class="relref">Section 6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) and it <span class="bcp14">MUST</span> abort the EDHOC session.<a href="#section-4.4.3-2.2.2" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2.2.3">
Editor's note: Instead of ERR_CODE = 1, consider to use ERR_CODE = 3 "Access Denied"  defined in draft-ietf-lake-authz<a href="#section-4.4.3-2.2.3" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="edhoc-message3-1">
<section id="section-4.4.4">
          <h4 id="name-edhoc-message_3-2">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-edhoc-message_3-2" class="section-name selfRef">EDHOC message_3</a>
          </h4>
<p id="section-4.4.4-1">The processing of EDHOC message_3 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with the following additions:<a href="#section-4.4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.4-2.1">
              <p id="section-4.4.4-2.1.1">The authentication credential CRED_I specified by the message field ID_CRED_I is AUTH_CRED_RS.<a href="#section-4.4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="edhoc-message4">
<section id="section-4.4.5">
          <h4 id="name-edhoc-message_4">
<a href="#section-4.4.5" class="section-number selfRef">4.4.5. </a><a href="#name-edhoc-message_4" class="section-name selfRef">EDHOC message_4</a>
          </h4>
<p id="section-4.4.5-1">The processing of EDHOC message_4 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with the following additions:<a href="#section-4.4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.5-2.1">
              <p id="section-4.4.5-2.1.1">If the EAD_4 field includes the EAD item EAD_ACCESS_TOKEN, then RS <span class="bcp14">MUST</span> ensure that the access token specified in the EAD item is valid. If the EAD_4 field includes the EAD item EAD_SESSION_ID, then RS <span class="bcp14">MUST</span> ensure that the access token associated with the session identifier SESSION_ID specified in the EAD item and with the AUTH_CRED_C used in the EDHOC session is valid.<a href="#section-4.4.5-2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.4.5-2.1.2">
The validation follows the procedure specified in <a href="#rs-c" class="auto internal xref">Section 4.6.2</a>. If such validation fails, RS <span class="bcp14">MUST</span> reply to C with an EDHOC error message with ERR_CODE = 1 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6" class="relref">Section 6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) and it <span class="bcp14">MUST</span> abort the EDHOC session.<a href="#section-4.4.5-2.1.2" class="pilcrow">¶</a></p>
<p id="section-4.4.5-2.1.3">
Editor's note: Instead of ERR_CODE = 1, consider to use ERR_CODE = 3 "Access Denied"  defined in draft-ietf-lake-authz<a href="#section-4.4.5-2.1.3" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="oscore-security-context">
<section id="section-4.5">
        <h3 id="name-oscore-security-context">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-oscore-security-context" class="section-name selfRef">OSCORE Security Context</a>
        </h3>
<p id="section-4.5-1">Once successfully completed the EDHOC session, C and RS derive an OSCORE Security Context as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">In addition, RS associates the latest EDHOC session and the derived OSCORE Security Context with the stored access token, which is bound to the authentication credential AUTH_CRED_C used in the EDHOC session. The access token is also associated with the pair (SESSION_ID, AUTH_CRED_C), where SESSION_ID is the identifier of the token series to which the access token belongs.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">If supported by C, C <span class="bcp14">MAY</span> use the EDHOC + OSCORE combined request defined in <span>[<a href="#RFC9668" class="cite xref">RFC9668</a>]</span>, unless the EDHOC_Information object specified by the "edhoc_info" parameter of the access token response included the "comb_req" field encoding the CBOR simple value <code>false</code> (0xf4).<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">In the combined request, both EDHOC message_3 and the first OSCORE-protected application request are combined together in a single OSCORE-protected CoAP request, thus saving one round trip. This requires C to derive the OSCORE Security Context with RS already after having successfully processed the received EDHOC message_2 and before sending EDHOC message_3. An example is provided in <a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a>.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-access-rights-c-rs">
<section id="section-4.6">
        <h3 id="name-update-of-access-rights-2">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-update-of-access-rights-2" class="section-name selfRef">Update of Access Rights</a>
        </h3>
<p id="section-4.6-1">If C has a valid OSCORE Security Context associated with a valid access token at RS, then C can request from AS an update of the access rights as described in <a href="#c-as" class="auto internal xref">Section 3.1</a>.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">If the request is granted, then AS generates a new access token containing updated access rights for C (see <a href="#update-access-rights-c-as" class="auto internal xref">Section 3.3.3</a>), in the same token series of the current access token (see <a href="#token-series" class="auto internal xref">Section 3.2</a>).<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">According to this document, AS provides the new access token to C (see <a href="#as-c" class="auto internal xref">Section 3.3</a>) for further uploading to RS. Alternatively, the new access token can be uploaded by AS directly to RS, as described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">If all validations are successful, C can access protected resources at RS according to the updated access rights, using the previously established OSCORE Security Context.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5">The rest of this section describes the message exchange for the uploading of the new access token from C to RS.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<div id="c-rs">
<section id="section-4.6.1">
          <h4 id="name-c-to-rs-post-to-authz-info-">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-c-to-rs-post-to-authz-info-" class="section-name selfRef">C-to-RS: POST to /authz-info endpoint</a>
          </h4>
<p id="section-4.6.1-1">C can update its access rights by uploading the updated access token to RS using CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and the Authorization Information endpoint as described in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-4.6.1-1" class="pilcrow">¶</a></p>
<p id="section-4.6.1-2">That is, C sends a POST request to the /authz-info endpoint at RS, with the request payload containing the access token without any CBOR wrapping. As per <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, the Content-Format of the POST request <span class="bcp14">MUST</span> be "application/cwt" to reflect the format of the transported access token.<a href="#section-4.6.1-2" class="pilcrow">¶</a></p>
<p id="section-4.6.1-3">C <span class="bcp14">MUST</span> protect the POST request using the current OSCORE Security Context shared with RS.<a href="#section-4.6.1-3" class="pilcrow">¶</a></p>
<p id="section-4.6.1-4">Upon receiving an access token from C, RS <span class="bcp14">MUST</span> follow the procedures defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. That is, RS <span class="bcp14">MUST</span> verify the validity of the access token. RS <span class="bcp14">MAY</span> make an introspection request (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.9.1" class="relref">Section 5.9.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>) to validate the access token at AS.<a href="#section-4.6.1-4" class="pilcrow">¶</a></p>
<p id="section-4.6.1-5">RS <span class="bcp14">MUST</span> check the following conditions:<a href="#section-4.6.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6.1-6.1">
              <p id="section-4.6.1-6.1.1">RS checks whether it stores an access token T_OLD, such that the "session_id" field of the EDHOC_Information object specified by the "cnf" claim matches the "session_id" field of the EDHOC_Information object specified by the "cnf" claim of the new access token T_NEW.<a href="#section-4.6.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.6.1-6.2">
              <p id="section-4.6.1-6.2.1">RS checks whether the OSCORE Security Context CTX used to protect the request matches the OSCORE Security Context associated with the stored access token T_OLD.<a href="#section-4.6.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.6.1-7">If both the conditions above hold, RS <span class="bcp14">MUST</span> supersede the old access token T_OLD by replacing the corresponding authorization information with the one specified in the new access token T_NEW, and <span class="bcp14">MUST</span> associate T_NEW with the OSCORE Security Context CTX.<a href="#section-4.6.1-7" class="pilcrow">¶</a></p>
<p id="section-4.6.1-8">Note that C and RS do not execute the EDHOC protocol, they do not establish a new OSCORE Security Context, and AUTH_CRED_C remains the same.<a href="#section-4.6.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rs-c">
<section id="section-4.6.2">
          <h4 id="name-rs-to-c-201-created">
<a href="#section-4.6.2" class="section-number selfRef">4.6.2. </a><a href="#name-rs-to-c-201-created" class="section-name selfRef">RS-to-C: 2.01 (Created)</a>
          </h4>
<p id="section-4.6.2-1">If all validations are successful, RS stores the new access token in such a way that it is possible to retrieve it based on the pair (SESSION_ID, AUTH_CRED_C), where SESSION_ID is the identifier of the token series to which the access token belongs. Note that SESSION_ID is specified in the "session_id" field of the EDHOC_Information object, within the "cnf" claim of the access token.<a href="#section-4.6.2-1" class="pilcrow">¶</a></p>
<p id="section-4.6.2-2">Then, RS <span class="bcp14">MUST</span> reply to the POST request by sending a 2.01 (Created) response with no payload. The response is protected with the same OSCORE Security Context used to protect the corresponding request. After that, C can access protected resources at RS according to the updated access rights, using the previously established OSCORE Security Context.<a href="#section-4.6.2-2" class="pilcrow">¶</a></p>
<p id="section-4.6.2-3">Instead, if any validation fails, RS <span class="bcp14">MUST</span> respond with a 4.01 (Unauthorized) error response. RS <span class="bcp14">MAY</span> provide additional information in the payload of the error response, in order to clarify what went wrong.<a href="#section-4.6.2-3" class="pilcrow">¶</a></p>
<p id="section-4.6.2-4">As specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, when receiving a valid access token with updated authorization information from C (see <a href="#c-rs" class="auto internal xref">Section 4.6.1</a>), it is recommended that RS overwrites the previous access token. That is, only the latest authorization information in the access token received by RS is valid. This simplifies the process needed by RS to keep track of authorization information for a given client.<a href="#section-4.6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="discard-context">
<section id="section-4.7">
        <h3 id="name-discarding-the-oscore-secur">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-discarding-the-oscore-secur" class="section-name selfRef">Discarding the OSCORE Security Context</a>
        </h3>
<p id="section-4.7-1">There are a number of cases where C or RS have to discard the OSCORE Security Context that they share, and may establish a new one (see <a href="#establish-new-context" class="auto internal xref">Section 4.8</a>).<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">C <span class="bcp14">MUST</span> discard the current OSCORE Security Context shared with RS when any of the following occurs.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-3.1">
            <p id="section-4.7-3.1.1">The OSCORE Sender Sequence Number space of C is exhausted.<a href="#section-4.7-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-3.2">
            <p id="section-4.7-3.2.1">The access token associated with the OSCORE Security Context becomes invalid, for example, due to expiration or revocation.<a href="#section-4.7-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-3.3">
            <p id="section-4.7-3.3.1">C receives a number of unprotected 4.01 (Unauthorized) responses to OSCORE-protected requests, which are sent to RS and protected using the same OSCORE Security Context. The exact number of such received responses needs to be specified by the application. This can happen, for example, due to lack of storage at RS, which then sends the "AS Request Creation Hints" message (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-4.7-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-3.4">
            <p id="section-4.7-3.4.1">The authentication credential of C (of RS) becomes invalid, e.g., due to expiration or revocation, and it was used as AUTH_CRED_C (AUTH_CRED_RS) in the EDHOC session to establish the OSCORE Security Context.<a href="#section-4.7-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-4">RS <span class="bcp14">MUST</span> discard the current OSCORE Security Context shared with C when any of the following occurs:<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-5.1">
            <p id="section-4.7-5.1.1">The OSCORE Sender Sequence Number space of RS is exhausted.<a href="#section-4.7-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.2">
            <p id="section-4.7-5.2.1">The access token associated with the OSCORE Security Context becomes invalid, for example, due to expiration or revocation.<a href="#section-4.7-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.7-5.3">
            <p id="section-4.7-5.3.1">The authentication credential of C (of RS) becomes invalid (e.g., due to expiration or revocation), and it was used as AUTH_CRED_C (AUTH_CRED_RS) in the EDHOC session to establish the OSCORE Security Context.<a href="#section-4.7-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-6">After a new access token is successfully uploaded to RS and a new OSCORE Security Context is established between C and RS, messages still in transit that were protected with the previous OSCORE Security Context might not be successfully verified by the recipient, since the old OSCORE Security Context might have been discarded. This means that messages sent shortly before C has uploaded the new access token to RS might not be successfully accepted by the recipient.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<p id="section-4.7-7">Furthermore, implementations may want to cancel CoAP observations at RS, if registered before the new OSCORE Security Context has been established. Alternatively, applications need to implement a mechanism to ensure that, from then on, messages exchanged within those observations are going to be protected with the newly derived OSCORE Security Context.<a href="#section-4.7-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="establish-new-context">
<section id="section-4.8">
        <h3 id="name-establishing-a-new-oscore-s">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-establishing-a-new-oscore-s" class="section-name selfRef">Establishing a New OSCORE Security Context</a>
        </h3>
<p id="section-4.8-1">The procedure of provisioning a new access token to RS specified in this section applies to various cases when an OSCORE Security Context shared between C and RS has been deleted, for example as described in <a href="#discard-context" class="auto internal xref">Section 4.7</a>.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">Another exceptional case is when there is still a valid OSCORE Security Context but it needs to be updated, e.g., due to a policy limiting its use in terms of time or amount of processed data, or to the imminent exhaustion of the OSCORE Sender Sequence Number space. In this case, C and RS <span class="bcp14">MAY</span> alternatively attempt to run a key update protocol that they both support. One lightweight example is KUDOS <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>, which is independent of ACE and EDHOC and does not require the uploading of an access token. If C and RS does not support a common key update protocol to use for updating their still valid OSCORE Security Context, then C and RS fall back to EDHOC as outlined above.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<p id="section-4.8-3">In either case, C and RS establish a new OSCORE Security Context that replaces the old one and will be used for protecting their communications from then on. In particular, RS <span class="bcp14">MUST</span> associate the new OSCORE Security Context with the current (potentially re-uploaded) access token. Furthermore, the SESSION_ID identifying the token series to which the access token belongs to remains unchanged, even if C and RS have established a new EDHOC session. Unless C and RS re-run the EDHOC protocol, they preserve their OSCORE identifiers, i.e., their OSCORE Sender/Recipient IDs.<a href="#section-4.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-rights-verif">
<section id="section-4.9">
        <h3 id="name-access-rights-verification">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-access-rights-verification" class="section-name selfRef">Access Rights Verification</a>
        </h3>
<p id="section-4.9-1">RS <span class="bcp14">MUST</span> follow the procedures defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.2" class="relref">Section 5.10.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. That is, if RS receives an OSCORE-protected request targeting a protected resource from C, then RS processes the request according to <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<p id="section-4.9-2">If OSCORE verification succeeds and the target resource requires authorization, RS retrieves the authorization information using the access token associated with the OSCORE Security Context. Then, RS <span class="bcp14">MUST</span> verify that the authorization information covers the target resource and the action intended by C on it.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-token-invalidity">
<section id="section-4.10">
        <h3 id="name-access-token-invalidity">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-access-token-invalidity" class="section-name selfRef">Access Token Invalidity</a>
        </h3>
<p id="section-4.10-1">When an access token becomes invalid (e.g., due to its expiration or revocation), RS <span class="bcp14">MUST</span> delete the access token and the associated OSCORE Security Context, and <span class="bcp14">MUST</span> notify C with an error response with code 4.01 (Unauthorized) for any long running request, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-4.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="auth-cred-validity">
<section id="section-4.11">
        <h3 id="name-authentication-credential-i">
<a href="#section-4.11" class="section-number selfRef">4.11. </a><a href="#name-authentication-credential-i" class="section-name selfRef">Authentication Credential Invalidity</a>
        </h3>
<p id="section-4.11-1">If an authentication credential AUTH_CRED_C of C is invalidated (e.g., it expires), then the following applies:<a href="#section-4.11-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.11-2.1">
            <p id="section-4.11-2.1.1">RS <span class="bcp14">MUST</span> delete all the stored access tokens that specify AUTH_CRED_C in the "cnf" claim.<a href="#section-4.11-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.11-2.2">
            <p id="section-4.11-2.2.1">C <span class="bcp14">MUST</span> delete every stored access token such that C obtained the first access token of the same series through the response to an access token request specifying AUTH_CRED_C, e.g., in the "req_cnf" parameter (see <a href="#c-as" class="auto internal xref">Section 3.1</a>).<a href="#section-4.11-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.11-2.3">
            <p id="section-4.11-2.3.1">RS and C <span class="bcp14">MUST</span> abort and purge all the EDHOC sessions that used AUTH_CRED_C and successfully completed, as well as the OSCORE Security Context derived from those sessions (see <a href="#discard-context" class="auto internal xref">Section 4.7</a>).<a href="#section-4.11-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.11-3">If an authentication credential AUTH_CRED_RS of RS is invalidated (e.g., it expires), then the following applies:<a href="#section-4.11-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.11-4.1">
            <p id="section-4.11-4.1.1">C <span class="bcp14">MUST</span> delete every stored access token such that C obtained the first access token of the same series through an access token response specifying AUTH_CRED_RS, e.g., in the 'rs_cnf' parameter (see <a href="#as-c" class="auto internal xref">Section 3.3</a>).<a href="#section-4.11-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.11-4.2">
            <p id="section-4.11-4.2.1">C <span class="bcp14">MUST</span> delete every stored access token that C specified (by value or be reference) during an EDHOC session that used AUTH_CRED_RS and successfully completed.<a href="#section-4.11-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.11-4.3">
            <p id="section-4.11-4.3.1">RS and C <span class="bcp14">MUST</span> abort and purge all the EDHOC sessions that used AUTH_CRED_RS and successfully completed, as well as the OSCORE Security Context derived from those sessions (see <a href="#discard-context" class="auto internal xref">Section 4.7</a>).<a href="#section-4.11-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="session-validity">
<section id="section-4.12">
        <h3 id="name-edhoc-session-invalidity">
<a href="#section-4.12" class="section-number selfRef">4.12. </a><a href="#name-edhoc-session-invalidity" class="section-name selfRef">EDHOC Session Invalidity</a>
        </h3>
<p id="section-4.12-1">If an EDHOC session is aborted and purged for other reasons than those in <a href="#auth-cred-validity" class="auto internal xref">Section 4.11</a>, then RS and C that established the session <span class="bcp14">MUST</span> delete the OSCORE Security Context derived from that session (see <a href="#discard-context" class="auto internal xref">Section 4.7</a>).<a href="#section-4.12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-creation-hints">
<section id="section-4.13">
        <h3 id="name-using-as-request-creation-h">
<a href="#section-4.13" class="section-number selfRef">4.13. </a><a href="#name-using-as-request-creation-h" class="section-name selfRef">Using AS Request Creation Hints</a>
        </h3>
<p id="section-4.13-1">When replying to an unauthorized resource request message from a client, RS can send an unprotected AS Request Creation Hints message as a 4.01 (Unauthorized) error response (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-4.13-1" class="pilcrow">¶</a></p>
<p id="section-4.13-2">The message payload can specify a number of parameters that help the sender client acquire a valid access token from AS. These parameters include "audience" and "scope".<a href="#section-4.13-2" class="pilcrow">¶</a></p>
<p id="section-4.13-3">When using this profile and running EDHOC per its reverse message flow (see <a href="#reverse" class="auto internal xref">Section 4.4</a>), RS acts as EDHOC Initiator. A compelling reason to do so is the wish to protect the identity of RS against active attackers, consistently with the EDHOC security properties.<a href="#section-4.13-3" class="pilcrow">¶</a></p>
<p id="section-4.13-4">However, the identity protection achieved through EDHOC can be defeated if RS exposes information such as audience and scope, when specifying the corresponding parameters in an unprotected AS Request Creation Hints message.<a href="#section-4.13-4" class="pilcrow">¶</a></p>
<p id="section-4.13-5">Therefore, if RS supports the EDHOC reverse message flow and sends an AS Request Creation Hints, the following applies:<a href="#section-4.13-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.13-6.1">
            <p id="section-4.13-6.1.1">The message payload <span class="bcp14">MUST NOT</span> include the "audience" parameter.<a href="#section-4.13-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.13-6.2">
            <p id="section-4.13-6.2.1">The message payload <span class="bcp14">SHOULD NOT</span> include the "scope" parameter, unless its value cannot contribute to expose the identity of RS.<a href="#section-4.13-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.13-7">AS Request Creation Hints may also be requested and retrieved through a new EAD item defined here, see <a href="#fig-ead-rch" class="auto internal xref">Figure 9</a>.<a href="#section-4.13-7" class="pilcrow">¶</a></p>
<span id="name-ead-item-as-request-creatio"></span><div id="fig-ead-rch">
<figure id="figure-9">
          <div class="lang-CDDL sourcecode" id="section-4.13-8.1">
<pre>
ead_label = TBD
? ead_value = bstr .cbor AS_request_creation_hints

AS_request_creation_hints : map
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-ead-item-as-request-creatio" class="selfRef">EAD item AS Request Creation Hints.</a>
          </figcaption></figure>
</div>
<p id="section-4.13-9">The AS_request_creation_hints is a CBOR map with keys defined in the IANA registry
"ACE Authorization Server Request Creation Hints".<a href="#section-4.13-9" class="pilcrow">¶</a></p>
<p id="section-4.13-10">This EAD item is intended to be used in EAD fields of EDHOC messages exchanged between C and RS: in the forward message flow in EAD_1 and EAD_2, and in the reverse message flow in EAD_2 and EAD_3. In the first EDHOC message from C to RS, an EAD item with ead_label = TBD with no ead_value asks the RS to include in the next EDHOC message the same EAD item with ead_value encoding the AS_request_creation_hints map. This EAD item is non-critical, i.e., it can be ignored by the receiving peer. It is <span class="bcp14">OPTIONAL</span> to implement.<a href="#section-4.13-10" class="pilcrow">¶</a></p>
<p id="section-4.13-11">Since C has not made an actual request targeting a specific application resource, the RS may not know what resource C is interested in accessing. Moreover, such information needs to be matched against the privacy policy of the application. Since EDHOC message_2 is only protected against passive attackers, the AS_request_creation_hints map <span class="bcp14">SHOULD NOT</span> include "audience" and "scope" when present in the EAD item conveyed in the EAD_2 field.<a href="#section-4.13-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="auth-cred-by-value">
<section id="section-4.14">
        <h3 id="name-requesting-authentication-c">
<a href="#section-4.14" class="section-number selfRef">4.14. </a><a href="#name-requesting-authentication-c" class="section-name selfRef">Requesting Authentication Credential By Value</a>
        </h3>
<p id="section-4.14-1">EDHOC peers need access to each other's authentication credentials to complete the protocol. However, to reduce unnecessary overhead, the EDHOC protocol enables credential references to be sent instead of authentication credentials. The ACE protocol includes the initial transport of authentication credentials of C and RS and thus matches the use of credential references in EDHOC.<a href="#section-4.14-1" class="pilcrow">¶</a></p>
<p id="section-4.14-2">However, if one of the parties has erased the other party's authentication credential from its cache, then there should be a way to restore it without requesting a new access token.<a href="#section-4.14-2" class="pilcrow">¶</a></p>
<p id="section-4.14-3">If the Initiator sends a credential by reference in message_3, then Responder may return error code 3, Unknown credential referenced. This triggers the Initiator to restart the protocol with some other ID_CRED, typically the authentication credential by value thereby resolving the issue.<a href="#section-4.14-3" class="pilcrow">¶</a></p>
<p id="section-4.14-4">However, in case the Responder sends a credential by reference in message_2, then returning a code 3 error message does not automatically solve the problem. Having aborted the protocol, the Responder has no reliable way to act differently in a following EDHOC session with the same Initiator.<a href="#section-4.14-4" class="pilcrow">¶</a></p>
<p id="section-4.14-5">In order to remediate this situation, we specify a new EAD item for requesting the peer's authentication credential by value, see <a href="#fig-ead-req-authcred" class="auto internal xref">Figure 10</a>.<a href="#section-4.14-5" class="pilcrow">¶</a></p>
<span id="name-ead-item-requesting-authent"></span><div id="fig-ead-req-authcred">
<figure id="figure-10">
          <div class="lang-CDDL sourcecode" id="section-4.14-6.1">
<pre>
ead_label = TBD
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-ead-item-requesting-authent" class="selfRef">EAD item Requesting Authentication Credential By Value.</a>
          </figcaption></figure>
</div>
<p id="section-4.14-7">This EAD item has no ead_value. When present in EAD_1, it requests the Responder's authentication credential by value in ID_CRED_R of message_2. When present in EAD_2, it requests the the Initiators's authentication credential by value in ID_CRED_I of message_3.<a href="#section-4.14-7" class="pilcrow">¶</a></p>
<p id="section-4.14-8">This EAD item is non-critical, i.e., it can be ignored by the receiving peer. It is <span class="bcp14">OPTIONAL</span> to implement.<a href="#section-4.14-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="secure-comm-as">
<section id="section-5">
      <h2 id="name-secure-communication-with-a">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-secure-communication-with-a" class="section-name selfRef">Secure Communication with AS</a>
      </h2>
<p id="section-5-1">As specified in the ACE framework (see Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">5.8</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.9" class="relref">5.9</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), the requesting entity (RS and/or C) and AS communicates via the /token or /introspect endpoint. When using this profile, the use of CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> for this communication is <span class="bcp14">RECOMMENDED</span>. Other protocols fulfilling the security requirements defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5" class="relref">Section 5</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> (such as HTTP and DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> or TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>) <span class="bcp14">MAY</span> be used instead.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If OSCORE is used, the requesting entity and AS need to have an OSCORE Security Context in place. While this can be pre-installed, the requesting entity and AS can establish such an OSCORE Security Context, for example, by running the EDHOC protocol, as shown between C and AS by the examples in <a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a> and <a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a>. This also applies for communication between RS and AS, for example to protect the upload of access tokens from AS directly to RS as described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cwt-confirmation-methods">
<section id="section-6">
      <h2 id="name-cwt-confirmation-methods">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-cwt-confirmation-methods" class="section-name selfRef">CWT Confirmation Methods</a>
      </h2>
<p id="section-6-1">This document defines a number of new CWT confirmation methods, which are registered in <a href="#iana-cwt-confirmation-methods" class="auto internal xref">Section 14.7</a>. The semantics of each confirmation method is defined below.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="ssec-cwt-conf-x5chain">
<section id="section-6.1">
        <h3 id="name-ordered-chain-of-x509-certi">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ordered-chain-of-x509-certi" class="section-name selfRef">Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-6.1-1">The confirmation method "x5chain" specifies an ordered array of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5chain" is like that of the "x5chain" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-x5bag">
<section id="section-6.2">
        <h3 id="name-unordered-bag-of-x509-certi">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-unordered-bag-of-x509-certi" class="section-name selfRef">Unordered Bag of X.509 Certificates</a>
        </h3>
<p id="section-6.2-1">The confirmation method "x5bag" specifies a bag of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5bag" is like that of the "x5bag" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-x5t">
<section id="section-6.3">
        <h3 id="name-hash-of-an-x509-certificate">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-hash-of-an-x509-certificate" class="section-name selfRef">Hash of an X.509 Certificate</a>
        </h3>
<p id="section-6.3-1">The confirmation method "x5t" specifies the hash value of the end-entity X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5t" is like that of the "x5t" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-x5u">
<section id="section-6.4">
        <h3 id="name-uri-pointing-to-an-ordered-">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-uri-pointing-to-an-ordered-" class="section-name selfRef">URI Pointing to an Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-6.4-1">The confirmation method "x5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of an ordered chain of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5u" is like that of the "x5u" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5c">
<section id="section-6.5">
        <h3 id="name-ordered-chain-of-c509-certi">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-ordered-chain-of-c509-certi" class="section-name selfRef">Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-6.5-1">The confirmation method "c5c" specifies an ordered array of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5c" is like that of the "c5c" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5b">
<section id="section-6.6">
        <h3 id="name-unordered-bag-of-c509-certi">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-unordered-bag-of-c509-certi" class="section-name selfRef">Unordered Bag of C509 Certificates</a>
        </h3>
<p id="section-6.6-1">The confirmation method "c5b" specifies a bag of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5b" is like that of the "c5b" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5t">
<section id="section-6.7">
        <h3 id="name-hash-of-a-c509-certificate">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-hash-of-a-c509-certificate" class="section-name selfRef">Hash of a C509 Certificate</a>
        </h3>
<p id="section-6.7-1">The confirmation method "c5t" specifies the hash value of the end-entity C509 certificate <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5t" is like that of the "c5t" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5u">
<section id="section-6.8">
        <h3 id="name-uri-pointing-to-an-ordered-c">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-uri-pointing-to-an-ordered-c" class="section-name selfRef">URI Pointing to an Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-6.8-1">The confirmation method "c5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of a COSE_C509 containing an ordered chain of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. COSE_C509 is defined in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5u" is like that of the "c5u" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-kcwt">
<section id="section-6.9">
        <h3 id="name-cwt-containing-a-cose_key">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-cwt-containing-a-cose_key" class="section-name selfRef">CWT Containing a COSE_Key</a>
        </h3>
<p id="section-6.9-1">The confirmation method "kcwt" specifies a CBOR Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The semantics of "kcwt" is like that of the "kcwt" COSE Header Parameter specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-kccs">
<section id="section-6.10">
        <h3 id="name-ccs-containing-a-cose_key">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-ccs-containing-a-cose_key" class="section-name selfRef">CCS Containing a COSE_Key</a>
        </h3>
<p id="section-6.10-1">The confirmation method "kccs" specifies a CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The semantics of "kccs" is like that of the "kccs" COSE Header Parameter specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="jwt-confirmation-methods">
<section id="section-7">
      <h2 id="name-jwt-confirmation-methods">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-jwt-confirmation-methods" class="section-name selfRef">JWT Confirmation Methods</a>
      </h2>
<p id="section-7-1">This document defines a number of new JWT confirmation methods, which are registered in <a href="#iana-jwt-confirmation-methods" class="auto internal xref">Section 14.6</a>. The semantics of each confirmation method is defined below.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="ssec-jwt-conf-x5c">
<section id="section-7.1">
        <h3 id="name-ordered-chain-of-x509-certif">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-ordered-chain-of-x509-certif" class="section-name selfRef">Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-7.1-1">The confirmation method "x5c" specifies an ordered array of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5c" is like that of the "x5c" JSON Web Signature and Encryption Header Parameter specified in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, with the following difference. The public key contained in the first certificate is the proof-of-possession key and does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-x5b">
<section id="section-7.2">
        <h3 id="name-unordered-bag-of-x509-certif">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-unordered-bag-of-x509-certif" class="section-name selfRef">Unordered Bag of X.509 Certificates</a>
        </h3>
<p id="section-7.2-1">The confirmation method "x5b" specifies a bag of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of the "x5b" is like that of the "x5c" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5c" class="auto internal xref">Section 7.1</a>, with the following differences. First, the set of certificates is unordered and may contain self-signed certificates. Second, the composition and processing of "x5b" are like for the "x5bag" COSE Header Parameter defined in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-x5t">
<section id="section-7.3">
        <h3 id="name-hash-of-an-x509-certificate-2">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-hash-of-an-x509-certificate-2" class="section-name selfRef">Hash of an X.509 Certificate</a>
        </h3>
<p id="section-7.3-1">The confirmation method "x5t" specifies the hash value of the end-entity X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5t" is like that of the "x5t" JSON Web Signature and Encryption Header Parameter specified in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-x5u">
<section id="section-7.4">
        <h3 id="name-uri-pointing-to-an-ordered-ch">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-uri-pointing-to-an-ordered-ch" class="section-name selfRef">URI Pointing to an Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-7.4-1">The confirmation method "x5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of an ordered chain of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5u" is like that of the "x5u" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>, with the following difference. The public key contained in the first certificate is the proof-of-possession key and does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5c">
<section id="section-7.5">
        <h3 id="name-ordered-chain-of-c509-certif">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-ordered-chain-of-c509-certif" class="section-name selfRef">Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-7.5-1">The confirmation method "c5c" specifies an ordered array of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5c" is like that of the "x5c" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5c" class="auto internal xref">Section 7.1</a>, with the following difference. Each string in the JSON array is a base64-encoded (<span><a href="https://rfc-editor.org/rfc/rfc4648#section-4" class="relref">Section 4</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> - not base64url-encoded) C509 certificate.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5b">
<section id="section-7.6">
        <h3 id="name-unordered-bag-of-c509-certif">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-unordered-bag-of-c509-certif" class="section-name selfRef">Unordered Bag of C509 Certificates</a>
        </h3>
<p id="section-7.6-1">The confirmation method "c5b" specifies a bag of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5b" is like that of the "c5c" JWT confirmation method defined in <a href="#ssec-jwt-conf-c5c" class="auto internal xref">Section 7.5</a>, with the following differences. First, the set of certificates is unordered and may contain self-signed certificates. Second, the composition and processing of "c5b" is like for the "c5b" COSE Header Parameter defined in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5t">
<section id="section-7.7">
        <h3 id="name-hash-of-a-c09-certificate">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-hash-of-a-c09-certificate" class="section-name selfRef">Hash of a C09 Certificate</a>
        </h3>
<p id="section-7.7-1">The confirmation method "c5t" specifies the hash value of the end-entity C509 certificate <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5t" is like that of the "x5t" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5t" class="auto internal xref">Section 7.3</a>, with the following differences. First, the base64url-encoded SHA-1 thumbprint is computed over the C509 certificate. Second, the public key contained in the C509 certificate does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5u">
<section id="section-7.8">
        <h3 id="name-uri-pointing-to-an-ordered-cha">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-uri-pointing-to-an-ordered-cha" class="section-name selfRef">URI Pointing to an Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-7.8-1">The confirmation method "c5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of COSE_C509 containing an ordered chain of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. COSE_C509 is defined in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5u" is like that of the "x5u" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5u" class="auto internal xref">Section 7.4</a>, with the following differences. First, the URI refers to a resource for the C509 certificate chain. Second, the public key contained in one of the C509 certificates and acting as proof-of-possession key does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-kcwt">
<section id="section-7.9">
        <h3 id="name-cwt-containing-a-cose_key-2">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-cwt-containing-a-cose_key-2" class="section-name selfRef">CWT Containing a COSE_Key</a>
        </h3>
<p id="section-7.9-1">The confirmation method "kcwt" specifies a CBOR Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The format of "kcwt" is the base64url-encoded serialization of the CWT.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-kccs">
<section id="section-7.10">
        <h3 id="name-ccs-containing-a-cose_key-2">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-ccs-containing-a-cose_key-2" class="section-name selfRef">CCS Containing a COSE_Key</a>
        </h3>
<p id="section-7.10-1">The confirmation method "kccs" specifies a CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The format of "kcwt" is the base64url-encoded serialization of the CWT.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-edhoc-endpoint-identity-types">
<section id="section-8">
      <h2 id="name-edhoc-endpoint-identity-typ">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-edhoc-endpoint-identity-typ" class="section-name selfRef">EDHOC Endpoint Identity Types</a>
      </h2>
<p id="section-8-1">This document defines the following identifier of type of endpoint identity for EDHOC.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-8-2" class="pilcrow">¶</a></p>
<span id="name-edhoc-endpoint-identity-type"></span><div id="_table-edhoc-endpoint-identity-types">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-edhoc-endpoint-identity-type" class="selfRef">EDHOC Endpoint Identity Types</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR label</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">EUI-64</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">An EUI-64 identity</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]<span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="sec-edhoc-transports">
<section id="section-9">
      <h2 id="name-edhoc-transports">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-edhoc-transports" class="section-name selfRef">EDHOC Transports</a>
      </h2>
<p id="section-9-1">This document defines the following identifiers of means for transporting EDHOC messages.<a href="#section-9-1" class="pilcrow">¶</a></p>
<span id="name-edhoc-transports-2"></span><div id="_table-edhoc-transports">
<table class="center" id="table-3">
        <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-edhoc-transports-2" class="selfRef">EDHOC Transports</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Transport ID</th>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">CoAP over UDP</td>
            <td class="text-left" rowspan="1" colspan="1">EDHOC messages are transported as payload of CoAP messages, in turn transported over UDP</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">CoAP over TCP</td>
            <td class="text-left" rowspan="1" colspan="1">EDHOC messages are transported as payload of CoAP messages, in turn transported over TCP</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span><span>[<a href="#RFC8323" class="cite xref">RFC8323</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">CoAP over WebSockets</td>
            <td class="text-left" rowspan="1" colspan="1">EDHOC messages are transported as payload of CoAP messages, in turn transported over WebSockets</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span><span>[<a href="#RFC8323" class="cite xref">RFC8323</a>]</span>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="sec-edhoc-ta-purposes">
<section id="section-10">
      <h2 id="name-edhoc-trust-anchor-purposes">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-edhoc-trust-anchor-purposes" class="section-name selfRef">EDHOC Trust Anchor Purposes</a>
      </h2>
<p id="section-10-1">This document defines the following EDHOC trust anchor purpose.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-10-2" class="pilcrow">¶</a></p>
<span id="name-edhoc-trust-anchor-purposes-2"></span><div id="_table-edhoc-ta-purposes">
<table class="center" id="table-4">
        <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-edhoc-trust-anchor-purposes-2" class="selfRef">EDHOC Trust Anchor Purposes</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR label</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">edhoc_cred</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Verifying authentication credentials of other EDHOC peers in EDHOC sessions</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]<span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>
</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-10-4">Trust anchors with purpose "edhoc_cred" are used for verifying authentication credentials of other EDHOC peers in an EDHOC session, and they typically are authentication credentials of Certificate Authorities (CAs).<a href="#section-10-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-edhoc-ta-types">
<section id="section-11">
      <h2 id="name-edhoc-trust-anchor-types">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-edhoc-trust-anchor-types" class="section-name selfRef">EDHOC Trust Anchor Types</a>
      </h2>
<p id="section-11-1">This document defines the following EDHOC trust anchor types.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-11-2" class="pilcrow">¶</a></p>
<span id="name-edhoc-trust-anchor-types-2"></span><div id="_table-edhoc-ta-types">
<table class="center" id="table-5">
        <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-edhoc-trust-anchor-types-2" class="selfRef">EDHOC Trust Anchor Types</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR label</th>
            <th class="text-left" rowspan="1" colspan="1">Value type</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">uuid</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">#6.37(bstr)</td>
            <td class="text-left" rowspan="1" colspan="1">Binary CBOR-encoded UUID</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]<span>[<a href="#RFC9562" class="cite xref">RFC9562</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">kid</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">Key identifier</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]<span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">c5t</td>
            <td class="text-left" rowspan="1" colspan="1">22</td>
            <td class="text-left" rowspan="1" colspan="1">COSE_CertHash</td>
            <td class="text-left" rowspan="1" colspan="1">Hash of a C509 certificate</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX][draft-ietf-cose-cbor-encoded-cert]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">c5u</td>
            <td class="text-left" rowspan="1" colspan="1">23</td>
            <td class="text-left" rowspan="1" colspan="1">uri</td>
            <td class="text-left" rowspan="1" colspan="1">URI pointing to a COSE_C509 containing a ordered chain of certificates</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX][draft-ietf-cose-cbor-encoded-cert]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">x5t</td>
            <td class="text-left" rowspan="1" colspan="1">34</td>
            <td class="text-left" rowspan="1" colspan="1">COSE_CertHash</td>
            <td class="text-left" rowspan="1" colspan="1">Hash of an X.509 certificate</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]<span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">x5u</td>
            <td class="text-left" rowspan="1" colspan="1">35</td>
            <td class="text-left" rowspan="1" colspan="1">uri</td>
            <td class="text-left" rowspan="1" colspan="1">URI pointing to an X.509 certificate</td>
            <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]<span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Thus, the general security considerations from the ACE framework also apply to this profile.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">Furthermore, the security considerations from OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and from EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> also apply to this specific use of the OSCORE and EDHOC protocols.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">As previously stated, once completed the EDHOC session, C and RS are mutually authenticated through their respective authentication credentials, whose retrieval has been facilitated by AS. Also, once completed the EDHOC session, C and RS have established a long-term secret key PRK_out enjoying forward secrecy. This is in turn used by C and RS to establish an OSCORE Security Context.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">Furthermore, RS achieves confirmation that C has PRK_out (proof-of-possession) when completing the EDHOC session. Instead, C achieves confirmation that RS has PRK_out (proof-of-possession) either when receiving the optional EDHOC message_4 from RS, or when successfully verifying a response from RS protected with the established OSCORE Security Context.<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">OSCORE is designed to secure point-to-point communication, providing a secure binding between a request and the corresponding response(s). Thus, the basic OSCORE protocol is not intended for use in point-to-multipoint communication (e.g., enforced via multicast or a publish-subscribe model). Implementers of this profile should make sure that their use case of OSCORE corresponds to the expected one, in order to prevent weakening the security assurances provided by OSCORE.<a href="#section-12-5" class="pilcrow">¶</a></p>
<p id="section-12-6">When using this profile, it is <span class="bcp14">RECOMMENDED</span> that RS stores only one access token per client. The use of multiple access tokens for a single client increases the strain on RS, since it must consider every access token associated with the client and calculate the actual permissions that client has. Also, access tokens indicating different or disjoint permissions from each other may lead RS to enforce wrong permissions.  If one of the access tokens expires earlier than others, the resulting permissions may offer insufficient protection. Developers <span class="bcp14">SHOULD</span> avoid using multiple access tokens for a same client. Furthermore, RS <span class="bcp14">MUST NOT</span> store more than one access token per client per PoP-key (i.e., per client's authentication credential).<a href="#section-12-6" class="pilcrow">¶</a></p>
<p id="section-12-7">This profile defines confirmation methods "kcwt" and "kccs" corresponding to the use of CBOR Web Token (CWT) and CWT Claims Set (CCS), respectively. Security considerations of CWT and CCS, and of COSE header parameters "kcwt" and "kccs" are given in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.8" class="relref">Section 9.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, and apply also to confirmation methods. In particular, the contents of the CWT or CCS must be processed as untrusted input. The application needs to define a trust-establishment mechanism and identify the relevant trust anchors.<a href="#section-12-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-13">
      <h2 id="name-privacy-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-13-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Thus, the general privacy considerations from the ACE framework also apply to this profile.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">Furthermore, the privacy considerations from OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and from EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> also apply to this specific use of the OSCORE and EDHOC protocols.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">An unprotected response to an unauthorized request may disclose information about RS and/or its existing relationship with C. It is advisable to include as little information as possible in an unencrypted response (see also <a href="#as-creation-hints" class="auto internal xref">Section 4.13</a>). When an OSCORE Security Context already exists between C and RS, more detailed information may be included.<a href="#section-13-3" class="pilcrow">¶</a></p>
<p id="section-13-4">The (encrypted) access token is never sent in an unprotected POST request to the /authz-info endpoint at RS. Thus, even if C uses the same single access token from multiple locations, the access token's value does not contribute to the risk of C being tracked.<a href="#section-13-4" class="pilcrow">¶</a></p>
<p id="section-13-5">The identifiers used in OSCORE, i.e., the OSCORE Sender/Recipient IDs, are negotiated by C and RS during the EDHOC session. When using the EDHOC forward (reverse) message flow:<a href="#section-13-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-6.1">
          <p id="section-13-6.1.1">The EDHOC Connection Identifier C_I (C_R) of C is going to be the OSCORE Recipient ID of C, i.e., the OSCORE Sender ID of RS.<a href="#section-13-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-13-6.2">
          <p id="section-13-6.2.1">The EDHOC Connection Identifier C_R (C_I) of RS is going to be the OSCORE Recipient ID of RS, i.e., the OSCORE Sender ID of C.<a href="#section-13-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-13-7">These OSCORE identifiers are privacy sensitive (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-12.8" class="relref">Section 12.8</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>). In particular, they could reveal information about C, or may be used for correlating different requests from C, e.g., across different networks that C has joined and left over time. This can be mitigated if C and RS dynamically update their OSCORE identifiers, e.g., by using the method defined in <span>[<a href="#I-D.ietf-core-oscore-id-update" class="cite xref">I-D.ietf-core-oscore-id-update</a>]</span>.<a href="#section-13-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">This document has the following actions for IANA.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-14-2" class="pilcrow">¶</a></p>
<div id="iana-ace-oauth-profile">
<section id="section-14.1">
        <h3 id="name-ace-profiles-registry">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-ace-profiles-registry" class="section-name selfRef">ACE Profiles Registry</a>
        </h3>
<p id="section-14.1-1">IANA is asked to add the following entry to the "ACE Profiles" registry, following the procedure specified in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1-2.1">
            <p id="section-14.1-2.1.1">Name: coap_edhoc_oscore<a href="#section-14.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.2">
            <p id="section-14.1-2.2.1">Description: Profile for delegating client authentication and authorization in a constrained environment by establishing an OSCORE Security Context <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> between resource-constrained nodes, through the execution of the lightweight authenticated key exchange protocol EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.3">
            <p id="section-14.1-2.3.1">CBOR Value:  TBD (value between 1 and 23)<a href="#section-14.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-2.4">
            <p id="section-14.1-2.4.1">Reference:  [RFC-XXXX]<a href="#section-14.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-params">
<section id="section-14.2">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-14.2-1">IANA is asked to add the following entry to the "OAuth Parameters" registry.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2-2.1">
            <p id="section-14.2-2.1.1">Name: edhoc_info<a href="#section-14.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.2">
            <p id="section-14.2-2.2.1">Parameter Usage Location: token request and token response<a href="#section-14.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.3">
            <p id="section-14.2-2.3.1">Change Controller: IETF<a href="#section-14.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.2-2.4">
            <p id="section-14.2-2.4.1">Reference: [RFC-XXXX]<a href="#section-14.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-cbor-mappings">
<section id="section-14.3">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings Registry</a>
        </h3>
<p id="section-14.3-1">IANA is asked to add the following entry to the "OAuth Parameters CBOR Mappings" registry, following the procedure specified in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3-2.1">
            <p id="section-14.3-2.1.1">Name: edhoc_info<a href="#section-14.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.2">
            <p id="section-14.3-2.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-14.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.3">
            <p id="section-14.3-2.3.1">Value Type: map<a href="#section-14.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.4">
            <p id="section-14.3-2.4.1">Reference: [RFC-XXXX]<a href="#section-14.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.5">
            <p id="section-14.3-2.5.1">Original Specification: [RFC-XXXX]<a href="#section-14.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-json-claims">
<section id="section-14.4">
        <h3 id="name-json-web-token-claims-regis">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-json-web-token-claims-regis" class="section-name selfRef">JSON Web Token Claims Registry</a>
        </h3>
<p id="section-14.4-1">IANA is asked to add the following entries to the "JSON Web Token Claims" registry, following the procedure specified in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.4-2.1">
            <p id="section-14.4-2.1.1">Claim Name: edhoc_info<a href="#section-14.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.4-2.2">
            <p id="section-14.4-2.2.1">Claim Description: Information for EDHOC session<a href="#section-14.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.4-2.3">
            <p id="section-14.4-2.3.1">Change Controller: IETF<a href="#section-14.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.4-2.4">
            <p id="section-14.4-2.4.1">Reference: [RFC-XXXX]<a href="#section-14.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cwt-claims">
<section id="section-14.5">
        <h3 id="name-cbor-web-token-cwt-claims-r">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-cbor-web-token-cwt-claims-r" class="section-name selfRef">CBOR Web Token (CWT) Claims Registry</a>
        </h3>
<p id="section-14.5-1">IANA is asked to add the following entries to the "CBOR Web Token (CWT) Claims" registry, following the procedure specified in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.5-2.1">
            <p id="section-14.5-2.1.1">Claim Name: edhoc_info<a href="#section-14.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-2.2">
            <p id="section-14.5-2.2.1">Claim Description: Information for EDHOC session<a href="#section-14.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-2.3">
            <p id="section-14.5-2.3.1">JWT Claim Name: edhoc_info<a href="#section-14.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-2.4">
            <p id="section-14.5-2.4.1">Claim Key: TBD (value between 1 and 255)<a href="#section-14.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-2.5">
            <p id="section-14.5-2.5.1">Claim Value Type: map<a href="#section-14.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-2.6">
            <p id="section-14.5-2.6.1">Change Controller: IETF<a href="#section-14.5-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.5-2.7">
            <p id="section-14.5-2.7.1">Reference: [RFC-XXXX]<a href="#section-14.5-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-jwt-confirmation-methods">
<section id="section-14.6">
        <h3 id="name-jwt-confirmation-methods-re">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-jwt-confirmation-methods-re" class="section-name selfRef">JWT Confirmation Methods Registry</a>
        </h3>
<p id="section-14.6-1">IANA is asked to add the following entries to the "JWT Confirmation Methods" registry, following the procedure specified in <span>[<a href="#RFC7800" class="cite xref">RFC7800</a>]</span>.<a href="#section-14.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.6-2.1">
            <p id="section-14.6-2.1.1">Confirmation Method Value: x5c<a href="#section-14.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-2.2">
            <p id="section-14.6-2.2.1">Confirmation Method Description: An ordered chain of X.509 certificates<a href="#section-14.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-2.3">
            <p id="section-14.6-2.3.1">Change Controller: IETF<a href="#section-14.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-2.4">
            <p id="section-14.6-2.4.1">Reference: <a href="#ssec-jwt-conf-x5c" class="auto internal xref">Section 7.1</a> of [RFC-XXXX]<a href="#section-14.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-3"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-4.1">
            <p id="section-14.6-4.1.1">Confirmation Method Value: x5b<a href="#section-14.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-4.2">
            <p id="section-14.6-4.2.1">Confirmation Method Description: An unordered bag of X.509 certificates<a href="#section-14.6-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-4.3">
            <p id="section-14.6-4.3.1">Change Controller: IETF<a href="#section-14.6-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-4.4">
            <p id="section-14.6-4.4.1">Reference: <a href="#ssec-jwt-conf-x5b" class="auto internal xref">Section 7.2</a> of [RFC-XXXX]<a href="#section-14.6-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-5"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-6.1">
            <p id="section-14.6-6.1.1">Confirmation Method Value: x5t<a href="#section-14.6-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-6.2">
            <p id="section-14.6-6.2.1">Confirmation Method Description: Hash of an X.509 certificate<a href="#section-14.6-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-6.3">
            <p id="section-14.6-6.3.1">Change Controller: IETF<a href="#section-14.6-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-6.4">
            <p id="section-14.6-6.4.1">Reference: <a href="#ssec-jwt-conf-x5t" class="auto internal xref">Section 7.3</a> of [RFC-XXXX]<a href="#section-14.6-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-7"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-8.1">
            <p id="section-14.6-8.1.1">Confirmation Method Value: x5u<a href="#section-14.6-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-8.2">
            <p id="section-14.6-8.2.1">Confirmation Method Description: URI pointing to an ordered chain of X.509 certificates<a href="#section-14.6-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-8.3">
            <p id="section-14.6-8.3.1">Change Controller: IETF<a href="#section-14.6-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-8.4">
            <p id="section-14.6-8.4.1">Reference: <a href="#ssec-jwt-conf-x5u" class="auto internal xref">Section 7.4</a> of [RFC-XXXX]<a href="#section-14.6-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-9"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-10.1">
            <p id="section-14.6-10.1.1">Confirmation Method Value: c5c<a href="#section-14.6-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-10.2">
            <p id="section-14.6-10.2.1">Confirmation Method Description: An ordered chain of C509 certificates<a href="#section-14.6-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-10.3">
            <p id="section-14.6-10.3.1">Change Controller: IETF<a href="#section-14.6-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-10.4">
            <p id="section-14.6-10.4.1">Reference: <a href="#ssec-jwt-conf-c5c" class="auto internal xref">Section 7.5</a> of [RFC-XXXX]<a href="#section-14.6-10.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-11"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-12.1">
            <p id="section-14.6-12.1.1">Confirmation Method Value: c5b<a href="#section-14.6-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-12.2">
            <p id="section-14.6-12.2.1">Confirmation Method Description: An unordered bag of C509 certificates<a href="#section-14.6-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-12.3">
            <p id="section-14.6-12.3.1">Change Controller: IETF<a href="#section-14.6-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-12.4">
            <p id="section-14.6-12.4.1">Reference: <a href="#ssec-jwt-conf-c5b" class="auto internal xref">Section 7.6</a> of [RFC-XXXX]<a href="#section-14.6-12.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-13"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-14.1">
            <p id="section-14.6-14.1.1">Confirmation Method Value: c5t<a href="#section-14.6-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-14.2">
            <p id="section-14.6-14.2.1">Confirmation Method Description: Hash of a C509 certificate<a href="#section-14.6-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-14.3">
            <p id="section-14.6-14.3.1">Change Controller: IETF<a href="#section-14.6-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-14.4">
            <p id="section-14.6-14.4.1">Reference: <a href="#ssec-jwt-conf-c5t" class="auto internal xref">Section 7.7</a> of [RFC-XXXX]<a href="#section-14.6-14.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-15"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-16.1">
            <p id="section-14.6-16.1.1">Confirmation Method Value: c5u<a href="#section-14.6-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-16.2">
            <p id="section-14.6-16.2.1">Confirmation Method Description: URI pointing to a COSE_C509 containing an ordered chain of C509 certificates<a href="#section-14.6-16.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-16.3">
            <p id="section-14.6-16.3.1">Change Controller: IETF<a href="#section-14.6-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-16.4">
            <p id="section-14.6-16.4.1">Reference: <a href="#ssec-jwt-conf-c5u" class="auto internal xref">Section 7.8</a> of [RFC-XXXX]<a href="#section-14.6-16.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-17"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-18.1">
            <p id="section-14.6-18.1.1">Confirmation Method Value: kcwt<a href="#section-14.6-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-18.2">
            <p id="section-14.6-18.2.1">Confirmation Method Description: A CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-14.6-18.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-18.3">
            <p id="section-14.6-18.3.1">Change Controller: IETF<a href="#section-14.6-18.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-18.4">
            <p id="section-14.6-18.4.1">Reference: <a href="#ssec-jwt-conf-kcwt" class="auto internal xref">Section 7.9</a> of [RFC-XXXX]<a href="#section-14.6-18.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.6-19"><br></p>
<ul class="normal">
<li class="normal" id="section-14.6-20.1">
            <p id="section-14.6-20.1.1">Confirmation Method Value: kccs<a href="#section-14.6-20.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-20.2">
            <p id="section-14.6-20.2.1">Confirmation Method Description: A CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-14.6-20.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-20.3">
            <p id="section-14.6-20.3.1">Change Controller: IETF<a href="#section-14.6-20.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-20.4">
            <p id="section-14.6-20.4.1">Reference: <a href="#ssec-jwt-conf-kccs" class="auto internal xref">Section 7.10</a> of [RFC-XXXX]<a href="#section-14.6-20.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-cwt-confirmation-methods">
<section id="section-14.7">
        <h3 id="name-cwt-confirmation-methods-re">
<a href="#section-14.7" class="section-number selfRef">14.7. </a><a href="#name-cwt-confirmation-methods-re" class="section-name selfRef">CWT Confirmation Methods Registry</a>
        </h3>
<p id="section-14.7-1">IANA is asked to add the following entries to the "CWT Confirmation Methods" registry, following the procedure specified in <span>[<a href="#RFC8747" class="cite xref">RFC8747</a>]</span>.<a href="#section-14.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.7-2.1">
            <p id="section-14.7-2.1.1">Confirmation Method Name: x5chain<a href="#section-14.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.2">
            <p id="section-14.7-2.2.1">Confirmation Method Description: An ordered chain of X.509 certificates<a href="#section-14.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.3">
            <p id="section-14.7-2.3.1">JWT Confirmation Method Name: x5c<a href="#section-14.7-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.4">
            <p id="section-14.7-2.4.1">Confirmation Key: TBD (value between 24 and 255)<a href="#section-14.7-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.5">
            <p id="section-14.7-2.5.1">Confirmation Value Type: COSE_X509<a href="#section-14.7-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.6">
            <p id="section-14.7-2.6.1">Change Controller: IETF<a href="#section-14.7-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-2.7">
            <p id="section-14.7-2.7.1">Reference: <a href="#ssec-cwt-conf-x5chain" class="auto internal xref">Section 6.1</a> of [RFC-XXXX]<a href="#section-14.7-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-3"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-4.1">
            <p id="section-14.7-4.1.1">Confirmation Method Name: x5bag<a href="#section-14.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-4.2">
            <p id="section-14.7-4.2.1">Confirmation Method Description: An unordered bag of X.509 certificates<a href="#section-14.7-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-4.3">
            <p id="section-14.7-4.3.1">JWT Confirmation Method Name: x5b<a href="#section-14.7-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-4.4">
            <p id="section-14.7-4.4.1">Confirmation Key: TBD (value between 24 and 255)<a href="#section-14.7-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-4.5">
            <p id="section-14.7-4.5.1">Confirmation Value Type: COSE_X509<a href="#section-14.7-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-4.6">
            <p id="section-14.7-4.6.1">Change Controller: IETF<a href="#section-14.7-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-4.7">
            <p id="section-14.7-4.7.1">Reference: <a href="#ssec-cwt-conf-x5bag" class="auto internal xref">Section 6.2</a> of [RFC-XXXX]<a href="#section-14.7-4.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-5"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-6.1">
            <p id="section-14.7-6.1.1">Confirmation Method Name: x5t<a href="#section-14.7-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-6.2">
            <p id="section-14.7-6.2.1">Confirmation Method Description: Hash of an X.509 certificate<a href="#section-14.7-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-6.3">
            <p id="section-14.7-6.3.1">JWT Confirmation Method Name: x5t<a href="#section-14.7-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-6.4">
            <p id="section-14.7-6.4.1">Confirmation Key: TBD (value between 1 and 23)<a href="#section-14.7-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-6.5">
            <p id="section-14.7-6.5.1">Confirmation Value Type: COSE_CertHash<a href="#section-14.7-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-6.6">
            <p id="section-14.7-6.6.1">Change Controller: IETF<a href="#section-14.7-6.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-6.7">
            <p id="section-14.7-6.7.1">Reference: <a href="#ssec-cwt-conf-x5t" class="auto internal xref">Section 6.3</a> of [RFC-XXXX]<a href="#section-14.7-6.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-7"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-8.1">
            <p id="section-14.7-8.1.1">Confirmation Method Name: x5u<a href="#section-14.7-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-8.2">
            <p id="section-14.7-8.2.1">Confirmation Method Description: URI pointing to an ordered chain of X.509 certificates<a href="#section-14.7-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-8.3">
            <p id="section-14.7-8.3.1">JWT Confirmation Method Name: x5u<a href="#section-14.7-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-8.4">
            <p id="section-14.7-8.4.1">Confirmation Key: TBD (value between 1 and 23)<a href="#section-14.7-8.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-8.5">
            <p id="section-14.7-8.5.1">Confirmation Value Type: uri<a href="#section-14.7-8.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-8.6">
            <p id="section-14.7-8.6.1">Change Controller: IETF<a href="#section-14.7-8.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-8.7">
            <p id="section-14.7-8.7.1">Reference: <a href="#ssec-cwt-conf-x5u" class="auto internal xref">Section 6.4</a> of [RFC-XXXX]<a href="#section-14.7-8.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-9"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-10.1">
            <p id="section-14.7-10.1.1">Confirmation Method Name: c5c<a href="#section-14.7-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-10.2">
            <p id="section-14.7-10.2.1">Confirmation Method Description: An ordered chain of C509 certificates<a href="#section-14.7-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-10.3">
            <p id="section-14.7-10.3.1">JWT Confirmation Method Name: c5c<a href="#section-14.7-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-10.4">
            <p id="section-14.7-10.4.1">Confirmation Key: TBD (value between 24 and 255)<a href="#section-14.7-10.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-10.5">
            <p id="section-14.7-10.5.1">Confirmation Value Type: COSE_C509<a href="#section-14.7-10.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-10.6">
            <p id="section-14.7-10.6.1">Change Controller: IETF<a href="#section-14.7-10.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-10.7">
            <p id="section-14.7-10.7.1">Reference: <a href="#ssec-cwt-conf-c5c" class="auto internal xref">Section 6.5</a> of [RFC-XXXX]<a href="#section-14.7-10.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-11"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-12.1">
            <p id="section-14.7-12.1.1">Confirmation Method Name: c5b<a href="#section-14.7-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-12.2">
            <p id="section-14.7-12.2.1">Confirmation Method Description: An unordered bag of C509 certificates<a href="#section-14.7-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-12.3">
            <p id="section-14.7-12.3.1">JWT Confirmation Method Name: c5b<a href="#section-14.7-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-12.4">
            <p id="section-14.7-12.4.1">Confirmation Key: TBD (value between 24 and 255)<a href="#section-14.7-12.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-12.5">
            <p id="section-14.7-12.5.1">Confirmation Value Type: COSE_C509<a href="#section-14.7-12.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-12.6">
            <p id="section-14.7-12.6.1">Change Controller: IETF<a href="#section-14.7-12.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-12.7">
            <p id="section-14.7-12.7.1">Reference: <a href="#ssec-cwt-conf-c5b" class="auto internal xref">Section 6.6</a> of [RFC-XXXX]<a href="#section-14.7-12.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-13"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-14.1">
            <p id="section-14.7-14.1.1">Confirmation Method Name: c5t<a href="#section-14.7-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-14.2">
            <p id="section-14.7-14.2.1">Confirmation Method Description: Hash of a C509 certificate<a href="#section-14.7-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-14.3">
            <p id="section-14.7-14.3.1">JWT Confirmation Method Name: c5t<a href="#section-14.7-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-14.4">
            <p id="section-14.7-14.4.1">Confirmation Key: TBD (value between 1 and 23)<a href="#section-14.7-14.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-14.5">
            <p id="section-14.7-14.5.1">Confirmation Value Type: COSE_CertHash<a href="#section-14.7-14.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-14.6">
            <p id="section-14.7-14.6.1">Change Controller: IETF<a href="#section-14.7-14.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-14.7">
            <p id="section-14.7-14.7.1">Reference: <a href="#ssec-cwt-conf-c5t" class="auto internal xref">Section 6.7</a> of [RFC-XXXX]<a href="#section-14.7-14.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-15"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-16.1">
            <p id="section-14.7-16.1.1">Confirmation Method Name: c5u<a href="#section-14.7-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-16.2">
            <p id="section-14.7-16.2.1">Confirmation Method Description: URI pointing to a COSE_C509 containing an ordered chain of C509 certificates<a href="#section-14.7-16.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-16.3">
            <p id="section-14.7-16.3.1">JWT Confirmation Method Name: c5u<a href="#section-14.7-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-16.4">
            <p id="section-14.7-16.4.1">Confirmation Key: TBD (value between 1 and 23)<a href="#section-14.7-16.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-16.5">
            <p id="section-14.7-16.5.1">Confirmation Value Type: uri<a href="#section-14.7-16.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-16.6">
            <p id="section-14.7-16.6.1">Change Controller: IETF<a href="#section-14.7-16.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-16.7">
            <p id="section-14.7-16.7.1">Reference: <a href="#ssec-cwt-conf-c5u" class="auto internal xref">Section 6.8</a> of [RFC-XXXX]<a href="#section-14.7-16.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-17"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-18.1">
            <p id="section-14.7-18.1.1">Confirmation Method Name: kcwt<a href="#section-14.7-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-18.2">
            <p id="section-14.7-18.2.1">Confirmation Method Description: A CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-14.7-18.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-18.3">
            <p id="section-14.7-18.3.1">JWT Confirmation Method Name: kcwt<a href="#section-14.7-18.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-18.4">
            <p id="section-14.7-18.4.1">Confirmation Key: TBD (value between 1 and 23)<a href="#section-14.7-18.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-18.5">
            <p id="section-14.7-18.5.1">Confirmation Value Type: COSE_Messages<a href="#section-14.7-18.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-18.6">
            <p id="section-14.7-18.6.1">Change Controller: IETF<a href="#section-14.7-18.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-18.7">
            <p id="section-14.7-18.7.1">Reference: <a href="#ssec-cwt-conf-kcwt" class="auto internal xref">Section 6.9</a> of [RFC-XXXX]<a href="#section-14.7-18.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.7-19"><br></p>
<ul class="normal">
<li class="normal" id="section-14.7-20.1">
            <p id="section-14.7-20.1.1">Confirmation Method Name: kccs<a href="#section-14.7-20.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-20.2">
            <p id="section-14.7-20.2.1">Confirmation Method Description: A CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-14.7-20.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-20.3">
            <p id="section-14.7-20.3.1">JWT Confirmation Method Name: kccs<a href="#section-14.7-20.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-20.4">
            <p id="section-14.7-20.4.1">Confirmation Key: TBD (value between 1 and 23)<a href="#section-14.7-20.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-20.5">
            <p id="section-14.7-20.5.1">Confirmation Value Type: map / #6(map)<a href="#section-14.7-20.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-20.6">
            <p id="section-14.7-20.6.1">Change Controller: IETF<a href="#section-14.7-20.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.7-20.7">
            <p id="section-14.7-20.7.1">Reference: <a href="#ssec-cwt-conf-kccs" class="auto internal xref">Section 6.10</a> of [RFC-XXXX]<a href="#section-14.7-20.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-edhoc-ead">
<section id="section-14.8">
        <h3 id="name-edhoc-external-authorizatio">
<a href="#section-14.8" class="section-number selfRef">14.8. </a><a href="#name-edhoc-external-authorizatio" class="section-name selfRef">EDHOC External Authorization Data Registry</a>
        </h3>
<p id="section-14.8-1">IANA is asked to add the following entries to the "EDHOC External Authorization Data" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.5" class="relref">Section 10.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.8-2.1">
            <p id="section-14.8-2.1.1">Name: ACE-OAuth Access Token<a href="#section-14.8-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.8-2.2">
            <p id="section-14.8-2.2.1">Label: TBD (value between 24 and 255)<a href="#section-14.8-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.8-2.3">
            <p id="section-14.8-2.3.1">Description: An Access Token as used in the ACE-OAuth framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span><a href="#section-14.8-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.8-2.4">
            <p id="section-14.8-2.4.1">Reference: [RFC-XXXX], <a href="#AT-in-EAD" class="auto internal xref">Section 4.1</a><a href="#section-14.8-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.8-3"><br></p>
<ul class="normal">
<li class="normal" id="section-14.8-4.1">
            <p id="section-14.8-4.1.1">Name: Session ID<a href="#section-14.8-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.8-4.2">
            <p id="section-14.8-4.2.1">Label: TBD (value between 1 and 23)<a href="#section-14.8-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.8-4.3">
            <p id="section-14.8-4.3.1">Description: The identifier of an EDHOC session<a href="#section-14.8-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.8-4.4">
            <p id="section-14.8-4.4.1">Reference: [RFC-XXXX], <a href="#AT-in-EAD" class="auto internal xref">Section 4.1</a><a href="#section-14.8-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-edhoc-parameters">
<section id="section-14.9">
        <h3 id="name-edhoc-information-registry">
<a href="#section-14.9" class="section-number selfRef">14.9. </a><a href="#name-edhoc-information-registry" class="section-name selfRef">EDHOC Information Registry</a>
        </h3>
<p id="section-14.9-1">IANA is requested to create a new "EDHOC Information" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.9-1" class="pilcrow">¶</a></p>
<p id="section-14.9-2">The registration policy is either "Private Use", "Standards Action with Expert Review", "Specification Required" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, or "Expert Review" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#iana-expert-review" class="auto internal xref">Section 14.14</a>.<a href="#section-14.9-2" class="pilcrow">¶</a></p>
<p id="section-14.9-3">All assignments according to "Standards Action with Expert Review" are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, with Expert Review additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of Standards Track code points defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also applies. When such a procedure is used, review and approval by the designated expert are also required, in order for the WG chairs to determine that the conditions for early allocation are met (see step 2 in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>).<a href="#section-14.9-3" class="pilcrow">¶</a></p>
<p id="section-14.9-4">The columns of the registry are:<a href="#section-14.9-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.9-5.1">
            <p id="section-14.9-5.1.1">Name: A descriptive name that enables easier reference to this item. Because a core goal of this document is for the resulting representations to be compact, it is <span class="bcp14">RECOMMENDED</span> that the name be short.<a href="#section-14.9-5.1.1" class="pilcrow">¶</a></p>
<p id="section-14.9-5.1.2">
This name is case sensitive. Names may not match other registered names in a case-insensitive manner unless the Designated Experts determine that there is a compelling reason to allow an exception. The name is not used in the CBOR encoding.<a href="#section-14.9-5.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.9-5.2">
            <p id="section-14.9-5.2.1">CBOR label: The value to be used as CBOR abbreviation of the item.<a href="#section-14.9-5.2.1" class="pilcrow">¶</a></p>
<p id="section-14.9-5.2.2">
The value <span class="bcp14">MUST</span> be unique. The value can be a positive integer, a negative integer, or a string. Integer values between -256 and 255 and strings of length 1 are designated as "Standards Action with Expert Review". Integer values from -65536 to -257 and from 256 to 65535 and strings of maximum length 2 are designated as "Specification Required". Integer values greater than 65535 and strings of length greater than 2 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-14.9-5.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.9-5.3">
            <p id="section-14.9-5.3.1">CBOR type: The CBOR type of the item, or a pointer to the registry that defines its type, when that depends on another item.<a href="#section-14.9-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.9-5.4">
            <p id="section-14.9-5.4.1">Registry: The registry that values of the item may come from, if one exists.<a href="#section-14.9-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.9-5.5">
            <p id="section-14.9-5.5.1">Description: A brief description of the item.<a href="#section-14.9-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.9-5.6">
            <p id="section-14.9-5.6.1">Type: The category of the item, i.e., P if prescriptive or NP if Non-Prescriptive.<a href="#section-14.9-5.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.9-5.7">
            <p id="section-14.9-5.7.1">Specification: A pointer to the public specification for the item, if one exists.<a href="#section-14.9-5.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.9-6">This registry will be initially populated by the values in <a href="#_table-cbor-key-edhoc-params" class="auto internal xref">Table 1</a>. In the "Specification" column, the value for all of these entries will be [RFC-XXXX] and <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.9-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-edhoc-endpoint-identity-types">
<section id="section-14.10">
        <h3 id="name-edhoc-endpoint-identity-types">
<a href="#section-14.10" class="section-number selfRef">14.10. </a><a href="#name-edhoc-endpoint-identity-types" class="section-name selfRef">EDHOC Endpoint Identity Types Registry</a>
        </h3>
<p id="section-14.10-1">IANA is requested to create a new "EDHOC Endpoint Identity Types" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.10-1" class="pilcrow">¶</a></p>
<p id="section-14.10-2">The registration policy is either "Private Use", "Standards Action with Expert Review", or "Specification Required" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#iana-expert-review" class="auto internal xref">Section 14.14</a>.<a href="#section-14.10-2" class="pilcrow">¶</a></p>
<p id="section-14.10-3">All assignments according to "Standards Action with Expert Review" are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, with Expert Review additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of Standards Track code points defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also applies. When such a procedure is used, IANA will ask the designated expert(s) to approve the early allocation before registration. In addition, WG chairs are encouraged to consult the expert(s) early during the process outlined in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.<a href="#section-14.10-3" class="pilcrow">¶</a></p>
<p id="section-14.10-4">The columns of this registry are:<a href="#section-14.10-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.10-5.1">
            <p id="section-14.10-5.1.1">Name: This field contains the name of the EDHOC endpoint identity type.<a href="#section-14.10-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.10-5.2">
            <p id="section-14.10-5.2.1">CBOR label: The value to be used to identify this EDHOC endpoint identity type. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer or a negative integer. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -24 to 23 are designated as "Standards Action with Expert Review". Integer values from -65536 to -25 and from 24 to 65535 are designated as "Specification Required". Integer values smaller than -65536 and greater than 65535 are marked as "Private Use".<a href="#section-14.10-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.10-5.3">
            <p id="section-14.10-5.3.1">Description: This field contains a short description of the EDHOC endpoint identity type.<a href="#section-14.10-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.10-5.4">
            <p id="section-14.10-5.4.1">Reference: This field contains a pointer to the public specification for the EDHOC endpoint identity type.<a href="#section-14.10-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.10-6">This registry has been initially populated with the values in <a href="#_table-edhoc-endpoint-identity-types" class="auto internal xref">Table 2</a>.<a href="#section-14.10-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-edhoc-transports">
<section id="section-14.11">
        <h3 id="name-edhoc-transports-registry">
<a href="#section-14.11" class="section-number selfRef">14.11. </a><a href="#name-edhoc-transports-registry" class="section-name selfRef">EDHOC Transports Registry</a>
        </h3>
<p id="section-14.11-1">IANA is requested to create a new "EDHOC Transports" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.11-1" class="pilcrow">¶</a></p>
<p id="section-14.11-2">The registration policy is either "Private Use", "Standards Action with Expert Review", or "Specification Required" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#iana-expert-review" class="auto internal xref">Section 14.14</a>.<a href="#section-14.11-2" class="pilcrow">¶</a></p>
<p id="section-14.11-3">All assignments according to "Standards Action with Expert Review" are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, with Expert Review additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of Standards Track code points defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also applies. When such a procedure is used, IANA will ask the designated expert(s) to approve the early allocation before registration. In addition, WG chairs are encouraged to consult the expert(s) early during the process outlined in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.<a href="#section-14.11-3" class="pilcrow">¶</a></p>
<p id="section-14.11-4">The columns of this registry are:<a href="#section-14.11-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.11-5.1">
            <p id="section-14.11-5.1.1">Transport ID: The value to be used to identify this means for transporting EDHOC messages. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer or a negative integer. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -24 to 23 are designated as "Standards Action with Expert Review". Integer values from -65536 to -25 and from 24 to 65535 are designated as "Specification Required". Integer values smaller than -65536 and greater than 65535 are marked as "Private Use".<a href="#section-14.11-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.11-5.2">
            <p id="section-14.11-5.2.1">Name: This field contains the name of the means for transporting EDHOC messages.<a href="#section-14.11-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.11-5.3">
            <p id="section-14.11-5.3.1">Description: This field contains a short description of the means used for transporting EDHOC messages.<a href="#section-14.11-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.11-5.4">
            <p id="section-14.11-5.4.1">Reference: This field contains a pointer to the public specification for the means used for transporting EDHOC messages.<a href="#section-14.11-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.11-6">This registry has been initially populated with the values in <a href="#_table-edhoc-transports" class="auto internal xref">Table 3</a>.<a href="#section-14.11-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-edhoc-ta-purposes">
<section id="section-14.12">
        <h3 id="name-edhoc-trust-anchor-purposes-">
<a href="#section-14.12" class="section-number selfRef">14.12. </a><a href="#name-edhoc-trust-anchor-purposes-" class="section-name selfRef">EDHOC Trust Anchor Purposes Registry</a>
        </h3>
<p id="section-14.12-1">IANA is requested to create a new "EDHOC Trust Anchor Purposes" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.12-1" class="pilcrow">¶</a></p>
<p id="section-14.12-2">The registration policy is either "Private Use", "Standards Action with Expert Review", or "Specification Required" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#iana-expert-review" class="auto internal xref">Section 14.14</a>.<a href="#section-14.12-2" class="pilcrow">¶</a></p>
<p id="section-14.12-3">All assignments according to "Standards Action with Expert Review" are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, with Expert Review additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of Standards Track code points defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also applies. When such a procedure is used, IANA will ask the designated expert(s) to approve the early allocation before registration. In addition, WG chairs are encouraged to consult the expert(s) early during the process outlined in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.<a href="#section-14.12-3" class="pilcrow">¶</a></p>
<p id="section-14.12-4">The columns of this registry are:<a href="#section-14.12-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.12-5.1">
            <p id="section-14.12-5.1.1">Name: This field contains the descriptive name of the trust anchor purpose, to enable easier reference to the item. These names <span class="bcp14">MUST</span> be unique.<a href="#section-14.12-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.12-5.2">
            <p id="section-14.12-5.2.1">CBOR label: This field contains the value used to identify the trust anchor purpose. These values <span class="bcp14">MUST</span> be unique. The value can be an unsigned integer or a negative integer. Different ranges of values use different registration policies:<a href="#section-14.12-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.12-5.2.2.1">
                <p id="section-14.12-5.2.2.1.1">Integer values from -24 to 23 are designated as "Standards Action with Expert Review".<a href="#section-14.12-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.12-5.2.2.2">
                <p id="section-14.12-5.2.2.2.1">Integer values from -65536 to -25 and from 24 to 65535 are designated as "Specification Required".<a href="#section-14.12-5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.12-5.2.2.3">
                <p id="section-14.12-5.2.2.3.1">Integer values smaller than -65536 and greater than 65535 are marked as "Private Use".<a href="#section-14.12-5.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-14.12-5.3">
            <p id="section-14.12-5.3.1">Description: This field contains a short description of the trust anchor purpose.<a href="#section-14.12-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.12-5.4">
            <p id="section-14.12-5.4.1">Reference: This field contains a pointer to the public specification for the trust anchor purpose.<a href="#section-14.12-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.12-6">This registry has been initially populated with the values in <a href="#sec-edhoc-ta-purposes" class="auto internal xref">Section 10</a>.<a href="#section-14.12-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-edhoc-ta-types">
<section id="section-14.13">
        <h3 id="name-edhoc-trust-anchor-types-re">
<a href="#section-14.13" class="section-number selfRef">14.13. </a><a href="#name-edhoc-trust-anchor-types-re" class="section-name selfRef">EDHOC Trust Anchor Types Registry</a>
        </h3>
<p id="section-14.13-1">IANA is requested to create a new "EDHOC Trust Anchor Types" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-14.13-1" class="pilcrow">¶</a></p>
<p id="section-14.13-2">The registration policy is either "Private Use", "Standards Action with Expert Review", or "Specification Required" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#iana-expert-review" class="auto internal xref">Section 14.14</a>.<a href="#section-14.13-2" class="pilcrow">¶</a></p>
<p id="section-14.13-3">All assignments according to "Standards Action with Expert Review" are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, with Expert Review additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of Standards Track code points defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also applies. When such a procedure is used, IANA will ask the designated expert(s) to approve the early allocation before registration. In addition, WG chairs are encouraged to consult the expert(s) early during the process outlined in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.<a href="#section-14.13-3" class="pilcrow">¶</a></p>
<p id="section-14.13-4">The columns of this registry are:<a href="#section-14.13-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.13-5.1">
            <p id="section-14.13-5.1.1">Name: This field contains the descriptive name of the type of trust anchor, to enable easier reference to the item. These names <span class="bcp14">MUST</span> be unique.<a href="#section-14.13-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.13-5.2">
            <p id="section-14.13-5.2.1">CBOR label: This field contains the value used to identify the type of trust anchor. These values <span class="bcp14">MUST</span> be unique. The value can be an unsigned integer or a negative integer. Different ranges of values use different registration policies:<a href="#section-14.13-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.13-5.2.2.1">
                <p id="section-14.13-5.2.2.1.1">Integer values from -24 to 23 are designated as "Standards Action with Expert Review".<a href="#section-14.13-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.13-5.2.2.2">
                <p id="section-14.13-5.2.2.2.1">Integer values from -65536 to -25 and from 24 to 65535 are designated as "Specification Required".<a href="#section-14.13-5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.13-5.2.2.3">
                <p id="section-14.13-5.2.2.3.1">Integer values smaller than -65536 and greater than 65535 are marked as "Private Use".<a href="#section-14.13-5.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-14.13-5.3">
            <p id="section-14.13-5.3.1">Value type: This field contains the CBOR type for the value portion of the label.<a href="#section-14.13-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.13-5.4">
            <p id="section-14.13-5.4.1">Description: This field contains a short description of the type of trust anchor.<a href="#section-14.13-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.13-5.5">
            <p id="section-14.13-5.5.1">Reference: This field contains a pointer to the public specification for the type of trust anchor.<a href="#section-14.13-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.13-6">This registry has been initially populated with the values in <a href="#_table-edhoc-ta-types" class="auto internal xref">Table 5</a>.<a href="#section-14.13-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-expert-review">
<section id="section-14.14">
        <h3 id="name-expert-review-instructions">
<a href="#section-14.14" class="section-number selfRef">14.14. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-14.14-1">"Standards Action with Expert Review", "Specification Required", and "Expert Review" are three of the registration policies defined for the IANA registries established in this document. This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-14.14-1" class="pilcrow">¶</a></p>
<p id="section-14.14-2">Expert reviewers should take into consideration the following points:<a href="#section-14.14-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.14-3.1">
            <p id="section-14.14-3.1.1">Clarity and correctness of registrations. Experts are expected to check the clarity of purpose and use of the requested entries. Experts need to make sure that the object of registration is clearly defined in the corresponding specification. Entries that do not meet these objective of clarity and completeness must not be registered.<a href="#section-14.14-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.14-3.2">
            <p id="section-14.14-3.2.1">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as "Private Use" are intended for testing purposes and closed environments. Code points in other ranges should not be assigned for testing.<a href="#section-14.14-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.14-3.3">
            <p id="section-14.14-3.3.1">Specifications are required for the "Standards Action with Expert Review" range of point assignment. Specifications should exist for "Specification Required" ranges, but early assignment before a specification is available is considered to be permissible. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-14.14-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.14-3.4">
            <p id="section-14.14-3.4.1">Experts should take into account the expected usage of fields when approving point assignment. Documents published via Standards Action can also register points outside the Standards Action range. The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-14.14-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-14</span>, <time datetime="2025-06-23" class="refDate">23 June 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-14">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4291">https://www.rfc-editor.org/rfc/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7120">[RFC7120]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refTitle">"Early IANA Allocation of Standards Track Code Points"</span>, <span class="seriesInfo">BCP 100</span>, <span class="seriesInfo">RFC 7120</span>, <span class="seriesInfo">DOI 10.17487/RFC7120</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7120">https://www.rfc-editor.org/rfc/rfc7120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8323">[RFC8323]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Lemay, S.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Hartke, K.</span>, <span class="refAuthor">Silverajan, B.</span>, and <span class="refAuthor">B. Raymor, Ed.</span>, <span class="refTitle">"CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets"</span>, <span class="seriesInfo">RFC 8323</span>, <span class="seriesInfo">DOI 10.17487/RFC8323</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8323">https://www.rfc-editor.org/rfc/rfc8323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8742">https://www.rfc-editor.org/rfc/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9200">https://www.rfc-editor.org/rfc/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9201">[RFC9201]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9201</span>, <span class="seriesInfo">DOI 10.17487/RFC9201</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9201">https://www.rfc-editor.org/rfc/rfc9201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9203">https://www.rfc-editor.org/rfc/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9360">[RFC9360]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9360">https://www.rfc-editor.org/rfc/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9562">[RFC9562]</dt>
        <dd>
<span class="refAuthor">Davis, K.</span>, <span class="refAuthor">Peabody, B.</span>, and <span class="refAuthor">P. Leach</span>, <span class="refTitle">"Universally Unique IDentifiers (UUIDs)"</span>, <span class="seriesInfo">RFC 9562</span>, <span class="seriesInfo">DOI 10.17487/RFC9562</span>, <time datetime="2024-05" class="refDate">May 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9562">https://www.rfc-editor.org/rfc/rfc9562</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9668">[RFC9668]</dt>
      <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, <span class="refAuthor">Hristozov, S.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Using Ephemeral Diffie-Hellman Over COSE (EDHOC) with the Constrained Application Protocol (CoAP) and Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 9668</span>, <span class="seriesInfo">DOI 10.17487/RFC9668</span>, <time datetime="2024-11" class="refDate">November 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9668">https://www.rfc-editor.org/rfc/rfc9668</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-coap-est-oscore">[I-D.ietf-ace-coap-est-oscore]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Furuhed, M.</span>, <span class="refAuthor">Vučinić, M.</span>, and <span class="refAuthor">T. Claeys</span>, <span class="refTitle">"Protecting EST Payloads with OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-coap-est-oscore-07</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-coap-est-oscore-07">https://datatracker.ietf.org/doc/html/draft-ietf-ace-coap-est-oscore-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-group-oscore-profile">[I-D.ietf-ace-group-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"The Group Object Security for Constrained RESTful Environments (Group OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-group-oscore-profile-04</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-group-oscore-profile-04">https://datatracker.ietf.org/doc/html/draft-ietf-ace-group-oscore-profile-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-workflow-and-params">[I-D.ietf-ace-workflow-and-params]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Short Distribution Chain (SDC) Workflow and New OAuth Parameters for the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-workflow-and-params-04</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-workflow-and-params-04">https://datatracker.ietf.org/doc/html/draft-ietf-ace-workflow-and-params-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-14</span>, <time datetime="2025-07-02" class="refDate">2 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-14">https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-id-update">[I-D.ietf-core-oscore-id-update]</dt>
        <dd>
<span class="refAuthor">Höglund, R.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Identifier Update for OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-id-update-02</span>, <time datetime="2025-01-08" class="refDate">8 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-id-update-02">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-id-update-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-key-update">[I-D.ietf-core-oscore-key-update]</dt>
        <dd>
<span class="refAuthor">Höglund, R.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Update for OSCORE (KUDOS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-key-update-10</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lake-app-profiles">[I-D.ietf-lake-app-profiles]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"Coordinating the Use of Application Profiles for Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-app-profiles-01</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-app-profiles-01">https://datatracker.ietf.org/doc/html/draft-ietf-lake-app-profiles-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lake-authz">[I-D.ietf-lake-authz]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Vučinić, M.</span>, <span class="refAuthor">Fedrecheski, G.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Lightweight Authorization using Ephemeral Diffie-Hellman Over COSE (ELA)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-authz-04</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-authz-04">https://datatracker.ietf.org/doc/html/draft-ietf-lake-authz-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.serafin-lake-ta-hint">[I-D.serafin-lake-ta-hint]</dt>
        <dd>
<span class="refAuthor">Serafin, M.</span> and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Trust Anchor Hints in Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-serafin-lake-ta-hint-00</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-serafin-lake-ta-hint-00">https://datatracker.ietf.org/doc/html/draft-serafin-lake-ta-hint-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">This appendix provides examples where this profile of ACE is used. In particular:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1"><a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a> does not make use of use of any optimization.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1"><a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a> makes use of the optimizations defined in <span>[<a href="#RFC9668" class="cite xref">RFC9668</a>]</span>, hence reducing the roundtrips of the interactions between C and RS.<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-3">All these examples build on the following assumptions, as relying on expected early procedures performed at AS. These include the registration of resource servers by the respective resource owners as well as the registrations of clients authorized to request access tokens for those resource servers.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-4.1">
          <p id="appendix-A-4.1.1">AS knows the authentication credential AUTH_CRED_C of C.<a href="#appendix-A-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.2">
          <p id="appendix-A-4.2.1">C knows the authentication credential AUTH_CRED_AS of AS.<a href="#appendix-A-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.3">
          <p id="appendix-A-4.3.1">AS knows the authentication credential AUTH_CRED_RS of RS.<a href="#appendix-A-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.4">
          <p id="appendix-A-4.4.1">RS knows the authentication credential AUTH_CRED_AS of AS.<a href="#appendix-A-4.4.1" class="pilcrow">¶</a></p>
<p id="appendix-A-4.4.2">
This is relevant in case AS and RS actually require a secure association (e.g., for RS to perform token introspection at AS, or for AS to upload an access token to RS on behalf of C as described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>).<a href="#appendix-A-4.4.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-5">As a result of the assumptions above, it is possible to limit the transport of AUTH_CRED_C and AUTH_CRED_RS by value only to the following two cases, and only when C requests an access token for RS for the first time when considering the pair (AUTH_CRED_C, AUTH_CRED_RS).<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-6.1">
          <p id="appendix-A-6.1.1">In the access token response from AS to C, where AUTH_CRED_RS is specified by the "rs_cnf" parameter.<a href="#appendix-A-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.2">
          <p id="appendix-A-6.2.1">In the access token, where AUTH_CRED_C is specified by the "cnf" claim.<a href="#appendix-A-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-7">Note that, even under the circumstances mentioned above, AUTH_CRED_C might rather be identified by reference. This is possible if RS can effectively use such a reference from the access token to retrieve AUTH_CRED_C (e.g., from a trusted repository of authentication credentials reachable through a non-constrained link), and if AS is in turn aware of that.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<p id="appendix-A-8">In any other case, it is otherwise possible to identify both AUTH_CRED_C and AUTH_CRED_RS by reference, when performing the ACE access control workflow as well as later on when C and RS run EDHOC.<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<div id="example-without-optimization">
<section id="appendix-A.1">
        <h3 id="name-workflow-without-optimizati">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-workflow-without-optimizati" class="section-name selfRef">Workflow without Optimizations</a>
        </h3>
<p id="appendix-A.1-1">The example below shows a simple interaction between C and RS: C and RS run EDHOC wherein C uploads the access token to RS, and then accesses a protected resource at RS.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div id="appendix-A.1-2">
          <div class="alignLeft art-svg artwork" id="appendix-A.1-2.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="3040" width="576" viewBox="0 0 576 3040" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 40,48 L 40,832" fill="none" stroke="black"></path>
              <path d="M 40,928 L 40,1264" fill="none" stroke="black"></path>
              <path d="M 40,1360 L 40,1520" fill="none" stroke="black"></path>
              <path d="M 40,1712 L 40,1728" fill="none" stroke="black"></path>
              <path d="M 40,1792 L 40,1808" fill="none" stroke="black"></path>
              <path d="M 40,1952 L 40,3024" fill="none" stroke="black"></path>
              <path d="M 320,48 L 320,832" fill="none" stroke="black"></path>
              <path d="M 320,928 L 320,984" fill="none" stroke="black"></path>
              <path d="M 320,1000 L 320,1048" fill="none" stroke="black"></path>
              <path d="M 320,1064 L 320,1176" fill="none" stroke="black"></path>
              <path d="M 320,1192 L 320,1264" fill="none" stroke="black"></path>
              <path d="M 320,1360 L 320,1432" fill="none" stroke="black"></path>
              <path d="M 320,1448 L 320,1496" fill="none" stroke="black"></path>
              <path d="M 320,1712 L 320,1728" fill="none" stroke="black"></path>
              <path d="M 320,1792 L 320,1808" fill="none" stroke="black"></path>
              <path d="M 320,1952 L 320,2552" fill="none" stroke="black"></path>
              <path d="M 320,2568 L 320,2632" fill="none" stroke="black"></path>
              <path d="M 320,2648 L 320,2760" fill="none" stroke="black"></path>
              <path d="M 320,2776 L 320,2920" fill="none" stroke="black"></path>
              <path d="M 320,2936 L 320,3000" fill="none" stroke="black"></path>
              <path d="M 568,48 L 568,832" fill="none" stroke="black"></path>
              <path d="M 568,928 L 568,1264" fill="none" stroke="black"></path>
              <path d="M 568,1360 L 568,1520" fill="none" stroke="black"></path>
              <path d="M 568,1712 L 568,1728" fill="none" stroke="black"></path>
              <path d="M 568,1792 L 568,1808" fill="none" stroke="black"></path>
              <path d="M 568,1952 L 568,3024" fill="none" stroke="black"></path>
              <path d="M 40,80 L 312,80" fill="none" stroke="black"></path>
              <path d="M 48,144 L 320,144" fill="none" stroke="black"></path>
              <path d="M 40,256 L 312,256" fill="none" stroke="black"></path>
              <path d="M 40,384 L 312,384" fill="none" stroke="black"></path>
              <path d="M 48,496 L 320,496" fill="none" stroke="black"></path>
              <path d="M 40,992 L 560,992" fill="none" stroke="black"></path>
              <path d="M 48,1056 L 568,1056" fill="none" stroke="black"></path>
              <path d="M 40,1184 L 560,1184" fill="none" stroke="black"></path>
              <path d="M 40,1440 L 560,1440" fill="none" stroke="black"></path>
              <path d="M 48,1504 L 568,1504" fill="none" stroke="black"></path>
              <path d="M 40,2016 L 312,2016" fill="none" stroke="black"></path>
              <path d="M 48,2144 L 320,2144" fill="none" stroke="black"></path>
              <path d="M 40,2560 L 560,2560" fill="none" stroke="black"></path>
              <path d="M 48,2640 L 568,2640" fill="none" stroke="black"></path>
              <path d="M 40,2768 L 560,2768" fill="none" stroke="black"></path>
              <path d="M 40,2928 L 560,2928" fill="none" stroke="black"></path>
              <path d="M 48,3008 L 568,3008" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="568,2928 556,2922.4 556,2933.6" fill="black" transform="rotate(0,560,2928)"></polygon>
              <polygon class="arrowhead" points="568,2768 556,2762.4 556,2773.6" fill="black" transform="rotate(0,560,2768)"></polygon>
              <polygon class="arrowhead" points="568,2560 556,2554.4 556,2565.6" fill="black" transform="rotate(0,560,2560)"></polygon>
              <polygon class="arrowhead" points="568,1440 556,1434.4 556,1445.6" fill="black" transform="rotate(0,560,1440)"></polygon>
              <polygon class="arrowhead" points="568,1184 556,1178.4 556,1189.6" fill="black" transform="rotate(0,560,1184)"></polygon>
              <polygon class="arrowhead" points="568,992 556,986.4 556,997.6" fill="black" transform="rotate(0,560,992)"></polygon>
              <polygon class="arrowhead" points="320,2016 308,2010.4 308,2021.6" fill="black" transform="rotate(0,312,2016)"></polygon>
              <polygon class="arrowhead" points="320,384 308,378.4 308,389.6" fill="black" transform="rotate(0,312,384)"></polygon>
              <polygon class="arrowhead" points="320,256 308,250.4 308,261.6" fill="black" transform="rotate(0,312,256)"></polygon>
              <polygon class="arrowhead" points="320,80 308,74.4 308,85.6" fill="black" transform="rotate(0,312,80)"></polygon>
              <polygon class="arrowhead" points="56,3008 44,3002.4 44,3013.6" fill="black" transform="rotate(180,48,3008)"></polygon>
              <polygon class="arrowhead" points="56,2640 44,2634.4 44,2645.6" fill="black" transform="rotate(180,48,2640)"></polygon>
              <polygon class="arrowhead" points="56,2144 44,2138.4 44,2149.6" fill="black" transform="rotate(180,48,2144)"></polygon>
              <polygon class="arrowhead" points="56,1504 44,1498.4 44,1509.6" fill="black" transform="rotate(180,48,1504)"></polygon>
              <polygon class="arrowhead" points="56,1056 44,1050.4 44,1061.6" fill="black" transform="rotate(180,48,1056)"></polygon>
              <polygon class="arrowhead" points="56,496 44,490.4 44,501.6" fill="black" transform="rotate(180,48,496)"></polygon>
              <polygon class="arrowhead" points="56,144 44,138.4 44,149.6" fill="black" transform="rotate(180,48,144)"></polygon>
              <g class="text">
                <text x="40" y="36">C</text>
                <text x="316" y="36">AS</text>
                <text x="564" y="36">RS</text>
                <text x="80" y="68">EDHOC</text>
                <text x="144" y="68">message_1</text>
                <text x="196" y="68">to</text>
                <text x="236" y="68">/edhoc</text>
                <text x="16" y="84">M01</text>
                <text x="80" y="132">EDHOC</text>
                <text x="144" y="132">message_2</text>
                <text x="16" y="148">M02</text>
                <text x="96" y="164">ID_CRED_R</text>
                <text x="180" y="164">identifies</text>
                <text x="108" y="180">CRED_R</text>
                <text x="144" y="180">=</text>
                <text x="204" y="180">AUTH_CRED_AS</text>
                <text x="92" y="196">by</text>
                <text x="144" y="196">reference</text>
                <text x="80" y="244">EDHOC</text>
                <text x="144" y="244">message_3</text>
                <text x="196" y="244">to</text>
                <text x="236" y="244">/edhoc</text>
                <text x="16" y="260">M03</text>
                <text x="96" y="276">ID_CRED_I</text>
                <text x="180" y="276">identifies</text>
                <text x="108" y="292">CRED_I</text>
                <text x="144" y="292">=</text>
                <text x="200" y="292">AUTH_CRED_C</text>
                <text x="92" y="308">by</text>
                <text x="144" y="308">reference</text>
                <text x="80" y="356">Token</text>
                <text x="136" y="356">request</text>
                <text x="180" y="356">to</text>
                <text x="220" y="356">/token</text>
                <text x="128" y="372">(OSCORE-protected</text>
                <text x="236" y="372">message)</text>
                <text x="16" y="388">M04</text>
                <text x="96" y="404">"req_cnf"</text>
                <text x="180" y="404">identifies</text>
                <text x="128" y="420">AUTH_CRED_C</text>
                <text x="188" y="420">by</text>
                <text x="240" y="420">reference</text>
                <text x="80" y="468">Token</text>
                <text x="140" y="468">response</text>
                <text x="128" y="484">(OSCORE-protected</text>
                <text x="236" y="484">message)</text>
                <text x="16" y="500">M05</text>
                <text x="92" y="516">"rs_cnf"</text>
                <text x="168" y="516">specifies</text>
                <text x="132" y="532">AUTH_CRED_RS</text>
                <text x="196" y="532">by</text>
                <text x="232" y="532">value</text>
                <text x="112" y="564">"ace_profile"</text>
                <text x="208" y="564">specifies</text>
                <text x="264" y="564">the</text>
                <text x="72" y="580">ACE</text>
                <text x="120" y="580">profile</text>
                <text x="232" y="580">"coap_edhoc_oscore"</text>
                <text x="108" y="612">"edhoc_info"</text>
                <text x="204" y="612">specifies:</text>
                <text x="88" y="628">{</text>
                <text x="152" y="644">e'session_id'</text>
                <text x="216" y="644">:</text>
                <text x="252" y="644">h'01',</text>
                <text x="164" y="660">e'cipher_suites'</text>
                <text x="240" y="660">:</text>
                <text x="260" y="660">2,</text>
                <text x="140" y="676">e'methods'</text>
                <text x="192" y="676">:</text>
                <text x="212" y="676">3,</text>
                <text x="144" y="692">e'uri_path'</text>
                <text x="200" y="692">:</text>
                <text x="244" y="692">"/edhoc"</text>
                <text x="88" y="708">}</text>
                <text x="68" y="740">In</text>
                <text x="96" y="740">the</text>
                <text x="140" y="740">access</text>
                <text x="196" y="740">token:</text>
                <text x="64" y="756">-</text>
                <text x="88" y="756">the</text>
                <text x="128" y="756">"cnf"</text>
                <text x="176" y="756">claim</text>
                <text x="240" y="756">specifies</text>
                <text x="120" y="772">AUTH_CRED_C</text>
                <text x="180" y="772">by</text>
                <text x="216" y="772">value</text>
                <text x="64" y="788">-</text>
                <text x="88" y="788">the</text>
                <text x="156" y="788">"edhoc_info"</text>
                <text x="232" y="788">claim</text>
                <text x="112" y="804">specifies</text>
                <text x="168" y="804">the</text>
                <text x="204" y="804">same</text>
                <text x="236" y="804">as</text>
                <text x="124" y="820">"edhoc_info"</text>
                <text x="200" y="820">above</text>
                <text x="76" y="868">Possibly</text>
                <text x="136" y="868">after</text>
                <text x="184" y="868">chain</text>
                <text x="264" y="868">verification,</text>
                <text x="328" y="868">C</text>
                <text x="356" y="868">adds</text>
                <text x="428" y="868">AUTH_CRED_RS</text>
                <text x="52" y="884">to</text>
                <text x="80" y="884">the</text>
                <text x="112" y="884">set</text>
                <text x="140" y="884">of</text>
                <text x="168" y="884">its</text>
                <text x="216" y="884">trusted</text>
                <text x="268" y="884">peer</text>
                <text x="348" y="884">authentication</text>
                <text x="460" y="884">credentials,</text>
                <text x="72" y="900">relying</text>
                <text x="116" y="900">on</text>
                <text x="140" y="900">AS</text>
                <text x="164" y="900">as</text>
                <text x="208" y="900">trusted</text>
                <text x="276" y="900">provider</text>
                <text x="80" y="964">EDHOC</text>
                <text x="144" y="964">message_1</text>
                <text x="196" y="964">to</text>
                <text x="236" y="964">/edhoc</text>
                <text x="72" y="980">(no</text>
                <text x="116" y="980">access</text>
                <text x="176" y="980">control</text>
                <text x="220" y="980">is</text>
                <text x="272" y="980">enforced)</text>
                <text x="16" y="996">M06</text>
                <text x="80" y="1044">EDHOC</text>
                <text x="144" y="1044">message_2</text>
                <text x="16" y="1060">M07</text>
                <text x="96" y="1076">ID_CRED_R</text>
                <text x="180" y="1076">identifies</text>
                <text x="108" y="1092">CRED_R</text>
                <text x="144" y="1092">=</text>
                <text x="204" y="1092">AUTH_CRED_RS</text>
                <text x="92" y="1108">by</text>
                <text x="144" y="1108">reference</text>
                <text x="80" y="1156">EDHOC</text>
                <text x="144" y="1156">message_3</text>
                <text x="196" y="1156">to</text>
                <text x="236" y="1156">/edhoc</text>
                <text x="72" y="1172">(no</text>
                <text x="116" y="1172">access</text>
                <text x="176" y="1172">control</text>
                <text x="220" y="1172">is</text>
                <text x="272" y="1172">enforced)</text>
                <text x="16" y="1188">M08</text>
                <text x="112" y="1204">EAD_3</text>
                <text x="172" y="1204">contains</text>
                <text x="236" y="1204">access</text>
                <text x="288" y="1204">token</text>
                <text x="96" y="1220">ID_CRED_I</text>
                <text x="180" y="1220">identifies</text>
                <text x="108" y="1236">CRED_I</text>
                <text x="144" y="1236">=</text>
                <text x="200" y="1236">AUTH_CRED_C</text>
                <text x="92" y="1252">by</text>
                <text x="144" y="1252">reference</text>
                <text x="76" y="1300">Possibly</text>
                <text x="136" y="1300">after</text>
                <text x="184" y="1300">chain</text>
                <text x="264" y="1300">verification,</text>
                <text x="332" y="1300">RS</text>
                <text x="364" y="1300">adds</text>
                <text x="432" y="1300">AUTH_CRED_C</text>
                <text x="52" y="1316">to</text>
                <text x="80" y="1316">the</text>
                <text x="112" y="1316">set</text>
                <text x="140" y="1316">of</text>
                <text x="168" y="1316">its</text>
                <text x="216" y="1316">trusted</text>
                <text x="268" y="1316">peer</text>
                <text x="348" y="1316">authentication</text>
                <text x="460" y="1316">credentials,</text>
                <text x="72" y="1332">relying</text>
                <text x="116" y="1332">on</text>
                <text x="140" y="1332">AS</text>
                <text x="164" y="1332">as</text>
                <text x="208" y="1332">trusted</text>
                <text x="276" y="1332">provider</text>
                <text x="84" y="1396">Access</text>
                <text x="124" y="1396">to</text>
                <text x="176" y="1396">protected</text>
                <text x="252" y="1396">resource</text>
                <text x="128" y="1412">(OSCORE-protected</text>
                <text x="236" y="1412">message)</text>
                <text x="88" y="1428">(access</text>
                <text x="152" y="1428">control</text>
                <text x="196" y="1428">is</text>
                <text x="248" y="1428">enforced)</text>
                <text x="16" y="1444">M08</text>
                <text x="92" y="1476">Response</text>
                <text x="128" y="1492">(OSCORE-protected</text>
                <text x="236" y="1492">message)</text>
                <text x="16" y="1508">M10</text>
                <text x="320" y="1524">|</text>
                <text x="64" y="1556">Later</text>
                <text x="104" y="1556">on,</text>
                <text x="136" y="1556">the</text>
                <text x="180" y="1556">access</text>
                <text x="232" y="1556">token</text>
                <text x="288" y="1556">expires</text>
                <text x="336" y="1556">...</text>
                <text x="56" y="1588">-</text>
                <text x="72" y="1588">C</text>
                <text x="96" y="1588">and</text>
                <text x="124" y="1588">RS</text>
                <text x="164" y="1588">delete</text>
                <text x="216" y="1588">their</text>
                <text x="268" y="1588">OSCORE</text>
                <text x="332" y="1588">Security</text>
                <text x="400" y="1588">Context</text>
                <text x="448" y="1588">and</text>
                <text x="488" y="1588">purge</text>
                <text x="80" y="1604">the</text>
                <text x="120" y="1604">EDHOC</text>
                <text x="176" y="1604">session</text>
                <text x="228" y="1604">used</text>
                <text x="260" y="1604">to</text>
                <text x="300" y="1604">derive</text>
                <text x="340" y="1604">it</text>
                <text x="384" y="1604">(unless</text>
                <text x="432" y="1604">the</text>
                <text x="468" y="1604">same</text>
                <text x="96" y="1620">session</text>
                <text x="140" y="1620">is</text>
                <text x="172" y="1620">also</text>
                <text x="212" y="1620">used</text>
                <text x="248" y="1620">for</text>
                <text x="288" y="1620">other</text>
                <text x="352" y="1620">reasons).</text>
                <text x="56" y="1636">-</text>
                <text x="76" y="1636">RS</text>
                <text x="120" y="1636">retains</text>
                <text x="200" y="1636">AUTH_CRED_C</text>
                <text x="260" y="1636">as</text>
                <text x="296" y="1636">still</text>
                <text x="348" y="1636">valid,</text>
                <text x="80" y="1652">and</text>
                <text x="108" y="1652">AS</text>
                <text x="144" y="1652">knows</text>
                <text x="192" y="1652">about</text>
                <text x="232" y="1652">it.</text>
                <text x="56" y="1668">-</text>
                <text x="80" y="1668">The</text>
                <text x="124" y="1668">Client</text>
                <text x="184" y="1668">retains</text>
                <text x="268" y="1668">AUTH_CRED_RS</text>
                <text x="332" y="1668">as</text>
                <text x="368" y="1668">still</text>
                <text x="420" y="1668">valid,</text>
                <text x="80" y="1684">and</text>
                <text x="108" y="1684">AS</text>
                <text x="144" y="1684">knows</text>
                <text x="192" y="1684">about</text>
                <text x="232" y="1684">it.</text>
                <text x="60" y="1764">Time</text>
                <text x="108" y="1764">passes</text>
                <text x="152" y="1764">...</text>
                <text x="48" y="1844">C</text>
                <text x="76" y="1844">asks</text>
                <text x="112" y="1844">for</text>
                <text x="136" y="1844">a</text>
                <text x="160" y="1844">new</text>
                <text x="204" y="1844">access</text>
                <text x="260" y="1844">token;</text>
                <text x="304" y="1844">now</text>
                <text x="336" y="1844">all</text>
                <text x="368" y="1844">the</text>
                <text x="100" y="1860">authentication</text>
                <text x="208" y="1860">credentials</text>
                <text x="272" y="1860">can</text>
                <text x="300" y="1860">be</text>
                <text x="356" y="1860">identifies</text>
                <text x="412" y="1860">by</text>
                <text x="464" y="1860">reference</text>
                <text x="56" y="1892">The</text>
                <text x="96" y="1892">price</text>
                <text x="132" y="1892">to</text>
                <text x="160" y="1892">pay</text>
                <text x="188" y="1892">is</text>
                <text x="212" y="1892">on</text>
                <text x="240" y="1892">AS,</text>
                <text x="280" y="1892">about</text>
                <text x="352" y="1892">remembering</text>
                <text x="420" y="1892">that</text>
                <text x="452" y="1892">at</text>
                <text x="488" y="1892">least</text>
                <text x="56" y="1908">one</text>
                <text x="100" y="1908">access</text>
                <text x="152" y="1908">token</text>
                <text x="192" y="1908">has</text>
                <text x="228" y="1908">been</text>
                <text x="276" y="1908">issued</text>
                <text x="320" y="1908">for</text>
                <text x="352" y="1908">the</text>
                <text x="388" y="1908">pair</text>
                <text x="444" y="1908">(Client,</text>
                <text x="496" y="1908">RS)</text>
                <text x="56" y="1924">and</text>
                <text x="120" y="1924">considering</text>
                <text x="184" y="1924">the</text>
                <text x="220" y="1924">pair</text>
                <text x="296" y="1924">(AUTH_CRED_C,</text>
                <text x="408" y="1924">AUTH_CRED_RS)</text>
                <text x="80" y="1988">Token</text>
                <text x="136" y="1988">request</text>
                <text x="180" y="1988">to</text>
                <text x="220" y="1988">/token</text>
                <text x="128" y="2004">(OSCORE-protected</text>
                <text x="236" y="2004">message)</text>
                <text x="16" y="2020">M11</text>
                <text x="96" y="2036">"req_cnf"</text>
                <text x="180" y="2036">identifies</text>
                <text x="108" y="2052">CRED_I</text>
                <text x="144" y="2052">=</text>
                <text x="200" y="2052">AUTH_CRED_C</text>
                <text x="92" y="2068">by</text>
                <text x="144" y="2068">reference</text>
                <text x="80" y="2116">Token</text>
                <text x="140" y="2116">response</text>
                <text x="128" y="2132">(OSCORE-protected</text>
                <text x="236" y="2132">message)</text>
                <text x="16" y="2148">M12</text>
                <text x="92" y="2164">"rs_cnf"</text>
                <text x="172" y="2164">identifies</text>
                <text x="132" y="2180">AUTH_CRED_RS</text>
                <text x="196" y="2180">by</text>
                <text x="248" y="2180">reference</text>
                <text x="112" y="2212">"ace_profile"</text>
                <text x="208" y="2212">specifies</text>
                <text x="264" y="2212">the</text>
                <text x="72" y="2228">ACE</text>
                <text x="120" y="2228">profile</text>
                <text x="232" y="2228">"coap_edhoc_oscore"</text>
                <text x="108" y="2260">"edhoc_info"</text>
                <text x="204" y="2260">specifies:</text>
                <text x="88" y="2276">{</text>
                <text x="152" y="2292">e'session_id'</text>
                <text x="216" y="2292">:</text>
                <text x="252" y="2292">h'05',</text>
                <text x="164" y="2308">e'cipher_suites'</text>
                <text x="240" y="2308">:</text>
                <text x="260" y="2308">2,</text>
                <text x="140" y="2324">e'methods'</text>
                <text x="192" y="2324">:</text>
                <text x="212" y="2324">3,</text>
                <text x="144" y="2340">e'uri_path'</text>
                <text x="200" y="2340">:</text>
                <text x="244" y="2340">"/edhoc"</text>
                <text x="88" y="2356">}</text>
                <text x="68" y="2388">In</text>
                <text x="96" y="2388">the</text>
                <text x="140" y="2388">access</text>
                <text x="196" y="2388">token:</text>
                <text x="64" y="2404">-</text>
                <text x="88" y="2404">the</text>
                <text x="128" y="2404">"cnf"</text>
                <text x="176" y="2404">claim</text>
                <text x="244" y="2404">identifies</text>
                <text x="120" y="2420">AUTH_CRED_C</text>
                <text x="180" y="2420">by</text>
                <text x="232" y="2420">reference</text>
                <text x="64" y="2436">-</text>
                <text x="88" y="2436">the</text>
                <text x="156" y="2436">"edhoc_info"</text>
                <text x="232" y="2436">claim</text>
                <text x="112" y="2452">specifies</text>
                <text x="168" y="2452">the</text>
                <text x="204" y="2452">same</text>
                <text x="236" y="2452">as</text>
                <text x="124" y="2468">"edhoc_info"</text>
                <text x="200" y="2468">above</text>
                <text x="80" y="2532">EDHOC</text>
                <text x="144" y="2532">message_1</text>
                <text x="196" y="2532">to</text>
                <text x="236" y="2532">/edhoc</text>
                <text x="72" y="2548">(no</text>
                <text x="116" y="2548">access</text>
                <text x="176" y="2548">control</text>
                <text x="220" y="2548">is</text>
                <text x="272" y="2548">enforced)</text>
                <text x="16" y="2564">M13</text>
                <text x="80" y="2612">EDHOC</text>
                <text x="144" y="2612">message_2</text>
                <text x="72" y="2628">(no</text>
                <text x="116" y="2628">access</text>
                <text x="176" y="2628">control</text>
                <text x="220" y="2628">is</text>
                <text x="272" y="2628">enforced)</text>
                <text x="16" y="2644">M14</text>
                <text x="96" y="2660">ID_CRED_R</text>
                <text x="180" y="2660">identifies</text>
                <text x="108" y="2676">CRED_R</text>
                <text x="144" y="2676">=</text>
                <text x="204" y="2676">AUTH_CRED_RS</text>
                <text x="92" y="2692">by</text>
                <text x="144" y="2692">reference</text>
                <text x="80" y="2740">EDHOC</text>
                <text x="144" y="2740">message_3</text>
                <text x="196" y="2740">to</text>
                <text x="236" y="2740">/edhoc</text>
                <text x="72" y="2756">(no</text>
                <text x="116" y="2756">access</text>
                <text x="176" y="2756">control</text>
                <text x="220" y="2756">is</text>
                <text x="272" y="2756">enforced)</text>
                <text x="16" y="2772">M15</text>
                <text x="112" y="2788">EAD_3</text>
                <text x="172" y="2788">contains</text>
                <text x="236" y="2788">access</text>
                <text x="288" y="2788">token</text>
                <text x="96" y="2804">ID_CRED_I</text>
                <text x="180" y="2804">identifies</text>
                <text x="108" y="2820">CRED_I</text>
                <text x="144" y="2820">=</text>
                <text x="200" y="2820">AUTH_CRED_C</text>
                <text x="92" y="2836">by</text>
                <text x="144" y="2836">reference</text>
                <text x="84" y="2884">Access</text>
                <text x="124" y="2884">to</text>
                <text x="176" y="2884">protected</text>
                <text x="252" y="2884">resource</text>
                <text x="300" y="2884">/r</text>
                <text x="128" y="2900">(OSCORE-protected</text>
                <text x="236" y="2900">message)</text>
                <text x="88" y="2916">(access</text>
                <text x="152" y="2916">control</text>
                <text x="196" y="2916">is</text>
                <text x="248" y="2916">enforced)</text>
                <text x="16" y="2932">M16</text>
                <text x="92" y="2980">Response</text>
                <text x="128" y="2996">(OSCORE-protected</text>
                <text x="236" y="2996">message)</text>
                <text x="16" y="3012">M17</text>
                <text x="320" y="3028">|</text>
              </g>
            </svg><a href="#appendix-A.1-2.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-with-optimization">
<section id="appendix-A.2">
        <h3 id="name-workflow-with-optimizations">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-workflow-with-optimizations" class="section-name selfRef">Workflow with Optimizations</a>
        </h3>
<p id="appendix-A.2-1">The example below builds on the example in <a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a>, while additionally using the EDHOC + OSCORE request defined in <span>[<a href="#RFC9668" class="cite xref">RFC9668</a>]</span> when running EDHOC both with AS and with RS.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">This interaction between C and RS consists of only two roundtrips to upload the access token, run EDHOC, and access the protected resource at RS.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<div id="appendix-A.2-3">
          <div class="alignLeft art-svg artwork" id="appendix-A.2-3.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1568" width="576" viewBox="0 0 576 1568" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 40,48 L 40,816" fill="none" stroke="black"></path>
              <path d="M 40,912 L 40,976" fill="none" stroke="black"></path>
              <path d="M 40,1072 L 40,1376" fill="none" stroke="black"></path>
              <path d="M 40,1472 L 40,1552" fill="none" stroke="black"></path>
              <path d="M 336,48 L 336,816" fill="none" stroke="black"></path>
              <path d="M 336,912 L 336,952" fill="none" stroke="black"></path>
              <path d="M 336,1072 L 336,1112" fill="none" stroke="black"></path>
              <path d="M 336,1128 L 336,1224" fill="none" stroke="black"></path>
              <path d="M 336,1240 L 336,1376" fill="none" stroke="black"></path>
              <path d="M 336,1472 L 336,1528" fill="none" stroke="black"></path>
              <path d="M 568,48 L 568,816" fill="none" stroke="black"></path>
              <path d="M 568,912 L 568,976" fill="none" stroke="black"></path>
              <path d="M 568,1072 L 568,1376" fill="none" stroke="black"></path>
              <path d="M 568,1472 L 568,1552" fill="none" stroke="black"></path>
              <path d="M 40,80 L 328,80" fill="none" stroke="black"></path>
              <path d="M 48,144 L 336,144" fill="none" stroke="black"></path>
              <path d="M 40,256 L 328,256" fill="none" stroke="black"></path>
              <path d="M 64,336 L 80,336" fill="none" stroke="black"></path>
              <path d="M 96,336 L 112,336" fill="none" stroke="black"></path>
              <path d="M 128,336 L 144,336" fill="none" stroke="black"></path>
              <path d="M 48,480 L 336,480" fill="none" stroke="black"></path>
              <path d="M 40,960 L 560,960" fill="none" stroke="black"></path>
              <path d="M 48,1120 L 568,1120" fill="none" stroke="black"></path>
              <path d="M 40,1232 L 560,1232" fill="none" stroke="black"></path>
              <path d="M 64,1328 L 80,1328" fill="none" stroke="black"></path>
              <path d="M 96,1328 L 112,1328" fill="none" stroke="black"></path>
              <path d="M 128,1328 L 144,1328" fill="none" stroke="black"></path>
              <path d="M 48,1536 L 568,1536" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="568,1232 556,1226.4 556,1237.6" fill="black" transform="rotate(0,560,1232)"></polygon>
              <polygon class="arrowhead" points="568,960 556,954.4 556,965.6" fill="black" transform="rotate(0,560,960)"></polygon>
              <polygon class="arrowhead" points="336,256 324,250.4 324,261.6" fill="black" transform="rotate(0,328,256)"></polygon>
              <polygon class="arrowhead" points="336,80 324,74.4 324,85.6" fill="black" transform="rotate(0,328,80)"></polygon>
              <polygon class="arrowhead" points="56,1536 44,1530.4 44,1541.6" fill="black" transform="rotate(180,48,1536)"></polygon>
              <polygon class="arrowhead" points="56,1120 44,1114.4 44,1125.6" fill="black" transform="rotate(180,48,1120)"></polygon>
              <polygon class="arrowhead" points="56,480 44,474.4 44,485.6" fill="black" transform="rotate(180,48,480)"></polygon>
              <polygon class="arrowhead" points="56,144 44,138.4 44,149.6" fill="black" transform="rotate(180,48,144)"></polygon>
              <g class="text">
                <text x="40" y="36">C</text>
                <text x="332" y="36">AS</text>
                <text x="564" y="36">RS</text>
                <text x="80" y="68">EDHOC</text>
                <text x="144" y="68">message_1</text>
                <text x="196" y="68">to</text>
                <text x="236" y="68">/edhoc</text>
                <text x="16" y="84">M01</text>
                <text x="80" y="132">EDHOC</text>
                <text x="144" y="132">message_2</text>
                <text x="16" y="148">M02</text>
                <text x="96" y="164">ID_CRED_R</text>
                <text x="180" y="164">identifies</text>
                <text x="108" y="180">CRED_R</text>
                <text x="144" y="180">=</text>
                <text x="204" y="180">AUTH_CRED_AS</text>
                <text x="92" y="196">by</text>
                <text x="144" y="196">reference</text>
                <text x="80" y="244">EDHOC</text>
                <text x="112" y="244">+</text>
                <text x="148" y="244">OSCORE</text>
                <text x="208" y="244">request</text>
                <text x="252" y="244">to</text>
                <text x="292" y="244">/token</text>
                <text x="16" y="260">M03</text>
                <text x="64" y="276">-</text>
                <text x="96" y="276">EDHOC</text>
                <text x="160" y="276">message_3</text>
                <text x="128" y="292">ID_CRED_I</text>
                <text x="212" y="292">identifies</text>
                <text x="140" y="308">CRED_I</text>
                <text x="176" y="308">=</text>
                <text x="232" y="308">AUTH_CRED_C</text>
                <text x="124" y="324">by</text>
                <text x="176" y="324">reference</text>
                <text x="64" y="356">-</text>
                <text x="140" y="356">OSCORE-protected</text>
                <text x="228" y="356">part</text>
                <text x="112" y="372">Token</text>
                <text x="168" y="372">request</text>
                <text x="152" y="388">"req_cnf"</text>
                <text x="236" y="388">identifies</text>
                <text x="160" y="404">AUTH_CRED_C</text>
                <text x="220" y="404">by</text>
                <text x="272" y="404">reference</text>
                <text x="80" y="452">Token</text>
                <text x="140" y="452">response</text>
                <text x="128" y="468">(OSCORE-protected</text>
                <text x="236" y="468">message)</text>
                <text x="16" y="484">M04</text>
                <text x="92" y="500">"rs_cnf"</text>
                <text x="168" y="500">specifies</text>
                <text x="132" y="516">AUTH_CRED_RS</text>
                <text x="196" y="516">by</text>
                <text x="232" y="516">value</text>
                <text x="112" y="548">"ace_profile"</text>
                <text x="208" y="548">specifies</text>
                <text x="264" y="548">the</text>
                <text x="72" y="564">ACE</text>
                <text x="120" y="564">profile</text>
                <text x="232" y="564">"coap_edhoc_oscore"</text>
                <text x="108" y="596">"edhoc_info"</text>
                <text x="204" y="596">specifies:</text>
                <text x="88" y="612">{</text>
                <text x="152" y="628">e'session_id'</text>
                <text x="216" y="628">:</text>
                <text x="252" y="628">h'01',</text>
                <text x="164" y="644">e'cipher_suites'</text>
                <text x="240" y="644">:</text>
                <text x="260" y="644">2,</text>
                <text x="140" y="660">e'methods'</text>
                <text x="192" y="660">:</text>
                <text x="212" y="660">3,</text>
                <text x="144" y="676">e'uri_path'</text>
                <text x="200" y="676">:</text>
                <text x="244" y="676">"/edhoc"</text>
                <text x="88" y="692">}</text>
                <text x="68" y="724">In</text>
                <text x="96" y="724">the</text>
                <text x="140" y="724">access</text>
                <text x="196" y="724">token:</text>
                <text x="64" y="740">-</text>
                <text x="88" y="740">the</text>
                <text x="128" y="740">"cnf"</text>
                <text x="176" y="740">claim</text>
                <text x="240" y="740">specifies</text>
                <text x="120" y="756">AUTH_CRED_C</text>
                <text x="180" y="756">by</text>
                <text x="216" y="756">value</text>
                <text x="64" y="772">-</text>
                <text x="88" y="772">the</text>
                <text x="156" y="772">"edhoc_info"</text>
                <text x="232" y="772">claim</text>
                <text x="112" y="788">specifies</text>
                <text x="168" y="788">the</text>
                <text x="204" y="788">same</text>
                <text x="236" y="788">as</text>
                <text x="124" y="804">"edhoc_info"</text>
                <text x="200" y="804">above</text>
                <text x="76" y="852">Possibly</text>
                <text x="136" y="852">after</text>
                <text x="184" y="852">chain</text>
                <text x="264" y="852">verification,</text>
                <text x="328" y="852">C</text>
                <text x="356" y="852">adds</text>
                <text x="428" y="852">AUTH_CRED_RS</text>
                <text x="52" y="868">to</text>
                <text x="80" y="868">the</text>
                <text x="112" y="868">set</text>
                <text x="140" y="868">of</text>
                <text x="168" y="868">its</text>
                <text x="216" y="868">trusted</text>
                <text x="268" y="868">peer</text>
                <text x="348" y="868">authentication</text>
                <text x="460" y="868">credentials,</text>
                <text x="72" y="884">relying</text>
                <text x="116" y="884">on</text>
                <text x="140" y="884">AS</text>
                <text x="164" y="884">as</text>
                <text x="208" y="884">trusted</text>
                <text x="276" y="884">provider</text>
                <text x="80" y="932">EDHOC</text>
                <text x="144" y="932">message_1</text>
                <text x="196" y="932">to</text>
                <text x="236" y="932">/edhoc</text>
                <text x="72" y="948">(no</text>
                <text x="116" y="948">access</text>
                <text x="176" y="948">control</text>
                <text x="220" y="948">is</text>
                <text x="272" y="948">enforced)</text>
                <text x="16" y="964">M05</text>
                <text x="336" y="980">|</text>
                <text x="76" y="1012">Possibly</text>
                <text x="136" y="1012">after</text>
                <text x="184" y="1012">chain</text>
                <text x="264" y="1012">verification,</text>
                <text x="332" y="1012">RS</text>
                <text x="364" y="1012">adds</text>
                <text x="432" y="1012">AUTH_CRED_C</text>
                <text x="52" y="1028">to</text>
                <text x="80" y="1028">the</text>
                <text x="112" y="1028">set</text>
                <text x="140" y="1028">of</text>
                <text x="168" y="1028">its</text>
                <text x="216" y="1028">trusted</text>
                <text x="268" y="1028">peer</text>
                <text x="348" y="1028">authentication</text>
                <text x="460" y="1028">credentials,</text>
                <text x="72" y="1044">relying</text>
                <text x="116" y="1044">on</text>
                <text x="140" y="1044">AS</text>
                <text x="164" y="1044">as</text>
                <text x="208" y="1044">trusted</text>
                <text x="276" y="1044">provider</text>
                <text x="80" y="1108">EDHOC</text>
                <text x="144" y="1108">message_2</text>
                <text x="16" y="1124">M06</text>
                <text x="96" y="1140">ID_CRED_R</text>
                <text x="180" y="1140">identifies</text>
                <text x="108" y="1156">CRED_R</text>
                <text x="144" y="1156">=</text>
                <text x="204" y="1156">AUTH_CRED_RS</text>
                <text x="92" y="1172">by</text>
                <text x="144" y="1172">reference</text>
                <text x="80" y="1220">EDHOC</text>
                <text x="112" y="1220">+</text>
                <text x="148" y="1220">OSCORE</text>
                <text x="208" y="1220">request</text>
                <text x="252" y="1220">to</text>
                <text x="276" y="1220">/r</text>
                <text x="16" y="1236">M07</text>
                <text x="64" y="1252">-</text>
                <text x="96" y="1252">EDHOC</text>
                <text x="160" y="1252">message_3</text>
                <text x="112" y="1268">EAD_3</text>
                <text x="172" y="1268">contains</text>
                <text x="236" y="1268">access</text>
                <text x="288" y="1268">token</text>
                <text x="128" y="1284">ID_CRED_I</text>
                <text x="212" y="1284">identifies</text>
                <text x="140" y="1300">CRED_I</text>
                <text x="176" y="1300">=</text>
                <text x="232" y="1300">AUTH_CRED_C</text>
                <text x="124" y="1316">by</text>
                <text x="176" y="1316">reference</text>
                <text x="64" y="1348">-</text>
                <text x="140" y="1348">OSCORE-protected</text>
                <text x="228" y="1348">part</text>
                <text x="136" y="1364">Application</text>
                <text x="216" y="1364">request</text>
                <text x="260" y="1364">to</text>
                <text x="284" y="1364">/r</text>
                <text x="64" y="1412">After</text>
                <text x="104" y="1412">the</text>
                <text x="144" y="1412">EDHOC</text>
                <text x="212" y="1412">processing</text>
                <text x="268" y="1412">is</text>
                <text x="324" y="1412">completed,</text>
                <text x="396" y="1412">access</text>
                <text x="456" y="1412">control</text>
                <text x="52" y="1428">is</text>
                <text x="100" y="1428">enforced</text>
                <text x="148" y="1428">on</text>
                <text x="176" y="1428">the</text>
                <text x="224" y="1428">rebuilt</text>
                <text x="324" y="1428">OSCORE-protected</text>
                <text x="428" y="1428">request,</text>
                <text x="60" y="1444">like</text>
                <text x="92" y="1444">if</text>
                <text x="116" y="1444">it</text>
                <text x="144" y="1444">had</text>
                <text x="180" y="1444">been</text>
                <text x="220" y="1444">sent</text>
                <text x="288" y="1444">stand-alone</text>
                <text x="92" y="1508">Response</text>
                <text x="128" y="1524">(OSCORE-protected</text>
                <text x="236" y="1524">message)</text>
                <text x="16" y="1540">M08</text>
                <text x="336" y="1556">|</text>
              </g>
            </svg><a href="#appendix-A.2-3.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
<div id="sec-profile-requirements">
<section id="appendix-B">
      <h2 id="name-profile-requirements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-profile-requirements" class="section-name selfRef">Profile Requirements</a>
      </h2>
<p id="appendix-B-1">This section lists the specifications of this profile based on the requirements of the framework, as requested in <span><a href="https://rfc-editor.org/rfc/rfc9200#appendix-C" class="relref">Appendix C</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">
          <p id="appendix-B-2.1.1">Optionally, define new methods for the client to discover the necessary permissions and AS for accessing a resource, different from the one proposed in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>: Not specified<a href="#appendix-B-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1">Optionally, specify new grant types: Not specified<a href="#appendix-B-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.3">
          <p id="appendix-B-2.3.1">Optionally, define the use of client certificates as client credential type: C can use authentication credentials of any type admitted by the EDHOC protocol, including public key certificates such as X.509 and C509 certificates.<a href="#appendix-B-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.4">
          <p id="appendix-B-2.4.1">Specify the communication protocol the client and RS must use: CoAP<a href="#appendix-B-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.5">
          <p id="appendix-B-2.5.1">Specify the security protocol the client and RS must use to protect their communication: OSCORE<a href="#appendix-B-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.6">
          <p id="appendix-B-2.6.1">Specify how the client and RS mutually authenticate: Explicitly, by successfully executing the EDHOC protocol, after which a common OSCORE Security Context is exported from the EDHOC session. As per the EDHOC authentication method used during the EDHOC session, authentication is provided by digital signatures, or by Message Authentication Codes (MACs) computed from an ephemeral-static ECDH shared secret.<a href="#appendix-B-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.7">
          <p id="appendix-B-2.7.1">Specify the proof-of-possession protocol(s) and how to select one, if several are available. Also specify which key types (e.g., symmetric/asymmetric) are supported by a specific proof-of-possession protocol: proof-of-possession is first achieved by RS when successfully processing EDHOC message_3 during the EDHOC session with C, through EDHOC algorithms and symmetric EDHOC session keys. Also, proof-of-possession is later achieved by C when receiving from RS: i) the optional EDHOC message_4 during the EDHOC session with RS, through EDHOC algorithms and symmetric EDHOC session keys; or ii) the first response protected with the OSCORE Security Context established after the EDHOC session with RS, through OSCORE algorithms and OSCORE symmetric keys derived from the completed EDHOC session.<a href="#appendix-B-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.8">
          <p id="appendix-B-2.8.1">Specify a unique ace_profile identifier: coap_edhoc_oscore<a href="#appendix-B-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.9">
          <p id="appendix-B-2.9.1">If introspection is supported, specify the communication and security protocol for introspection: HTTP/CoAP (+ TLS/DTLS/OSCORE)<a href="#appendix-B-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.10">
          <p id="appendix-B-2.10.1">Specify the communication and security protocol for interactions between client and AS: HTTP/CoAP (+ TLS/DTLS/OSCORE)<a href="#appendix-B-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.11">
          <p id="appendix-B-2.11.1">Specify if/how the authz-info endpoint is protected, including how error responses are protected: Not protected<a href="#appendix-B-2.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.12">
          <p id="appendix-B-2.12.1">Optionally, define methods of token transport other than the authz-info endpoint: C can upload the access token when executing EDHOC with RS, by including the access token in the EAD_3 field of EDHOC message_3 (see <a href="#edhoc-exec" class="auto internal xref">Section 4.2</a>).<a href="#appendix-B-2.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-cddl-model">
<section id="appendix-C">
      <h2 id="name-cddl-model">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-cddl-model" class="section-name selfRef">CDDL Model</a>
      </h2>
<p id="appendix-C-1">This section is to be removed before publishing as an RFC.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<span id="name-cddl-model-2"></span><div id="fig-cddl-model">
<figure id="figure-11">
        <div class="alignLeft art-CDDL art-text artwork" id="appendix-C-2.1">
<pre>
; ACE Profiles
coap_edhoc_oscore = 4

; OAuth Parameters CBOR Mappings
edhoc_info_param = 47

; CBOR Web Token (CWT) Claims
edhoc_info_claim = 41

; CWT Confirmation Methods
x5t = 6
x5u = 7
c5t = 8
c5u = 9
kcwt = 10
kccs = 11
x5chain = 24
x5bag = 25
c5c = 26
c5b = 27

; EDHOC Information
session_id = 0
methods = 1
cipher_suites = 2
message_4 = 3
comb_req = 4
uri_path = 5
cred_types = 6
id_cred_types = 7
eads = 8
initiator = 9
responder = 10
max_msgsize = 11
coap_ct = 12
ep_id_types = 13
transports = 14
trust_anchors = 15

; EDHOC Trust Anchor Purposes
edhoc_cred = 0

; EDHOC Trust Anchor Types
c5t_ta_type = 22
c5u_ta_type = 23
x5t_ta_type = 34
x5u_ta_type = 35
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-cddl-model-2" class="selfRef">CDDL model</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-D">
      <h2 id="name-document-updates">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-D-1">This section is to be removed before publishing as an RFC.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="sec-07-08">
<section id="appendix-D.1">
        <h3 id="name-version-07-to-08">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-version-07-to-08" class="section-name selfRef">Version -07 to -08</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.1-1.1">
            <p id="appendix-D.1-1.1.1">KUDOS is just an example of protocol to use for optional key update.<a href="#appendix-D.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.2">
            <p id="appendix-D.1-1.2.1">message_4 is mandatory to support for an RS that supports the reverse message flow.<a href="#appendix-D.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.3">
            <p id="appendix-D.1-1.3.1">Method in -workflow-and-params as example for coordinating the exchange of authentication credentials by value or reference.<a href="#appendix-D.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.4">
            <p id="appendix-D.1-1.4.1">Revised initial set of EDHOC_Information parameters.<a href="#appendix-D.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.5">
            <p id="appendix-D.1-1.5.1">Defined categorization of EDHOC_Information parameters.<a href="#appendix-D.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.6">
            <p id="appendix-D.1-1.6.1">New EAD item for C to retrieve Request Creation Hints information from RS.<a href="#appendix-D.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.7">
            <p id="appendix-D.1-1.7.1">New EAD item for requesting authentication credential by value.<a href="#appendix-D.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.8">
            <p id="appendix-D.1-1.8.1">Means for the AS to achive proof-of-possession of C's private key.<a href="#appendix-D.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.9">
            <p id="appendix-D.1-1.9.1">Editorial improvements.<a href="#appendix-D.1-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-06-07">
<section id="appendix-D.2">
        <h3 id="name-version-06-to-07">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-version-06-to-07" class="section-name selfRef">Version -06 to -07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.2-1.1">
            <p id="appendix-D.2-1.1.1">Renamed id_ep_types as ep_id_types.<a href="#appendix-D.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.2">
            <p id="appendix-D.2-1.2.1">Revised rules for the AS to assign session ID values.<a href="#appendix-D.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.3">
            <p id="appendix-D.2-1.3.1">Added explicit validation of AUTH_CRED_C at AS.<a href="#appendix-D.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.4">
            <p id="appendix-D.2-1.4.1">"edhoc_info" only in AS-to-C response for first token in a series.<a href="#appendix-D.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.5">
            <p id="appendix-D.2-1.5.1">With a group-audience, "edhoc_info" refers to the whole audience.<a href="#appendix-D.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.6">
            <p id="appendix-D.2-1.6.1">Defined parameters for the EDHOC_Information object:<a href="#appendix-D.2-1.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.2-1.6.2.1">
                <p id="appendix-D.2-1.6.2.1.1">Parameters moved here from draft-ietf-lake-app-profiles.<a href="#appendix-D.2-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-D.2-1.6.2.2">
                <p id="appendix-D.2-1.6.2.2.1">New parameter "trust_anchors".<a href="#appendix-D.2-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-D.2-1.7">
            <p id="appendix-D.2-1.7.1">Access Token Request/Response messages must be encoded in CBOR.<a href="#appendix-D.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.8">
            <p id="appendix-D.2-1.8.1">Explicit statement on admitted confirmation methods.<a href="#appendix-D.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.9">
            <p id="appendix-D.2-1.9.1">First token in a series: the "cnf" claim uses the same confirmation method of the "req_cnf" request to /token.<a href="#appendix-D.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.10">
            <p id="appendix-D.2-1.10.1">Revised examples in CBOR diagnostic notation.<a href="#appendix-D.2-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.11">
            <p id="appendix-D.2-1.11.1">With a group-audience, the reverse message flow can use a roll call.<a href="#appendix-D.2-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.12">
            <p id="appendix-D.2-1.12.1">Matching authentication credentials from ID_CRED_X and EAD item.<a href="#appendix-D.2-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.13">
            <p id="appendix-D.2-1.13.1">Handling authentication credentials and EDHOC session that become invalid.<a href="#appendix-D.2-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.14">
            <p id="appendix-D.2-1.14.1">Limited use of ACE Request Creation Hints when supporting the EDHOC reverse message flow.<a href="#appendix-D.2-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.15">
            <p id="appendix-D.2-1.15.1">Changed CBOR abbreviations to not collide with existing codepoints.<a href="#appendix-D.2-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.16">
            <p id="appendix-D.2-1.16.1">Updates and fixes in the IANA considerations.<a href="#appendix-D.2-1.16.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.17">
            <p id="appendix-D.2-1.17.1">Updated references.<a href="#appendix-D.2-1.17.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.18">
            <p id="appendix-D.2-1.18.1">Clarifications and editorial improvements.<a href="#appendix-D.2-1.18.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-05-06">
<section id="appendix-D.3">
        <h3 id="name-version-05-to-06">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-version-05-to-06" class="section-name selfRef">Version -05 to -06</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.3-1.1">
            <p id="appendix-D.3-1.1.1">The access token can be uploaded through EDHOC in EAD_3, EAD_2, or EAD_4.<a href="#appendix-D.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.2">
            <p id="appendix-D.3-1.2.1">Ruled out the upload of the access token to the /authz-info endpoint over an unprotected channel.<a href="#appendix-D.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.3">
            <p id="appendix-D.3-1.3.1">Defined an EDHOC EAD item for transporting a Session ID.<a href="#appendix-D.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.4">
            <p id="appendix-D.3-1.4.1">Provided more details and added example of dynamic update of access rights.<a href="#appendix-D.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.5">
            <p id="appendix-D.3-1.5.1">Defined in detail the use of the EDHOC reverse message flow.<a href="#appendix-D.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.6">
            <p id="appendix-D.3-1.6.1">Provided details on access token invalidity.<a href="#appendix-D.3-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.7">
            <p id="appendix-D.3-1.7.1">Revised examples with message exchanges.<a href="#appendix-D.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.8">
            <p id="appendix-D.3-1.8.1">Clarifications and editorial improvements.<a href="#appendix-D.3-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-04-05">
<section id="appendix-D.4">
        <h3 id="name-version-04-to-05">
<a href="#appendix-D.4" class="section-number selfRef">D.4. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.4-1.1">
            <p id="appendix-D.4-1.1.1">CBOR diagnostic notation uses placeholders from a CDDL model.<a href="#appendix-D.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.2">
            <p id="appendix-D.4-1.2.1">Only CWTs are supported as access tokens in this profile.<a href="#appendix-D.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.3">
            <p id="appendix-D.4-1.3.1">The alternative workflow of ACE is only mentioned as an example.<a href="#appendix-D.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.4">
            <p id="appendix-D.4-1.4.1">Clarified that both the EDHOC forward and reverse message flows are possible.<a href="#appendix-D.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.5">
            <p id="appendix-D.4-1.5.1">Consistent with the used EDHOC message flow, the access token can be in the EAD item of any EDHOC message.<a href="#appendix-D.4-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.6">
            <p id="appendix-D.4-1.6.1">Explicit registration policies for the new IANA registry.<a href="#appendix-D.4-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.7">
            <p id="appendix-D.4-1.7.1">Fixes in the IANA considerations.<a href="#appendix-D.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.8">
            <p id="appendix-D.4-1.8.1">Editorial fixes and improvements.<a href="#appendix-D.4-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-D.5">
        <h3 id="name-version-03-to-04">
<a href="#appendix-D.5" class="section-number selfRef">D.5. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.5-1.1">
            <p id="appendix-D.5-1.1.1">Fixed column name and prefilling of the "EDHOC Information" registry.<a href="#appendix-D.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.2">
            <p id="appendix-D.5-1.2.1">Added EDHOC_Information Parameters originally in draft-tiloca-lake-app-profiles-00.<a href="#appendix-D.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.3">
            <p id="appendix-D.5-1.3.1">Removed the case of transporting access token in EAD_1<a href="#appendix-D.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.4">
            <p id="appendix-D.5-1.4.1">Removed redundant normative text<a href="#appendix-D.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.5">
            <p id="appendix-D.5-1.5.1">Clarifications of association between access token, session_id, EDHOC session and OSCORE security context<a href="#appendix-D.5-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.6">
            <p id="appendix-D.5-1.6.1">Updated references.<a href="#appendix-D.5-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.7">
            <p id="appendix-D.5-1.7.1">Editorial fixes and improvements.<a href="#appendix-D.5-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-D.6">
        <h3 id="name-version-02-to-03">
<a href="#appendix-D.6" class="section-number selfRef">D.6. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.6-1.1">
            <p id="appendix-D.6-1.1.1">Restructured presentation of content.<a href="#appendix-D.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.2">
            <p id="appendix-D.6-1.2.1">Simplified description of the use of EDHOC_Information.<a href="#appendix-D.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.3">
            <p id="appendix-D.6-1.3.1">Merged the concepts of EDHOC "session_id" and identifier of token series.<a href="#appendix-D.6-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.4">
            <p id="appendix-D.6-1.4.1">Enabled the transport of the access token also in EDHOC EAD_3.<a href="#appendix-D.6-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.5">
            <p id="appendix-D.6-1.5.1">Defined semantics of the newly defined CWT/JWT Confirmation Methods.<a href="#appendix-D.6-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.6">
            <p id="appendix-D.6-1.6.1">Clarifications and editorial improvements.<a href="#appendix-D.6-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-D.7">
        <h3 id="name-version-01-to-02">
<a href="#appendix-D.7" class="section-number selfRef">D.7. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.7-1.1">
            <p id="appendix-D.7-1.1.1">Removed use of EDHOC_KeyUpdate.<a href="#appendix-D.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.2">
            <p id="appendix-D.7-1.2.1">The Security Context is updated either by KUDOS or a rerun of EDHOC.<a href="#appendix-D.7-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.3">
            <p id="appendix-D.7-1.3.1">The alternative workflow (AS token posting) is specified in separate draft.<a href="#appendix-D.7-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.4">
            <p id="appendix-D.7-1.4.1">Fixed and updated examples.<a href="#appendix-D.7-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.5">
            <p id="appendix-D.7-1.5.1">Editorial improvements.<a href="#appendix-D.7-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-D.8">
        <h3 id="name-version-00-to-01">
<a href="#appendix-D.8" class="section-number selfRef">D.8. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.8-1.1">
            <p id="appendix-D.8-1.1.1">Fixed semantics of the ead_value for transporting an Access Token in the EAD_1 field.<a href="#appendix-D.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.2">
            <p id="appendix-D.8-1.2.1">Error handling aligned with EDHOC.<a href="#appendix-D.8-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.3">
            <p id="appendix-D.8-1.3.1">Precise characterization of the EDHOC execution considered for EDHOC-KeyUpdate.<a href="#appendix-D.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.4">
            <p id="appendix-D.8-1.4.1">Fixed message exchange examples.<a href="#appendix-D.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.5">
            <p id="appendix-D.8-1.5.1">Added appendix with profile requirements.<a href="#appendix-D.8-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.6">
            <p id="appendix-D.8-1.6.1">Updated references.<a href="#appendix-D.8-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.7">
            <p id="appendix-D.8-1.7.1">Clarifications and editorial improvements.<a href="#appendix-D.8-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-E">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-E-1">The authors sincerely thank <span class="contact-name">Christian Amsüss</span> and <span class="contact-name">Carsten Bormann</span> for their comments and feedback.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">The parameter "trust_anchors" for specifying supported trust anchors builds on a proposal originally described in <span>[<a href="#I-D.serafin-lake-ta-hint" class="cite xref">I-D.serafin-lake-ta-hint</a>]</span>.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">This work was supported by the Sweden's Innovation Agency VINNOVA within the EUREKA CELTIC-NEXT project CYPRESS; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-E-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Göran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
