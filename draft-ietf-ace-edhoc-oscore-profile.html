<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)</title>
<meta content="Göran Selander" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Höglund" name="author">
<meta content="
       This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.
It utilizes Ephemeral Diffie-Hellman Over COSE (EDHOC) for achieving mutual authentication between an ACE-OAuth Client and Resource Server, and it binds an authentication credential of the Client to an ACE-OAuth access token.
EDHOC also establishes an Object Security for Constrained RESTful Environments (OSCORE) Security Context, which is used to secure communications when accessing protected resources according to the authorization information indicated in the access token.
This profile can be used to delegate management of authorization information from a resource-constrained server to a trusted host with less severe limitations regarding processing power and memory. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-ace-edhoc-oscore-profile-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-ietf-ace-edhoc-oscore-profile.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EDHOC and OSCORE profile of ACE</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Selander, et al.</td>
<td class="center">Expires 4 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-edhoc-oscore-profile-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-03" class="published">3 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-04">4 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE</div>
</div>
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework.
It utilizes Ephemeral Diffie-Hellman Over COSE (EDHOC) for achieving mutual authentication between an ACE-OAuth Client and Resource Server, and it binds an authentication credential of the Client to an ACE-OAuth access token.
EDHOC also establishes an Object Security for Constrained RESTful Environments (OSCORE) Security Context, which is used to secure communications when accessing protected resources according to the authorization information indicated in the access token.
This profile can be used to delegate management of authorization information from a resource-constrained server to a trusted host with less severe limitations regarding processing power and memory.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-ace-edhoc-oscore-profile/">https://datatracker.ietf.org/doc/draft-ietf-ace-edhoc-oscore-profile/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Authentication and Authorization for Constrained Environments (ace) Working Group mailing list (<span><a href="mailto:ace@ietf.org">mailto:ace@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/ace/">https://mailarchive.ietf.org/arch/browse/ace/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/ace/">https://www.ietf.org/mailman/listinfo/ace/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ace-wg/ace-edhoc-oscore-profile">https://github.com/ace-wg/ace-edhoc-oscore-profile</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-client-as-communication" class="internal xref">Client-AS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-c-to-as-post-to-token-endpo" class="internal xref">C-to-AS: POST to /token endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-token-series" class="internal xref">Token Series</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-as-to-c-response" class="internal xref">AS-to-C: Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-access-token" class="internal xref">Access Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-processing-in-c" class="internal xref">Processing in C</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-update-of-access-rights" class="internal xref">Update of Access Rights</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-edhoc_information" class="internal xref">EDHOC_Information</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-client-rs-communication" class="internal xref">Client-RS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-c-to-rs-post-to-authz-info-" class="internal xref">C-to-RS: POST to /authz-info endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-rs-to-c-201-created" class="internal xref">RS-to-C: 2.01 (Created)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-access-token-in-external-au" class="internal xref">Access Token in External Authorization Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-edhoc-session-and-oscore-se" class="internal xref">EDHOC Session and OSCORE Security Context</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-edhoc-message_1" class="internal xref">EDHOC message_1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-edhoc-message_2" class="internal xref">EDHOC message_2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-edhoc-message_3" class="internal xref">EDHOC message_3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="auto internal xref">4.4.4</a>.  <a href="#name-oscore-security-context" class="internal xref">OSCORE Security Context</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-update-of-access-rights-2" class="internal xref">Update of Access Rights</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-discarding-the-security-con" class="internal xref">Discarding the Security Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-cases-of-establishing-a-new" class="internal xref">Cases of Establishing a New OSCORE Security Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-access-rights-verification" class="internal xref">Access Rights Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-secure-communication-with-a" class="internal xref">Secure Communication with AS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-cwt-confirmation-methods" class="internal xref">CWT Confirmation Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-ordered-chain-of-x509-certi" class="internal xref">Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-unordered-bag-of-x509-certi" class="internal xref">Unordered Bag of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-hash-of-an-x509-certificate" class="internal xref">Hash of an X.509 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-uri-pointing-to-an-ordered-" class="internal xref">URI Pointing to an Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-ordered-chain-of-c509-certi" class="internal xref">Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-unordered-bag-of-c509-certi" class="internal xref">Unordered Bag of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-hash-of-a-c509-certificate" class="internal xref">Hash of a C509 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-uri-pointing-to-an-ordered-c" class="internal xref">URI Pointing to an Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-cwt-containing-a-cose_key" class="internal xref">CWT Containing a COSE_Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-ccs-containing-a-cose_key" class="internal xref">CCS Containing a COSE_Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-jwt-confirmation-methods" class="internal xref">JWT Confirmation Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-ordered-chain-of-x509-certif" class="internal xref">Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-unordered-bag-of-x509-certif" class="internal xref">Unordered Bag of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-hash-of-an-x509-certificate-2" class="internal xref">Hash of an X.509 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-uri-pointing-to-an-ordered-ch" class="internal xref">URI Pointing to an Ordered Chain of X.509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-ordered-chain-of-c509-certif" class="internal xref">Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-unordered-bag-of-c509-certif" class="internal xref">Unordered Bag of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-hash-of-a-c09-certificate" class="internal xref">Hash of a C09 Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-uri-pointing-to-an-ordered-cha" class="internal xref">URI Pointing to an Ordered Chain of C509 Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-cwt-containing-a-cose_key-2" class="internal xref">CWT Containing a COSE_Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="auto internal xref">7.10</a>. <a href="#name-ccs-containing-a-cose_key-2" class="internal xref">CCS Containing a COSE_Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-ace-profiles-registry" class="internal xref">ACE Profiles Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-oauth-parameters-registry" class="internal xref">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="internal xref">OAuth Parameters CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-json-web-token-claims-regis" class="internal xref">JSON Web Token Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-cbor-web-token-cwt-claims-r" class="internal xref">CBOR Web Token (CWT) Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-jwt-confirmation-methods-re" class="internal xref">JWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="auto internal xref">10.7</a>.  <a href="#name-cwt-confirmation-methods-re" class="internal xref">CWT Confirmation Methods Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a href="#section-10.8" class="auto internal xref">10.8</a>.  <a href="#name-edhoc-external-authorizatio" class="internal xref">EDHOC External Authorization Data Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a href="#section-10.9" class="auto internal xref">10.9</a>.  <a href="#name-edhoc-information-registry" class="internal xref">EDHOC Information Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.10">
                <p id="section-toc.1-1.10.2.10.1"><a href="#section-10.10" class="auto internal xref">10.10</a>. <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-workflow-without-optimizati" class="internal xref">Workflow without Optimizations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-workflow-with-optimizations" class="internal xref">Workflow with Optimizations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-profile-requirements" class="internal xref">Profile Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-cddl-model" class="internal xref">CDDL Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-version-04-to-05" class="internal xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-version-03-to-04" class="internal xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-D.3" class="auto internal xref">D.3</a>.  <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-D.4" class="auto internal xref">D.4</a>.  <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#appendix-D.5" class="auto internal xref">D.5</a>.  <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines the "coap_edhoc_oscore" profile of the ACE-OAuth framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. This profile addresses a "zero-touch" constrained setting where authenticated and authorized operations can be performed with low overhead without endpoint specific configurations.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Like in the "coap_oscore" profile <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, also in this profile a client (C) and a resource server (RS) use the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> to communicate, and Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> to protect their communications, but this profile uses the Ephemeral Diffie-Hellman Over COSE (EDHOC) protocol <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> to establish the OSCORE Security Context. The processing of requests for specific protected resources is identical to what is defined in the "coap_oscore" profile.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">When using this profile, C accesses protected resources hosted at RS with the use of an access token issued by a trusted authorization server (AS) and bound to an authentication credential of C. This differs from the "coap_oscore" profile, where the access token is bound to a symmetric key used to derive the OSCORE Security Context. As recommended in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, this document recommends the use of CBOR Web Tokens (CWTs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> as access tokens.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">An authentication credential can be a raw public key, e.g., encoded as a CWT Claims Set (CCS, <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>); or a public key certificate, e.g., encoded as an X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> or as a CBOR encoded X.509 certificate (C509, <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>); or a different type of data structure containing the public key of the peer in question.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The ACE protocol establishes what those authentication credentials are, and may transport the actual authentication credentials by value or uniquely refer to them. If an authentication credential is pre-provisioned or can be obtained over less constrained links, then it suffices that ACE provides a unique reference such as a certificate hash (e.g., by using the COSE header parameter "x5t", see <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>). This is in the same spirit as EDHOC, where the authentication credentials may be transported or referenced in the ID_CRED_x message fields (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3" class="relref">Section 3.5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">In general, AS and RS are likely to have trusted access to each other's authentication credentials, since AS acts on behalf of RS as per the trust model of ACE. Also, AS needs to have some information about C, including the relevant authentication credential, in order to identify C when it requests an access token and to determine what access rights it can be granted. However, the authentication credential of C may potentially be conveyed (or uniquely referred to) within the request for access that C makes to AS.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">The establishment of an association between RS and AS in an ACE ecosystem is out of scope, but one solution is to build on the same primitives as used in this document, i.e., EDHOC for authentication and OSCORE for communication security, using for example <span>[<a href="#I-D.ietf-lake-authz" class="cite xref">I-D.ietf-lake-authz</a>]</span> for onboarding RS with AS, and <span>[<a href="#I-D.ietf-ace-coap-est-oscore" class="cite xref">I-D.ietf-ace-coap-est-oscore</a>]</span> for establishing a trust anchor in RS. A similar procedure can also be applied between C and AS for registering a client and for the establishment of a trust anchor.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Certain security-related terms such as "authentication", "authorization", "confidentiality", "(data) integrity", "Message Authentication Code (MAC)", "Hash-based Message Authentication Code (HMAC)", and "verify" are taken from <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">RESTful terminology follows HTTP <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">Readers are expected to be familiar with the terms and concepts defined in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Readers are also expected to be familiar with the terms and concepts of the ACE framework described in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">Terminology for entities in the architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, such as the client (C), the resource server (RS), and the authorization server (AS).  It is assumed in this document that a given resource on a specific RS is associated with a unique AS.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">Note that the term "endpoint" is used here, as in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, following its OAuth definition, which is to denote resources such as /token and /introspect at AS and /authz-info at RS. The CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> definition, which is "An entity participating in the CoAP protocol" is not used in this document.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8">The authorization information (authz-info) resource refers to the authorization information endpoint as specified in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. The term "claim" is used in this document with the same semantics as in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, i.e., it denotes information carried in the access token or returned from introspection.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9">Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span><span>[<a href="#RFC8742" class="cite xref">RFC8742</a>]</span> and Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> are used in this document. CDDL predefined type names, especially bstr for CBOR byte strings and tstr for CBOR text strings, are used extensively in this document.<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10">Examples throughout this document are expressed in CBOR diagnostic notation as defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. Diagnostic notation comments are often used to provide a textual representation of the numeric parameter names and values.<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<p id="section-1.1-11">In the CBOR diagnostic notation used in this document, constructs of the form e'SOME_NAME' are replaced by the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 7</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix C</a>. For example, {e'session_id' : h'01', e'cipher_suites': 3} stands for {0 : h'01', 2 : 3}.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12">Note to RFC Editor: Please delete the paragraph immediately preceding this note. Also, in the CBOR diagnostic notation used in this document, please replace the constructs of the form e'SOME_NAME' with the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 7</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix C</a>. Finally, please delete this note.<a href="#section-1.1-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">This section gives an overview of how to use the ACE framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> together with the lightweight authenticated key exchange protocol EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. By doing so, the client (C) and the resource server (RS) generate an OSCORE Security Context <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> associated with authorization information, and use that security context to protect their communications. The parameters needed by C to negotiate the use of this profile with the authorization server (AS), as well as the OSCORE setup process, are described in detail in the following sections.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">RS maintains a collection of authentication credentials. These are associated with OSCORE Security Contexts and with authorization information for all clients that RS is communicating with. The authorization information is used to enforce polices for processing requests from those clients.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The ACE framework describes how the authorization information propagates from AS to RS. This profile specifies how C requests an access token, including  authorization information, from AS for the resources it wants to access on RS, by sending an access token request to the /token endpoint, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">Section 5.8</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">If the request is granted then AS may send back an access token in a response to C, or upload the access token directly to RS as described in the alternative workflow defined in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>. The latter is not detailed further here.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">If C has retrieved an access token, there are two options for C to upload it to RS, as further detailed later in the document.<a href="#section-2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-6">
<li id="section-2-6.1">
          <p id="section-2-6.1.1">C posts the access token to the /authz-info endpoint by using the mechanisms specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10" class="relref">Section 5.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. If the access token is valid, RS replies to the request with a 2.01 (Created) response, after which C initiates the EDHOC protocol with RS. The communication with the /authz-info endpoint may not be protected unless there is previously established security context, for example in the case of update of access rights, see <a href="#update-access-rights-c-rs" class="auto internal xref">Section 4.5</a>.<a href="#section-2-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-6.2">
          <p id="section-2-6.2.1">C initiates the EDHOC protocol and includes the access token as External Authorization Data (EAD), see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. In this case, the access token is validated in parallel with the EDHOC session. The EAD item containing the access token is protected in different ways depending on which EDHOC message it is carried in, see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-2-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-2-7">When running the EDHOC protocol, C uses the authentication credential of RS specified by AS together with the access token, while RS uses the authentication credential of C bound to and specified within the access token. If C and RS complete the EDHOC session successfully, they are mutually authenticated and they derive an OSCORE Security Context as per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">From then on, C effectively gains authorized and secure access to protected resources on RS with the established OSCORE Security Context, for as long as there is a valid access token. The OSCORE Security Context is discarded when an access token (whether the same or a different one) is used to successfully derive a new OSCORE Security Context for C.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">While the OSCORE Security Context and access token are valid, C can contact AS to request an update of its access rights, by sending a similar request to the /token endpoint. This request also includes a "session identifier" (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>) provided by AS in the initial request, which allows AS to find the data it has previously shared with C. The session identifier is assigned by AS and used to identify a series of access tokens, called a "token series" (see <a href="#token-series" class="auto internal xref">Section 3.2</a>). Upon successful update of access rights (see <a href="#update-access-rights-c-rs" class="auto internal xref">Section 4.5</a>), the new issued access token becomes the latest in its token series, but the session identifier remains the same. When the latest access token of a token series becomes invalid (e.g., when it expires or gets revoked), that token series ends.<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">When RS receives a request from C protected with an OSCORE Security Context derived from an EDHOC session implementing this profile, then the associated session identifier, together with the authentication credential of C used in the EDHOC session, enables the RS to look up the unique access token determining the access rights of C.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">Comparing the options above: In option 1 the token upload and the EDHOC protocol is performed in series, which requires more messages exchanged than option 2. An overview of the message flow for the "coap_edhoc_oscore" profile in case of option 1 above is given in <a href="#protocol-overview" class="auto internal xref">Figure 1</a>, and a more detailed protocol is provided in <a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a>. For option 2, the EDHOC protocol, access token upload, and access request &amp; response can be completed in two round trips, see <a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a>.<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">Option 1 supports update of access rights protected with the existing OSCORE Security Context, see <a href="#update-access-rights-c-rs" class="auto internal xref">Section 4.5</a>, whereas option 2 always generates a new OSCORE Security Context. In case of option 2, in order to support update of access rights without changing OSCORE Security Context, C need to also implement option 1 or rely on some other method, such as the alternative workflow, see <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-2-12" class="pilcrow">¶</a></p>
<span id="name-protocol-overview-example-n"></span><div id="protocol-overview">
<figure id="figure-1">
        <div id="section-2-13.1">
          <div class="alignLeft art-svg artwork" id="section-2-13.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="608" width="480" viewBox="0 0 480 608" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 32,48 L 32,432" fill="none" stroke="black"></path>
              <path d="M 32,496 L 32,576" fill="none" stroke="black"></path>
              <path d="M 264,160 L 264,320" fill="none" stroke="black"></path>
              <path d="M 264,368 L 264,576" fill="none" stroke="black"></path>
              <path d="M 472,48 L 472,576" fill="none" stroke="black"></path>
              <path d="M 48,62 L 80,62" fill="none" stroke="black"></path>
              <path d="M 48,66 L 80,66" fill="none" stroke="black"></path>
              <path d="M 424,62 L 456,62" fill="none" stroke="black"></path>
              <path d="M 424,66 L 456,66" fill="none" stroke="black"></path>
              <path d="M 48,96 L 96,96" fill="none" stroke="black"></path>
              <path d="M 216,96 L 456,96" fill="none" stroke="black"></path>
              <path d="M 48,128 L 304,128" fill="none" stroke="black"></path>
              <path d="M 424,128 L 456,128" fill="none" stroke="black"></path>
              <path d="M 48,176 L 72,176" fill="none" stroke="black"></path>
              <path d="M 224,176 L 248,176" fill="none" stroke="black"></path>
              <path d="M 48,224 L 88,224" fill="none" stroke="black"></path>
              <path d="M 208,224 L 248,224" fill="none" stroke="black"></path>
              <path d="M 48,254 L 120,254" fill="none" stroke="black"></path>
              <path d="M 48,258 L 120,258" fill="none" stroke="black"></path>
              <path d="M 184,254 L 248,254" fill="none" stroke="black"></path>
              <path d="M 184,258 L 248,258" fill="none" stroke="black"></path>
              <path d="M 48,384 L 72,384" fill="none" stroke="black"></path>
              <path d="M 208,384 L 248,384" fill="none" stroke="black"></path>
              <path d="M 48,416 L 72,416" fill="none" stroke="black"></path>
              <path d="M 216,416 L 248,416" fill="none" stroke="black"></path>
              <path d="M 48,512 L 72,512" fill="none" stroke="black"></path>
              <path d="M 208,512 L 248,512" fill="none" stroke="black"></path>
              <path d="M 48,544 L 72,544" fill="none" stroke="black"></path>
              <path d="M 216,544 L 248,544" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="464,96 452,90.4 452,101.6" fill="black" transform="rotate(0,456,96)"></polygon>
              <polygon class="arrowhead" points="464,64 452,58.4 452,69.6" fill="black" transform="rotate(0,456,64)"></polygon>
              <polygon class="arrowhead" points="256,512 244,506.4 244,517.6" fill="black" transform="rotate(0,248,512)"></polygon>
              <polygon class="arrowhead" points="256,384 244,378.4 244,389.6" fill="black" transform="rotate(0,248,384)"></polygon>
              <polygon class="arrowhead" points="256,256 244,250.4 244,261.6" fill="black" transform="rotate(0,248,256)"></polygon>
              <polygon class="arrowhead" points="256,176 244,170.4 244,181.6" fill="black" transform="rotate(0,248,176)"></polygon>
              <polygon class="arrowhead" points="56,544 44,538.4 44,549.6" fill="black" transform="rotate(180,48,544)"></polygon>
              <polygon class="arrowhead" points="56,416 44,410.4 44,421.6" fill="black" transform="rotate(180,48,416)"></polygon>
              <polygon class="arrowhead" points="56,256 44,250.4 44,261.6" fill="black" transform="rotate(180,48,256)"></polygon>
              <polygon class="arrowhead" points="56,224 44,218.4 44,229.6" fill="black" transform="rotate(180,48,224)"></polygon>
              <polygon class="arrowhead" points="56,128 44,122.4 44,133.6" fill="black" transform="rotate(180,48,128)"></polygon>
              <polygon class="arrowhead" points="56,64 44,58.4 44,69.6" fill="black" transform="rotate(180,48,64)"></polygon>
              <g class="text">
                <text x="32" y="36">C</text>
                <text x="268" y="36">RS</text>
                <text x="468" y="36">AS</text>
                <text x="264" y="52">|</text>
                <text x="116" y="68">Mutual</text>
                <text x="204" y="68">authentication</text>
                <text x="280" y="68">and</text>
                <text x="324" y="68">secure</text>
                <text x="384" y="68">channel</text>
                <text x="264" y="84">|</text>
                <text x="124" y="100">POST</text>
                <text x="172" y="100">/token</text>
                <text x="264" y="116">|</text>
                <text x="340" y="132">Access</text>
                <text x="392" y="132">Token</text>
                <text x="288" y="148">+</text>
                <text x="324" y="148">Access</text>
                <text x="400" y="148">Information</text>
                <text x="100" y="180">POST</text>
                <text x="168" y="180">/authz-info</text>
                <text x="148" y="196">(access_token)</text>
                <text x="116" y="228">2.01</text>
                <text x="168" y="228">Created</text>
                <text x="152" y="260">EDHOC</text>
                <text x="76" y="276">Mutual</text>
                <text x="164" y="276">authentication</text>
                <text x="64" y="292">and</text>
                <text x="124" y="292">derivation</text>
                <text x="180" y="292">of</text>
                <text x="204" y="292">an</text>
                <text x="76" y="308">OSCORE</text>
                <text x="140" y="308">Security</text>
                <text x="208" y="308">Context</text>
                <text x="244" y="340">/Proof-of-possession</text>
                <text x="344" y="340">and</text>
                <text x="196" y="356">Security</text>
                <text x="264" y="356">Context</text>
                <text x="332" y="356">storage/</text>
                <text x="108" y="388">OSCORE</text>
                <text x="168" y="388">Request</text>
                <text x="108" y="420">OSCORE</text>
                <text x="172" y="420">Response</text>
                <text x="84" y="452">/Proof-of-possession</text>
                <text x="16" y="468">and</text>
                <text x="68" y="468">Security</text>
                <text x="136" y="468">Context</text>
                <text x="32" y="484">storage</text>
                <text x="104" y="484">(latest)/</text>
                <text x="108" y="516">OSCORE</text>
                <text x="168" y="516">Request</text>
                <text x="108" y="548">OSCORE</text>
                <text x="172" y="548">Response</text>
                <text x="136" y="580">...</text>
              </g>
            </svg><a href="#section-2-13.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-overview-example-n" class="selfRef">Protocol Overview Example. Names of messages coincide with those of RFC 9200 when applicable.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="c-as-comm">
<section id="section-3">
      <h2 id="name-client-as-communication">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-client-as-communication" class="section-name selfRef">Client-AS Communication</a>
      </h2>
<p id="section-3-1">The following subsections describe the details of the POST request and response to the /token endpoint between C and AS.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">In this exchange, AS provides C with the access token, together with a set of parameters that enable C to run EDHOC with RS. In particular, these include information about the authorization credential of RS, AUTH_CRED_RS, transported by value or uniquely referred to.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The access token is securely associated with the authentication credential of C, AUTH_CRED_C, by including it or uniquely referring to it in the access token.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">AUTH_CRED_C is specified in the "req_cnf" parameter defined in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span> of the POST request to the /token endpoint from C to AS, either transported by value or uniquely referred to.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The request to the /token endpoint and the corresponding response can include EDHOC_Information, which is a CBOR map object containing information related to an EDHOC session, in particular the identifier "session_id", see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>. This object is transported in the "edhoc_info" parameter registered in <a href="#iana-oauth-params" class="auto internal xref">Section 10.2</a> and <a href="#iana-oauth-cbor-mappings" class="auto internal xref">Section 10.3</a>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="c-as">
<section id="section-3.1">
        <h3 id="name-c-to-as-post-to-token-endpo">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-c-to-as-post-to-token-endpo" class="section-name selfRef">C-to-AS: POST to /token endpoint</a>
        </h3>
<p id="section-3.1-1">The client-to-AS request is specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The client <span class="bcp14">MUST</span> send this POST request to the /token endpoint over a secure channel that guarantees authentication, message integrity, and confidentiality (see <a href="#secure-comm-as" class="auto internal xref">Section 5</a>). This document describes the use of CoAP, EDHOC and OSCORE to reduce the number of libraries that C has to support.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">An example of such a request is shown in <a href="#token-request" class="auto internal xref">Figure 2</a>. In this example, C specifies its own authentication credential by reference, as the hash of an X.509 certificate carried in the "x5t" field of the "req_cnf" parameter. In fact, it is expected that C can typically specify its own authentication credential by reference, since AS is expected to obtain the actual authentication credential during a previous client registration process or secure association establishment with C.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-example-of-c-to-as-post-tok"></span><div id="token-request">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.1-4.1">
<pre>
   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: application/ace+cbor
   Payload:
   {
     / audience / 5 : "tempSensor4711",
     / scope /    9 : "read",
     / req_cnf /  4 : {
       e'x5t' : h'822E4879F2A41B510C1F9B'
     }
   }
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-of-c-to-as-post-tok" class="selfRef">Example of C-to-AS POST /token request for an access token.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-5">If C wants to update its access rights without changing an existing OSCORE Security Context, it <span class="bcp14">MUST</span> include EDHOC_Information in its POST request to the /token endpoint. The EDHOC_Information <span class="bcp14">MUST</span> include the "session_id" field. This POST request <span class="bcp14">MUST</span> omit the "req_cnf" parameter. An example of such a request is shown in <a href="#token-request-update" class="auto internal xref">Figure 3</a>.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The identifier "session_id" is assigned by AS as discussed in <a href="#token-series" class="auto internal xref">Section 3.2</a>, and, together with other information such as audience (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), can be used by AS to determine the token series to which the new requested access token has to be added. Therefore, the session_id <span class="bcp14">MUST</span> identify the pair (AUTH_CRED_C, AUTH_CRED_RS) associated with a still valid access token previously issued for C and RS by AS.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">AS <span class="bcp14">MUST</span> verify that the received "session_id" identifies a token series to which a still valid access token issued for C and RS belongs. If that is not the case, the Client-to-AS request <span class="bcp14">MUST</span> be declined with the error code "invalid_request" as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<span id="name-example-of-c-to-as-post-toke"></span><div id="token-request-update">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.1-8.1">
<pre>
   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: application/ace+cbor
   Payload:
   {
     / audience /      5 : "tempSensor4711",
     / scope /         9 : "write",
     e'edhoc_info_param' : {
        e'session_id' : h'01'
     }
   }
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-c-to-as-post-toke" class="selfRef">Example of C-to-AS POST /token request for updating access rights to an access token.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="token-series">
<section id="section-3.2">
        <h3 id="name-token-series">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-token-series" class="section-name selfRef">Token Series</a>
        </h3>
<p id="section-3.2-1">This document refers to "token series" as a series of access tokens sorted in chronological order as they are released, characterized by the following properties:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">issued by the same AS<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">issued to the same C, and associated with the same authentication credential of C<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">issued for the same RS, identified by the same authentication credential<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">Upon a successful update of access rights, the new issued access token becomes the latest in its token series. When the latest access token of a token series becomes invalid (e.g., due to its expiration or revocation), the token series it belongs to ends.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">The general token series concept is defined in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>. In this profile, a token series is characterized by access tokens used between a given pair (C, RS) having the same "session_id" in the EDHOC_Information, see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">AS assigns the "session_id" to the EDHOC_Information when issuing the first access token of a new series and that "session_id" remains fixed throughout the series lifetime. When assigning the identifier, AS <span class="bcp14">MUST</span> ensure that it was not used in a previous series whose access tokens share the following properties with the access tokens of the new series:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <p id="section-3.2-6.1.1">i) issued for the same RS; and<a href="#section-3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.2">
            <p id="section-3.2-6.2.1">ii) bound to the same authentication credential AUTH_CRED_C of the requesting client (irrespectively of how the AUTH_CRED_C is identified in the access tokens).<a href="#section-3.2-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">In case the access token is issued for a group-audience (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), what is defined above applies, with the difference that the token series is associated with all the RSs in the group-audience, as indicated by their respective AUTH_CRED_RS.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-c">
<section id="section-3.3">
        <h3 id="name-as-to-c-response">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-as-to-c-response" class="section-name selfRef">AS-to-C: Response</a>
        </h3>
<p id="section-3.3-1">After verifying the POST request to the /token endpoint and that C is authorized to access, AS responds as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, with potential modifications as detailed below. If the request from C was invalid, or not authorized, AS returns an error response as described in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">AS can signal that the use of EDHOC and OSCORE as per this profile is <span class="bcp14">REQUIRED</span> for a specific access token, by including the "ace_profile" parameter with the value "coap_edhoc_oscore" in the access token response. This means that C <span class="bcp14">MUST</span> use EDHOC with RS and derive an OSCORE Security Context, as specified in <a href="#edhoc-exec" class="auto internal xref">Section 4.4</a>. After that, C <span class="bcp14">MUST</span> use the established OSCORE Security Context to protect communications with RS, when accessing protected resources at RS according to the authorization information indicated in the access token. Usually, it is assumed that constrained devices will be pre-configured with the necessary profile, so that this kind of profile signaling can be omitted.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">According to this document, the AS provides the access token to C, by specifying it in the "access_token" parameter of the access token response. An alternative workflow where the access token is uploaded by AS directly to RS is described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">When issuing any access token, AS <span class="bcp14">MUST</span> send the following data in the response to C.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-5.1">
            <p id="section-3.3-5.1.1">The "session_id" field of EDHOC_Information, which is the identifier of the token series which the issued access token belongs to.<a href="#section-3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-6">When issuing the first access token of a token series, AS <span class="bcp14">MUST</span> send the following data in the response to C.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-7.1">
            <p id="section-3.3-7.1.1">A unique identification of the authentication credential of RS, AUTH_CRED_RS. This is specified in the "rs_cnf" parameter defined in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>. AUTH_CRED_RS can be transported by value or referred to by means of an appropriate identifier.<a href="#section-3.3-7.1.1" class="pilcrow">¶</a></p>
<p id="section-3.3-7.1.2">
When issuing the first access token ever to a pair (C, RS) using a pair of corresponding authentication credentials (AUTH_CRED_C, AUTH_CRED_RS), it is typically expected that the response to C may include AUTH_CRED_RS by value.<a href="#section-3.3-7.1.2" class="pilcrow">¶</a></p>
<p id="section-3.3-7.1.3">
When later issuing further access tokens to the same pair (C, RS) using the same AUTH_CRED_RS, it is expected that the response to C includes AUTH_CRED_RS by reference.<a href="#section-3.3-7.1.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-8">When issuing the first access token of a token series, AS <span class="bcp14">MAY</span> send EDHOC_Information related to RS, see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>, in corresponding fields of the response to C. This information is based on knowledge that AS have about RS, e.g., from a previous onboarding process, with particular reference to what RS supports as EDHOC peer.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9"><a href="#fig-token-response" class="auto internal xref">Figure 4</a> shows an example of an AS response. The "rs_cnf" parameter specifies the authentication credential of RS, as an X.509 certificate transported by value in the "x5chain" field. The access token and the authentication credential of RS have been truncated for readability.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<span id="name-example-of-as-to-c-access-t"></span><div id="fig-token-response">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.3-10.1">
<pre>
   Header: Created (Code=2.01)
      Content-Format: application/ace+cbor
      Payload:
      {
        / access_token / 1 : h'8343a1010aa2044c53/...
          (remainder of access token (CWT) omitted for brevity)/',
        / ace_profile / 38 : e'coap_edhoc_oscore',
        / expires_in /   2 : 3600,
        / rs_cnf /      41 : {
          e'x5chain' : h'3081ee3081a1a00302/...'
            (remainder of the credential omitted for brevity)/'
        }
        e'edhoc_info_param' : {
          e'session_id'    : h'01',
          e'methods'       : [0, 1, 2, 3],
          e'cipher_suites' : 0
        }
      }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-as-to-c-access-t" class="selfRef">Example of AS-to-C Access Token response with EDHOC and OSCORE profile.</a>
          </figcaption></figure>
</div>
<div id="access-token">
<section id="section-3.3.1">
          <h4 id="name-access-token">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-access-token" class="section-name selfRef">Access Token</a>
          </h4>
<p id="section-3.3.1-1">When issuing any access token of a token series, AS <span class="bcp14">MUST</span> specify the following data in the claims associated with the access token.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-2.1">
              <p id="section-3.3.1-2.1.1">The "session_id" field of EDHOC_Information, with the same value specified in the response to C from the /token endpoint.<a href="#section-3.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.1-2.2">
              <p id="section-3.3.1-2.2.1">The authentication credential that C specified in its POST request to the /token endpoint (see <a href="#c-as" class="auto internal xref">Section 3.1</a>), AUTH_CRED_C. If the access token is a CWT, this information <span class="bcp14">MUST</span> be specified in the "cnf" claim.<a href="#section-3.3.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.2.2">
In the access token, AUTH_CRED_C can be transported by value or uniquely referred to by means of an appropriate identifier, regardless of how C specified it in the request to the /token endpoint. Thus, the specific field carried in the access token claim and specifying AUTH_CRED_C depends on the specific way used by AS.<a href="#section-3.3.1-2.2.2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.2.3">
When issuing the first access token ever to a pair (C, RS) using a pair of corresponding authentication credentials (AUTH_CRED_C, AUTH_CRED_RS), it is typically expected that AUTH_CRED_C is included by value.<a href="#section-3.3.1-2.2.3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.2.4">
When later issuing further access tokens to the same pair (C, RS) using the same AUTH_CRED_C, it is expected that AUTH_CRED_C is identified by reference.<a href="#section-3.3.1-2.2.4" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.1-3">When issuing the first access token of a token series, AS <span class="bcp14">MAY</span> specify the following EDHOC_Information (see <a href="#edhoc-parameters-object" class="auto internal xref">Section 3.4</a>) in the claims associated with the access token. If these data are specified in the response to C from the /token endpoint, they <span class="bcp14">MUST</span> be included with the same values in the access token.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-4.1">
              <p id="section-3.3.1-4.1.1">osc_ms_len: The size of the OSCORE Master Secret. If it is not included, the default value from <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> is assumed.<a href="#section-3.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.1-4.2">
              <p id="section-3.3.1-4.2.1">osc_salt_len: The size of the OSCORE Master Salt. If it is not included, the default value from <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> is assumed.<a href="#section-3.3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.1-4.3">
              <p id="section-3.3.1-4.3.1">osc_version: The OSCORE version. If it is not included, the default value of 1 (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>) is assumed.<a href="#section-3.3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.1-5">To avoid the complexity of different encodings, an access token of this profile <span class="bcp14">SHALL</span> be a CBOR Web Token (CWT), see <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>. EDHOC_Information <span class="bcp14">MUST</span> be transported in the "edhoc_info" claim, defined in <a href="#iana-token-cwt-claims" class="auto internal xref">Section 10.5</a>.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.3.1-6">The access token needs to be protected for various reasons. To prevent manipulation of the content, it needs to be integrity protected. RS needs to be able to verify that the access token is issued by a trusted AS (source authentication). Depending on use case and deployment, the access token may need to be confidentiality protected, for example, for privacy reasons.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.3.1-7">AS can protect the access token by different means as discussed in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. It is <span class="bcp14">RECOMMENDED</span> that a COSE method is used as specified in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>. Depending on audience there may be different ways to most appropriately confidentiality protected the access token. For a single RS, the CWT may be wrapped in COSE_Encrypt / COSE_Encrypt0, but if it needs to be read by multiple RSs then confidentiality protection may be better applied during transport, e.g., using EDHOC EAD_3 from C to RS.<a href="#section-3.3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.3.1-8"><a href="#fig-token" class="auto internal xref">Figure 5</a> shows an example CWT Claims Set, including the relevant EDHOC parameters in the "edhoc_info" claim. The "cnf" claim specifies the authentication credential of C, as an X.509 certificate transported by value in the "x5chain" field. The authentication credential of C has been truncated for readability.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
<span id="name-example-of-cwt-claims-set-w"></span><div id="fig-token">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-3.3.1-9.1">
<pre>
   {
    / aud /   3 : "tempSensorInLivingRoom",
    / iat /   6 : 1563451500,
    / exp /   4 : 1563453000,
    / scope / 9 :  "temperature_g firmware_p",
    / cnf /   8 : {
      e'x5chain' : h'3081ee3081a1a00302/...
        (remainder of the credential omitted for brevity)/'
    }
    e'edhoc_info_claim' : {
      e'session_id'    : h'01',
      e'methods'       : [0, 1, 2, 3],
      e'cipher_suites' : 0
    }
  }
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-cwt-claims-set-w" class="selfRef">Example of CWT Claims Set with EDHOC parameters.</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="processing-in-c">
<section id="section-3.3.2">
          <h4 id="name-processing-in-c">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-processing-in-c" class="section-name selfRef">Processing in C</a>
          </h4>
<p id="section-3.3.2-1">When receiving an Access Token response including the "rs_cnf" parameter, C checks whether it is already storing the authentication credential of RS, namely AUTH_CRED_RS, specified in "rs_cnf" by value or reference.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">If this is not the case, C retrieves AUTH_CRED_RS, either using the "rs_cnf" parameter or some other trusted source. After that, C validates the actual AUTH_CRED_RS. In case of successful validation, C stores AUTH_CRED_RS as a valid authentication credential. Otherwise, C <span class="bcp14">MUST</span> delete the access token.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-of-access-rights">
<section id="section-3.3.3">
          <h4 id="name-update-of-access-rights">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-update-of-access-rights" class="section-name selfRef">Update of Access Rights</a>
          </h4>
<p id="section-3.3.3-1">If C has a valid OSCORE Security Context associated to a valid access token, then C can send a request to AS for updating of its access rights.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">If the request is granted then AS generates a new access token, where the "edhoc_info" claim <span class="bcp14">MUST</span> include only the "session_id" field. The access token is provisioned to RS either via C as specified in this document, or directly as described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>. In either case, AS responds to C such that:<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-3.1">
              <p id="section-3.3.3-3.1.1">The response <span class="bcp14">MUST NOT</span> include the "rs_cnf" parameter.<a href="#section-3.3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-3.2">
              <p id="section-3.3.3-3.2.1">The EDHOC_Information in the response <span class="bcp14">MUST</span> include only the "session_id" field.<a href="#section-3.3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.3-4">The "session_id" needs to be included in the new access token in order for RS to identify the old access token to supersede, as well as the OSCORE Security Context already shared between C and RS and to be associated with the new access token.<a href="#section-3.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="edhoc-parameters-object">
<section id="section-3.4">
        <h3 id="name-edhoc_information">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-edhoc_information" class="section-name selfRef">EDHOC_Information</a>
        </h3>
<p id="section-3.4-1">Editor's note: Remove the JSON option<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">EDHOC_Information is an object including information that guides two peers towards executing the EDHOC protocol. In particular, the EDHOC_Information is defined to be serialized and transported between nodes, as specified by this document, but it can also be used by other specifications if needed.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">The EDHOC_Information can be encoded either as a JSON object or as a CBOR map. The set of common fields that can appear in an EDHOC_Information can be found in the IANA "EDHOC Information" registry (see <a href="#iana-edhoc-parameters" class="auto internal xref">Section 10.9</a>), defined for extensibility, and the initial set of parameters defined in this document is specified below. All parameters are optional.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4"><a href="#_table-cbor-key-edhoc-params" class="auto internal xref">Table 1</a> provides a summary of the EDHOC_Information parameters defined in this section.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<span id="name-edhoc_information-parameter"></span><div id="_table-cbor-key-edhoc-params">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-edhoc_information-parameter" class="selfRef">EDHOC_Information Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">CBOR label</th>
              <th class="text-left" rowspan="1" colspan="1">CBOR type</th>
              <th class="text-left" rowspan="1" colspan="1">Registry</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">session_id</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">bstr</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Identifier of a session</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">methods</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Method Type Registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported EDHOC methods</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cipher_suites</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Cipher Suites Registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported EDHOC cipher suites</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">message_4</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Support for EDHOC message_4</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">comb_req</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Support for the EDHOC + OSCORE combined request</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">uri_path</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">URI-path of the EDHOC resource</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">osc_ms_len</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">uint</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Length in bytes of the OSCORE Master Secret to derive</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">osc_salt_len</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">uint</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Length in bytes of the OSCORE Master Salt to derive</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">osc_version</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">uint</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">OSCORE version number to use</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cred_types</td>
              <td class="text-left" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">int or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC Authentication Credential Types Registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported types of authentication credentials for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id_cred_types</td>
              <td class="text-left" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">int or tstr or array</td>
              <td class="text-left" rowspan="1" colspan="1">COSE Header Parameters Registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported types of authentication credential identifiers for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">eads</td>
              <td class="text-left" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">uint or array</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC External Authorization Data Registry</td>
              <td class="text-left" rowspan="1" colspan="1">Set of supported EDHOC External Authorization Data (EAD) items</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">initiator</td>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Support for the EDHOC Initiator role</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">responder</td>
              <td class="text-left" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">True or False</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Support for the EDHOC Responder role</td>
            </tr>
          </tbody>
        </table>
</div>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">
            <p id="section-3.4-6.1.1">session_id: This parameter identifies a 'session' which the EDHOC information is associated with, but does not necessarily identify a specific EDHOC session. In this document, "session_id" identifies a token series. In JSON, the "session_id" value is a Base64 encoded byte string. In CBOR, the "session_id" type is a byte string, and has label 0.<a href="#section-3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.2">
            <p id="section-3.4-6.2.1">methods: This parameter specifies a set of supported EDHOC methods (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single EDHOC method, this is encoded as an integer. Otherwise, the set is encoded as an array of integers, where each array element encodes one EDHOC method. In JSON, the "methods" value is an integer or an array of integers. In CBOR, the "methods" is an integer or an array of integers, and has label 1.<a href="#section-3.4-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.3">
            <p id="section-3.4-6.3.1">cipher_suites: This parameter specifies a set of supported EDHOC cipher suites (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single EDHOC cipher suite, this is encoded as an integer. Otherwise, the set is encoded as an array of integers, where each array element encodes one EDHOC cipher suite. In JSON, the "cipher_suites" value is an integer or an array of integers. In CBOR, the "cipher_suites" is an integer or an array of integers, and has label 2.<a href="#section-3.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.4">
            <p id="section-3.4-6.4.1">message_4: This parameter indicates whether the EDHOC message_4 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) is supported. In JSON, the "message_4" value is a boolean. In CBOR, "message_4" is the simple value "true" or "false", and has label 4.<a href="#section-3.4-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.5">
            <p id="section-3.4-6.5.1">comb_req: This parameter indicates whether the combined EDHOC + OSCORE request defined in <span>[<a href="#I-D.ietf-core-oscore-edhoc" class="cite xref">I-D.ietf-core-oscore-edhoc</a>]</span>) is supported. In JSON, the "comb_req" value is a boolean. In CBOR, "comb_req" is the simple value "true" or "false", and has label 5.<a href="#section-3.4-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.6">
            <p id="section-3.4-6.6.1">uri_path: This parameter specifies the path component of the URI of the EDHOC resource where EDHOC messages have to be sent as requests. In JSON, the "uri_path" value is a string. In CBOR, "uri_path" is a text string, and has label 6.<a href="#section-3.4-6.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.7">
            <p id="section-3.4-6.7.1">osc_ms_len: This parameter specifies the size in bytes of the OSCORE Master Secret to derive after the EDHOC session, as per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. In JSON, the "osc_ms_len" value is an integer. In CBOR, the "osc_ms_len" type is unsigned integer, and has label 7.<a href="#section-3.4-6.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.8">
            <p id="section-3.4-6.8.1">osc_salt_len: This parameter specifies the size in bytes of the OSCORE Master Salt to derive after the EDHOC session, as per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. In JSON, the "osc_salt_len" value is an integer. In CBOR, the "osc_salt_len" type is unsigned integer, and has label 8.<a href="#section-3.4-6.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.9">
            <p id="section-3.4-6.9.1">osc_version: This parameter specifies the OSCORE Version number that the two EDHOC peers have to use when using OSCORE. For more information about this parameter, see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. In JSON, the "osc_version" value is an integer. In CBOR, the "osc_version" type is unsigned integer, and has label 9.<a href="#section-3.4-6.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.10">
            <p id="section-3.4-6.10.1">cred_types: This parameter specifies a set of supported types of authentication credentials for EDHOC (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.2" class="relref">Section 3.5.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single type of authentication credential, this is encoded as an integer. Otherwise, the set is encoded as an array of integers, where each array element encodes one type of authentication credential. In JSON, the "cred_types" value is an integer or an array of integers. In CBOR, "cred_types" is an integer or an array of integers, and has label 9. The integer values are taken from the "EDHOC Authentication Credential Types" registry defined in <span>[<a href="#I-D.ietf-core-oscore-edhoc" class="cite xref">I-D.ietf-core-oscore-edhoc</a>]</span>.<a href="#section-3.4-6.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.11">
            <p id="section-3.4-6.11.1">id_cred_types: This parameter specifies a set of supported types of authentication credential identifiers for EDHOC (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3" class="relref">Section 3.5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single type of authentication credential identifier, this is encoded as an integer or a text string. Otherwise, the set is encoded as an array, where each array element encodes one type of authentication credential identifier, as an integer or a text string. In JSON, the "id_cred_types" value is an integer, or a text string, or an array of integers and text strings. In CBOR, "id_cred_types" is an integer or a text string, or an array of integers and text strings, and has label 10. The integer or text string values are taken from the 'Label' column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>.<a href="#section-3.4-6.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.12">
            <p id="section-3.4-6.12.1">eads: This parameter specifies a set of supported EDHOC External Authorization Data (EAD) items, identified by their ead_label (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). If the set is composed of a single ead_label, this is encoded as an unsigned integer. Otherwise, the set is encoded as an array of unsigned integers, where each array element encodes one ead_label. In JSON, the "eads" value is an unsigned integer or an array of unsigned integers. In CBOR, "eads" is an unsigned integer or an array of unsigned integers, and has label 11. The unsigned integer values are taken from the 'Label' column of the "EDHOC External Authorization Data" registry defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-3.4-6.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.13">
            <p id="section-3.4-6.13.1">initiator: This parameter specifies whether the EDHOC Initiator role is supported. In JSON, the "initiator" value is a boolean. In CBOR, "initiator" is the simple value "true" (0xf5) or "false" (0xf4), and has label 12.<a href="#section-3.4-6.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.14">
            <p id="section-3.4-6.14.1">responder: This parameter specifies whether the EDHOC Responder role is supported. In JSON, the "responder" value is a boolean. In CBOR, "responder" is the simple value "true" (0xf5) or "false" (0xf4), and has label 13.<a href="#section-3.4-6.14.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-7">An example of JSON EDHOC_Information is given in <a href="#fig-edhoc-info-json" class="auto internal xref">Figure 6</a>.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<span id="name-example-of-json-edhoc_infor"></span><div id="fig-edhoc-info-json">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-3.4-8.1">
<pre>
   "edhoc_info" : {
       "session_id"    : b64'AQ==',
       "methods"       : 1,
       "cipher_suites" : 0
   }
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-json-edhoc_infor" class="selfRef">Example of JSON EDHOC_Information</a>
          </figcaption></figure>
</div>
<p id="section-3.4-9">The CDDL grammar describing the CBOR EDHOC_Information is:<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-10">
<pre>
EDHOC_Information = {
  ?  0 =&gt; bstr,                   ; id
  ?  1 =&gt; int / array,            ; methods
  ?  2 =&gt; int / array,            ; cipher_suites
  ?  3 =&gt; true / false,           ; message_4
  ?  4 =&gt; true / false,           ; comb_req
  ?  5 =&gt; tstr,                   ; uri_path
  ?  6 =&gt; uint,                   ; osc_ms_len
  ?  7 =&gt; uint,                   ; osc_salt_len
  ?  8 =&gt; uint,                   ; osc_version
  ?  9 =&gt; int / array,            ; cred_types
  ? 10 =&gt; int / tstr / array,     ; id_cred_types
  ? 11 =&gt; uint / array,           ; eads
  ? 12 =&gt; true / false,           ; initiator
  ? 13 =&gt; true / false,           ; responder
  * int / tstr =&gt; any
}
</pre><a href="#section-3.4-10" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="c-rs-comm">
<section id="section-4">
      <h2 id="name-client-rs-communication">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-client-rs-communication" class="section-name selfRef">Client-RS Communication</a>
      </h2>
<p id="section-4-1">This section describes the exchange between C and RS, including the token uploading to RS, and the execution of the EDHOC protocol. The alternative workflow where AS uploads the access token directly to RS is described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The case where C sends a POST request to the /authz-info endpoint at RS is detailed in <a href="#c-rs" class="auto internal xref">Section 4.1</a> and <a href="#rs-c" class="auto internal xref">Section 4.2</a>, and shown by the example in <a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The case where C uploads the access token in an EAD field of an EDHOC message while executing the EDHOC protocol with RS is discussed in <a href="#AT-in-EAD" class="auto internal xref">Section 4.3</a> and <a href="#edhoc-exec" class="auto internal xref">Section 4.4</a>, and shown by the example in <a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">In either case, C and RS run the EDHOC protocol by exchanging POST requests and related responses to a dedicated EDHOC resource at RS (see <a href="#edhoc-exec" class="auto internal xref">Section 4.4</a>). Once completed the EDHOC session, C and RS have agreed on a common secret key PRK_out (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), from which they establish an OSCORE Security Context (see <a href="#edhoc-exec" class="auto internal xref">Section 4.4</a>). After that, C and RS use the established OSCORE Security Context to protect their communications when accessing protected resources at RS, as per the access rights specified in the access token (see <a href="#access-rights-verif" class="auto internal xref">Section 4.8</a>).<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">C and RS are mutually authenticated once they have successfully completed the EDHOC protocol. RS gets key confirmation of PRK_out by C at the end of the successful EDHOC session. Conversely, C get key confirmation of PRK_out by RS either when receiving and successfully verifying the optional EDHOC message_4 from RS, or when successfully verifying a response from RS protected with the generated OSCORE Security Context.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="c-rs">
<section id="section-4.1">
        <h3 id="name-c-to-rs-post-to-authz-info-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-c-to-rs-post-to-authz-info-" class="section-name selfRef">C-to-RS: POST to /authz-info endpoint</a>
        </h3>
<p id="section-4.1-1">The access token can be uploaded to RS using CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and the Authorization Information endpoint as described in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">That is, C sends a POST request to the /authz-info endpoint at RS, with the request payload conveying the access token without any CBOR wrapping. As per <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, the Content-Format of the POST request <span class="bcp14">MUST</span> be "application/cwt" to reflect the format of the transported access token.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The communication with the /authz-info endpoint may not be protected unless there is previously established security context, for example in the case of update of access rights, see <a href="#update-access-rights-c-rs" class="auto internal xref">Section 4.5</a>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rs-c">
<section id="section-4.2">
        <h3 id="name-rs-to-c-201-created">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-rs-to-c-201-created" class="section-name selfRef">RS-to-C: 2.01 (Created)</a>
        </h3>
<p id="section-4.2-1">Upon receiving an access token from C, RS <span class="bcp14">MUST</span> follow the procedures defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. That is, RS must verify the validity of the access token. RS may make an introspection request (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.9.1" class="relref">Section 5.9.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>) to validate the access token.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">If the access token is valid, RS proceeds as follows.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">RS checks whether it is already storing the authentication credential of C, AUTH_CRED_C, specified in the "cnf" claim of the access token by value or by reference. If not, RS retrieves AUTH_CRED_C, either using the "cnf" claim or some other trusted source.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">If RS fails to find or validate AUTH_CRED_C, then RS <span class="bcp14">MUST</span> respond with an error response code equivalent to the CoAP code 4.00 (Bad Request). RS may provide additional information in the payload of the error response, in order to clarify what went wrong.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">If, instead, the access token is valid but associated with claims that RS cannot process (e.g., an unknown scope), or if any of the expected parameters is missing (e.g., any of the mandatory parameters from AS or the identifier "session_id"), or if any parameters received in the EDHOC_Information is unrecognized, then RS <span class="bcp14">MUST</span> respond with an error response code equivalent to the CoAP code 4.00 (Bad Request). In the latter two cases, RS may provide additional information in the payload of the error response, in order to clarify what went wrong.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">If all validations are successful, RS <span class="bcp14">MUST</span> reply to the POST request with a 2.01 (Created) response. The access token is stored such that it is possible to retrieve it based on "session_id" and AUTH_CRED_C.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">When an access token becomes invalid (e.g., due to its expiration or revocation), RS <span class="bcp14">MUST</span> delete the access token and the associated OSCORE Security Context, and <span class="bcp14">MUST</span> notify C with an error response with code 4.01 (Unauthorized) for any long running request, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AT-in-EAD">
<section id="section-4.3">
        <h3 id="name-access-token-in-external-au">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-access-token-in-external-au" class="section-name selfRef">Access Token in External Authorization Data</a>
        </h3>
<p id="section-4.3-1">Instead of uploading the access token to the /authz-info endpoint at RS as described in <a href="#c-rs" class="auto internal xref">Section 4.1</a>, C <span class="bcp14">MAY</span> include the access token in EDHOC message_3 by making use of the External Authorization Data field EAD_3 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), see example in <a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a>. In this case, the access token is encrypted between C and RS enabling protection of potential sensitive information.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">This document defines the EAD item EAD_ACCESS_TOKEN = (ead_label, ead_value), where:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.1">
            <p id="section-4.3-3.1.1">ead_label is the integer value TBD registered in <a href="#iana-edhoc-ead" class="auto internal xref">Section 10.8</a> and<a href="#section-4.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-3.2">
            <p id="section-4.3-3.2.1">ead_value is a CBOR byte string, with value the binary serialization of a CBOR map. The CBOR map includes one field, whose label is a CBOR unsigned integer with value either 0 or 1, and whose value is a CBOR byte string:<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-3.2.2.1">
                <p id="section-4.3-3.2.2.1.1">For label 0, ead_value = { 0 : access_token }, where access_token is a CBOR byte string equal to the value of the "access_token" field of the access token response from AS, see <a href="#as-c" class="auto internal xref">Section 3.3</a>.<a href="#section-4.3-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.3-3.2.2.2">
                <p id="section-4.3-3.2.2.2.1">For label 1, ead_value = { 1 : session_id }, where session_id is a CBOR byte string equal to the value of the "session_id" field of the access token response from AS, see <a href="#token-series" class="auto internal xref">Section 3.2</a>.<a href="#section-4.3-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-4.3-4">This EAD item, which is used in EAD_3, is critical, i.e., it is used only with the negative value of its ead_label, indicating that the receiving RS must either process the access token or abort the EDHOC session (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). A Client or Resource Server supporting the profile of ACE defined in this document <span class="bcp14">MUST</span> support this EAD item. When EDHOC is used with this profile, this EAD item is included in EAD_3, see <a href="#m_3" class="auto internal xref">Section 4.4.3</a>.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">Access tokens are transported in EAD fields only for the first access token of a token series, and not for the update of access rights, see <a href="#update-access-rights-c-rs" class="auto internal xref">Section 4.5</a>.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-exec">
<section id="section-4.4">
        <h3 id="name-edhoc-session-and-oscore-se">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-edhoc-session-and-oscore-se" class="section-name selfRef">EDHOC Session and OSCORE Security Context</a>
        </h3>
<p id="section-4.4-1">In order to mutually authenticate and establish secure communication for authorized access according to the profile described in this document, C and RS run the EDHOC protocol <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> with C as EDHOC Initiator and RS as EDHOC Responder. When a new EDHOC session is established, previous EDHOC sessions associated with the same access token and the same pair (session_id, AUTH_CRED_C) are deleted, see <a href="#m_3" class="auto internal xref">Section 4.4.3</a>. The OSCORE Security Contexts derived from those EDHOC sessions are also deleted.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">As per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, C sends EDHOC message_1 and EDHOC message_3 to an EDHOC resource at RS, as CoAP POST requests. RS sends EDHOC message_2 and (optionally) EDHOC message_4 as 2.04 (Changed) CoAP responses. C <span class="bcp14">MUST</span> target the EDHOC resource at RS with the URI path specified in the "uri_path" field of the EDHOC_Information in the access token response received from AS (see <a href="#c-as" class="auto internal xref">Section 3.1</a>), if present.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">In order to seamlessly run EDHOC, a client does not have to first upload to RS an access token whose scope explicitly indicates authorized access to the EDHOC resource. At the same time, RS has to ensure that attackers cannot perform requests on the EDHOC resource, other than sending EDHOC messages. Specifically, it <span class="bcp14">SHOULD NOT</span> be possible to perform anything else than POST on an EDHOC resource.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<div id="edhoc-message1">
<section id="section-4.4.1">
          <h4 id="name-edhoc-message_1">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-edhoc-message_1" class="section-name selfRef">EDHOC message_1</a>
          </h4>
<p id="section-4.4.1-1">The processing of EDHOC message_1 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. Additionally, the following applies:<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-2.1">
              <p id="section-4.4.1-2.1.1">The EDHOC method <span class="bcp14">MUST</span> be one of the EDHOC methods specified in the "methods" field (if present) in the EDHOC_Information of the access token response to C.<a href="#section-4.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-2.2">
              <p id="section-4.4.1-2.2.1">The selected cipher suite <span class="bcp14">MUST</span> be an EDHOC cipher suite specified in the "cipher_suites" field (if present) in the EDHOC_Information of the access token response to C.<a href="#section-4.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="edhoc-message2">
<section id="section-4.4.2">
          <h4 id="name-edhoc-message_2">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-edhoc-message_2" class="section-name selfRef">EDHOC message_2</a>
          </h4>
<p id="section-4.4.2-1">The processing of EDHOC message_2 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> with the following additions:<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.2-2.1">
              <p id="section-4.4.2-2.1.1">The authentication credential CRED_R indicated by the message field ID_CRED_R is AUTH_CRED_RS.<a href="#section-4.4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="m_3">
<section id="section-4.4.3">
          <h4 id="name-edhoc-message_3">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-edhoc-message_3" class="section-name selfRef">EDHOC message_3</a>
          </h4>
<p id="section-4.4.3-1">The processing of EDHOC message_3 is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> with the following additions:<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.3-2.1">
              <p id="section-4.4.3-2.1.1">The authentication credential CRED_I indicated by the message field ID_CRED_I is AUTH_CRED_C.<a href="#section-4.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.3-2.2">
              <p id="section-4.4.3-2.2.1">The EAD item EAD_ACCESS_TOKEN = (-ead_label, ead_value) <span class="bcp14">MUST</span> be included in the EAD_3 field. If the access token is provisioned with EDHOC message_3 as specified in <a href="#AT-in-EAD" class="auto internal xref">Section 4.3</a>, then ead_value = { 0 : access_token}, otherwise ead_value = { 1 : session_id}, where session_id is equal to the value of the "session_id" field of the access token response from AS, see <a href="#token-series" class="auto internal xref">Section 3.2</a>.<a href="#section-4.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.3-2.3">
              <p id="section-4.4.3-2.3.1">The RS <span class="bcp14">MUST</span> ensure that the access token is valid, potentially first retrieving it using session_id and AUTH_CRED_C, the validation follows the procedure specified in <a href="#rs-c" class="auto internal xref">Section 4.2</a>. If such a process fails, RS <span class="bcp14">MUST</span> reply to C with an EDHOC error message with ERR_CODE = 1 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6" class="relref">Section 6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), and it <span class="bcp14">MUST</span> abort the EDHOC session. RS <span class="bcp14">MUST</span> have successfully validated the processing of the access token before completing the EDHOC session. If completed successfully, then the EDHOC session is associated with both the access token and the pair (session_id, AUTH_CRED_C). Any old existing EDHOC session associated with the same access token and with the same pair (session_id, AUTH_CRED_C) <span class="bcp14">MUST</span> be deleted, together with the OSCORE Security Context derived from the EDHOC session.<a href="#section-4.4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.4.3-3">Editor's note: Instead of ERR_CODE = 1, consider to use ERR_CODE = 3 "Access Denied"  defined in draft-ietf-lake-authz<a href="#section-4.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oscore-security-context">
<section id="section-4.4.4">
          <h4 id="name-oscore-security-context">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-oscore-security-context" class="section-name selfRef">OSCORE Security Context</a>
          </h4>
<p id="section-4.4.4-1">Once successfully completed the EDHOC session, C and RS derive an OSCORE Security Context, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. In addition, the following applies.<a href="#section-4.4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.4-2.1">
              <p id="section-4.4.4-2.1.1">The length in bytes of the OSCORE Master Secret (i.e., the oscore_key_length parameter, see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) <span class="bcp14">MUST</span> be the value specified in the "osc_ms_size" field (if present) in the EDHOC_Information of the access token response to C, and of the access token provisioned to RS, respectively.<a href="#section-4.4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.4-2.2">
              <p id="section-4.4.4-2.2.1">The length in bytes of the OSCORE Master Salt (i.e., the oscore_salt_length parameter, see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) <span class="bcp14">MUST</span> be the value specified in the "osc_salt_size" field (if present) in the EDHOC_Information of the access token response to C, and of the access token provisioned to RS, respectively.<a href="#section-4.4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.4-2.3">
              <p id="section-4.4.4-2.3.1">C and RS <span class="bcp14">MUST</span> use the OSCORE version specified in the "osc_version" field (if present) in the EDHOC_Information of the access token response to C, and of the access token provisioned to RS, respectively.<a href="#section-4.4.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.4-2.4">
              <p id="section-4.4.4-2.4.1">RS associates the latest EDHOC session and the derived OSCORE Security Context
with the stored access token, which is bound to the authentication credential (AUTH_CRED_C = CRED_I) used in the EDHOC session and with the session_id identifying the token series to which the access token belongs.<a href="#section-4.4.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.4.4-3">If supported by C, C <span class="bcp14">MAY</span> use the EDHOC + OSCORE combined request defined in <span>[<a href="#I-D.ietf-core-oscore-edhoc" class="cite xref">I-D.ietf-core-oscore-edhoc</a>]</span>, unless the "comb_req" field of the EDHOC_Information was present in the access token response and set to the CBOR simple value "false" (0xf4). In the combined request, both EDHOC message_3 and the first OSCORE-protected application request are combined together in a single OSCORE-protected CoAP request, thus saving one round trip. For an example, see <a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a>. This requires C to derive the OSCORE Security Context with RS already after having successfully processed the received EDHOC message_2 and before sending EDHOC message_3.<a href="#section-4.4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="update-access-rights-c-rs">
<section id="section-4.5">
        <h3 id="name-update-of-access-rights-2">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-update-of-access-rights-2" class="section-name selfRef">Update of Access Rights</a>
        </h3>
<p id="section-4.5-1">Editor's note: This section should allow for access rights being updated by AS posting to RS.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">If C has already established access rights and an OSCORE Security Context with RS, then C can update its access rights by posting a new access token to the /authz-info endpoint.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">The new access token contains the updated access rights for C to access protected resources at RS, and C has to obtain it from AS as a new access token in the same token series of the current one (see <a href="#c-as-comm" class="auto internal xref">Section 3</a>). When posting the new access token to the /authz-info endpoint, C <span class="bcp14">MUST</span> protect the POST request using the current OSCORE Security Context shared with RS. After successful verification (see <a href="#rs-c" class="auto internal xref">Section 4.2</a>), RS will replace the old access token with the new one, while preserving the same OSCORE Security Context. In particular, C and RS do not re-run the EDHOC protocol and they do not establish a new OSCORE Security Context.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">Editor's note: Mention the alternative when the AS uploads the new access token to RS.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">If RS receives an access token in an OSCORE protected request, it means that C is requesting an update of access rights. In this case, RS <span class="bcp14">MUST</span> check the following conditions:<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-6.1">
            <p id="section-4.5-6.1.1">RS checks whether it stores an access token T_OLD, such that the "session_id" field of EDHOC_Information matches the "session_id" field of EDHOC_Information in the new access token T_NEW.<a href="#section-4.5-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.5-6.2">
            <p id="section-4.5-6.2.1">RS checks whether the OSCORE Security Context CTX used to protect the request matches the OSCORE Security Context associated with the stored access token T_OLD.<a href="#section-4.5-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.5-7">If both the conditions above hold, RS <span class="bcp14">MUST</span> replace the old access token T_OLD with the new access token T_NEW, and associate T_NEW with the OSCORE Security Context CTX. Then, RS <span class="bcp14">MUST</span> respond with a 2.01 (Created) response protected with the same OSCORE Security Context, with no payload.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<p id="section-4.5-8">Otherwise, RS <span class="bcp14">MUST</span> respond with a 4.01 (Unauthorized) error response. RS may provide additional information in the payload of the error response, in order to clarify what went wrong.<a href="#section-4.5-8" class="pilcrow">¶</a></p>
<p id="section-4.5-9">As specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, when receiving an updated access token with updated authorization information from C (see <a href="#c-rs" class="auto internal xref">Section 4.1</a>), it is recommended that RS overwrites the previous access token. That is, only the latest authorization information in the access token received by RS is valid. This simplifies the process needed by RS to keep track of authorization information for a given client.<a href="#section-4.5-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discard-context">
<section id="section-4.6">
        <h3 id="name-discarding-the-security-con">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-discarding-the-security-con" class="section-name selfRef">Discarding the Security Context</a>
        </h3>
<p id="section-4.6-1">There are a number of cases where C or RS have to discard the OSCORE Security Context, and possibly establish a new one.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">C <span class="bcp14">MUST</span> discard the current OSCORE Security Context shared with RS when any of the following occurs.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-3.1">
            <p id="section-4.6-3.1.1">The OSCORE Sender Sequence Number space of C is exhausted.<a href="#section-4.6-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-3.2">
            <p id="section-4.6-3.2.1">The access token associated with the OSCORE Security Context becomes invalid, for example due to expiration or revocation.<a href="#section-4.6-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-3.3">
            <p id="section-4.6-3.3.1">C receives a number of unprotected 4.01 (Unauthorized) responses to OSCORE-protected requests, which are sent to RS and protected using the same OSCORE Security Context. The exact number of such received responses needs to be specified by the application. This may for example happen due to lack of storage in RS, which then sends the "AS Request Creation Hints" message (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-4.6-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-3.4">
            <p id="section-4.6-3.4.1">The authentication credential of C (of RS) becomes invalid, e.g., due to expiration or revocation, and it was used as CRED_I (CRED_R) in the EDHOC session to establish the OSCORE Security Context.<a href="#section-4.6-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.6-4">RS <span class="bcp14">MUST</span> discard the current OSCORE Security Context shared with C when any of the following occurs:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-5.1">
            <p id="section-4.6-5.1.1">The OSCORE Sender Sequence Number space of RS is exhausted.<a href="#section-4.6-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-5.2">
            <p id="section-4.6-5.2.1">The access token associated with the OSCORE Security Context becomes invalid, for example due to expiration or revocation.<a href="#section-4.6-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-5.3">
            <p id="section-4.6-5.3.1">The authentication credential of C (of RS) becomes invalid (e.g., due to expiration or revocation), and it was used as CRED_I (CRED_R) in the EDHOC session to establish the OSCORE Security Context.<a href="#section-4.6-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.6-6">After a new access token is successfully uploaded to RS, and a new OSCORE Security Context is established between C and RS, messages still in transit that were protected with the previous OSCORE Security Context might not be successfully verified by the recipient, since the old OSCORE Security Context might have been discarded. This means that messages sent shortly before C has uploaded the new access token to RS might not be successfully accepted by the recipient.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
<p id="section-4.6-7">Furthermore, implementations may want to cancel CoAP observations at RS, if registered before the new OSCORE Security Context has been established. Alternatively, applications need to implement a mechanism to ensure that, from then on, messages exchanged within those observations are going to be protected with the newly derived OSCORE Security Context.<a href="#section-4.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cases-of-establishing-a-new-oscore-security-context">
<section id="section-4.7">
        <h3 id="name-cases-of-establishing-a-new">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-cases-of-establishing-a-new" class="section-name selfRef">Cases of Establishing a New OSCORE Security Context</a>
        </h3>
<p id="section-4.7-1">The procedure of provisioning a new access token to RS specified in this section applies to various cases when an OSCORE Security Context shared between C and RS has been deleted, for example as described in <a href="#discard-context" class="auto internal xref">Section 4.6</a>.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">Another exceptional case is when there is still a valid OSCORE Security Context but it needs to be updated, e.g., due to a policy limiting its use in terms of time or amount of processed data, or to the imminent exhaustion of the OSCORE Sender Sequence Number space. In this case, C and RS <span class="bcp14">SHALL</span> attempt to run the KUDOS key update protocol <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>, which is a lightweight alternative independent of ACE and EDHOC that does not require the posting of an access token. If KUDOS is not supported, then C and RS falls back to EDHOC as outlined above.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">In either case, C and RS establish a new OSCORE Security Context that replaces the old one and will be used for protecting their communications from then on. In particular, RS <span class="bcp14">MUST</span> associate the new OSCORE Security Context with the current (potentially re-posted) access token. Unless C and RS re-run the EDHOC protocol, they preserve their OSCORE identifiers, i.e., the OSCORE Sender/Recipient IDs.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-rights-verif">
<section id="section-4.8">
        <h3 id="name-access-rights-verification">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-access-rights-verification" class="section-name selfRef">Access Rights Verification</a>
        </h3>
<p id="section-4.8-1">RS <span class="bcp14">MUST</span> follow the procedures defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.2" class="relref">Section 5.10.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. That is, if RS receives an OSCORE-protected request targeting a protected resource from C, then RS processes the request according to <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, when Version 1 of OSCORE is used. Future specifications may define new versions of OSCORE, which AS can indicate C and RS to use by means of the "osc_version" field of EDHOC_Information (see <a href="#c-as-comm" class="auto internal xref">Section 3</a>).<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">If OSCORE verification succeeds and the target resource requires authorization, RS retrieves the authorization information using the access token associated with the OSCORE Security Context. Then, RS must verify that the authorization information covers the target resource and the action intended by C on it.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="secure-comm-as">
<section id="section-5">
      <h2 id="name-secure-communication-with-a">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-secure-communication-with-a" class="section-name selfRef">Secure Communication with AS</a>
      </h2>
<p id="section-5-1">As specified in the ACE framework (see Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">5.8</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.9" class="relref">5.9</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), the requesting entity (RS and/or C) and AS communicates via the /token or /introspect endpoint. When using this profile, the use of CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> for this communication is <span class="bcp14">RECOMMENDED</span>. Other protocols fulfilling the security requirements defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5" class="relref">Section 5</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> (such as HTTP and DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> or TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>) <span class="bcp14">MAY</span> be used instead.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If OSCORE is used, the requesting entity and AS need to have an OSCORE Security Context in place. While this can be pre-installed, the requesting entity and AS can establish such an OSCORE Security Context, for example, by running the EDHOC protocol, as shown between C and AS by the examples in <a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a> and <a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a>. This also applies for communication between RS and AS, for example to protect the upload of access token from AS directly to RS as described in <span>[<a href="#I-D.ietf-ace-workflow-and-params" class="cite xref">I-D.ietf-ace-workflow-and-params</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cwt-confirmation-methods">
<section id="section-6">
      <h2 id="name-cwt-confirmation-methods">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-cwt-confirmation-methods" class="section-name selfRef">CWT Confirmation Methods</a>
      </h2>
<p id="section-6-1">This document defines a number of new CWT confirmation methods (see <a href="#iana-cwt-confirmation-methods" class="auto internal xref">Section 10.7</a>). The semantics of each confirmation method is defined below.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="ssec-cwt-conf-x5chain">
<section id="section-6.1">
        <h3 id="name-ordered-chain-of-x509-certi">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ordered-chain-of-x509-certi" class="section-name selfRef">Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-6.1-1">The confirmation method "x5chain" specifies an ordered array of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5chain" is like that of the "x5chain" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-x5bag">
<section id="section-6.2">
        <h3 id="name-unordered-bag-of-x509-certi">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-unordered-bag-of-x509-certi" class="section-name selfRef">Unordered Bag of X.509 Certificates</a>
        </h3>
<p id="section-6.2-1">The confirmation method "x5bag" specifies a bag of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5bag" is like that of the "x5bag" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-x5t">
<section id="section-6.3">
        <h3 id="name-hash-of-an-x509-certificate">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-hash-of-an-x509-certificate" class="section-name selfRef">Hash of an X.509 Certificate</a>
        </h3>
<p id="section-6.3-1">The confirmation method "x5t" specifies the hash value of the end-entity X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5t" is like that of the "x5t" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-x5u">
<section id="section-6.4">
        <h3 id="name-uri-pointing-to-an-ordered-">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-uri-pointing-to-an-ordered-" class="section-name selfRef">URI Pointing to an Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-6.4-1">The confirmation method "x5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of an ordered chain of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5u" is like that of the "x5u" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5c">
<section id="section-6.5">
        <h3 id="name-ordered-chain-of-c509-certi">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-ordered-chain-of-c509-certi" class="section-name selfRef">Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-6.5-1">The confirmation method "c5c" specifies an ordered array of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5c" is like that of the "c5c" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5b">
<section id="section-6.6">
        <h3 id="name-unordered-bag-of-c509-certi">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-unordered-bag-of-c509-certi" class="section-name selfRef">Unordered Bag of C509 Certificates</a>
        </h3>
<p id="section-6.6-1">The confirmation method "c5b" specifies a bag of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5b" is like that of the "c5b" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5t">
<section id="section-6.7">
        <h3 id="name-hash-of-a-c509-certificate">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-hash-of-a-c509-certificate" class="section-name selfRef">Hash of a C509 Certificate</a>
        </h3>
<p id="section-6.7-1">The confirmation method "c5t" specifies the hash value of the end-entity C509 certificate <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5t" is like that of the "c5t" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-c5u">
<section id="section-6.8">
        <h3 id="name-uri-pointing-to-an-ordered-c">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-uri-pointing-to-an-ordered-c" class="section-name selfRef">URI Pointing to an Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-6.8-1">The confirmation method "c5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of a COSE_C509 containing an ordered chain of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. COSE_C509 is defined in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5u" is like that of the "c5u" COSE Header Parameter specified in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-kcwt">
<section id="section-6.9">
        <h3 id="name-cwt-containing-a-cose_key">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-cwt-containing-a-cose_key" class="section-name selfRef">CWT Containing a COSE_Key</a>
        </h3>
<p id="section-6.9-1">The confirmation method "kcwt" specifies a CBOR Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The semantics of "kcwt" is like that of the "kcwt" COSE Header Parameter specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-cwt-conf-kccs">
<section id="section-6.10">
        <h3 id="name-ccs-containing-a-cose_key">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-ccs-containing-a-cose_key" class="section-name selfRef">CCS Containing a COSE_Key</a>
        </h3>
<p id="section-6.10-1">The confirmation method "kccs" specifies a CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The semantics of "kccs" is like that of the "kccs" COSE Header Parameter specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="jwt-confirmation-methods">
<section id="section-7">
      <h2 id="name-jwt-confirmation-methods">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-jwt-confirmation-methods" class="section-name selfRef">JWT Confirmation Methods</a>
      </h2>
<p id="section-7-1">This document defines a number of new JWT confirmation methods (see <a href="#iana-jwt-confirmation-methods" class="auto internal xref">Section 10.6</a>). The semantics of each confirmation method is defined below.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="ssec-jwt-conf-x5c">
<section id="section-7.1">
        <h3 id="name-ordered-chain-of-x509-certif">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-ordered-chain-of-x509-certif" class="section-name selfRef">Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-7.1-1">The confirmation method "x5c" specifies an ordered array of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5c" is like that of the "x5c" JSON Web Signature and Encryption Header Parameter specified in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, with the following difference. The public key contained in the first certificate is the proof-of-possession key and does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-x5b">
<section id="section-7.2">
        <h3 id="name-unordered-bag-of-x509-certif">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-unordered-bag-of-x509-certif" class="section-name selfRef">Unordered Bag of X.509 Certificates</a>
        </h3>
<p id="section-7.2-1">The confirmation method "x5b" specifies a bag of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of the "x5b" is like that of the "x5c" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5c" class="auto internal xref">Section 7.1</a>, with the following differences. First, the set of certificates is unordered and may contain self-signed certificates. Second, the composition and processing of "x5b" are like for the "x5bag" COSE Header Parameter defined in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-x5t">
<section id="section-7.3">
        <h3 id="name-hash-of-an-x509-certificate-2">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-hash-of-an-x509-certificate-2" class="section-name selfRef">Hash of an X.509 Certificate</a>
        </h3>
<p id="section-7.3-1">The confirmation method "x5t" specifies the hash value of the end-entity X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5t" is like that of the "x5t" JSON Web Signature and Encryption Header Parameter specified in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-x5u">
<section id="section-7.4">
        <h3 id="name-uri-pointing-to-an-ordered-ch">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-uri-pointing-to-an-ordered-ch" class="section-name selfRef">URI Pointing to an Ordered Chain of X.509 Certificates</a>
        </h3>
<p id="section-7.4-1">The confirmation method "x5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of an ordered chain of X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The semantics of "x5u" is like that of the "x5u" COSE Header Parameter specified in <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>, with the following difference. The public key contained in the first certificate is the proof-of-possession key and does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5c">
<section id="section-7.5">
        <h3 id="name-ordered-chain-of-c509-certif">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-ordered-chain-of-c509-certif" class="section-name selfRef">Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-7.5-1">The confirmation method "c5c" specifies an ordered array of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5c" is like that of the "x5c" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5c" class="auto internal xref">Section 7.1</a>, with the following difference. Each string in the JSON array is a base64-encoded (<span><a href="https://rfc-editor.org/rfc/rfc4648#section-4" class="relref">Section 4</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> - not base64url-encoded) C509 certificate.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5b">
<section id="section-7.6">
        <h3 id="name-unordered-bag-of-c509-certif">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-unordered-bag-of-c509-certif" class="section-name selfRef">Unordered Bag of C509 Certificates</a>
        </h3>
<p id="section-7.6-1">The confirmation method "c5b" specifies a bag of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5b" is like that of the "c5c" JWT confirmation method defined in <a href="#ssec-jwt-conf-c5c" class="auto internal xref">Section 7.5</a>, with the following differences. First, the set of certificates is unordered and may contain self-signed certificates. Second, the composition and processing of "c5b" is like for the "c5b" COSE Header Parameter defined in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5t">
<section id="section-7.7">
        <h3 id="name-hash-of-a-c09-certificate">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-hash-of-a-c09-certificate" class="section-name selfRef">Hash of a C09 Certificate</a>
        </h3>
<p id="section-7.7-1">The confirmation method "c5t" specifies the hash value of the end-entity C509 certificate <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5t" is like that of the "x5t" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5t" class="auto internal xref">Section 7.3</a>, with the following differences. First, the base64url-encoded SHA-1 thumbprint is computed over the C509 certificate. Second, the public key contained in the C509 certificate does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-c5u">
<section id="section-7.8">
        <h3 id="name-uri-pointing-to-an-ordered-cha">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-uri-pointing-to-an-ordered-cha" class="section-name selfRef">URI Pointing to an Ordered Chain of C509 Certificates</a>
        </h3>
<p id="section-7.8-1">The confirmation method "c5u" specifies the URI <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> of COSE_C509 containing an ordered chain of C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. COSE_C509 is defined in <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. The semantics of "c5u" is like that of the "x5u" JWT confirmation method defined in <a href="#ssec-jwt-conf-x5u" class="auto internal xref">Section 7.4</a>, with the following differences. First, the URI refers to a resource for the C509 certificate chain. Second, the public key contained in one of the C509 certificates and acting as proof-of-possession key does not have to correspond to a key used to digitally sign the JWS.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-kcwt">
<section id="section-7.9">
        <h3 id="name-cwt-containing-a-cose_key-2">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-cwt-containing-a-cose_key-2" class="section-name selfRef">CWT Containing a COSE_Key</a>
        </h3>
<p id="section-7.9-1">The confirmation method "kcwt" specifies a CBOR Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The format of "kcwt" is the base64url-encoded serialization of the CWT.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-jwt-conf-kccs">
<section id="section-7.10">
        <h3 id="name-ccs-containing-a-cose_key-2">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-ccs-containing-a-cose_key-2" class="section-name selfRef">CCS Containing a COSE_Key</a>
        </h3>
<p id="section-7.10-1">The confirmation method "kccs" specifies a CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> containing a COSE_Key <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> in a 'cnf' claim and possibly other claims. The format of "kcwt" is the base64url-encoded serialization of the CWT.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Thus, the general security considerations from the ACE framework also apply to this profile.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Furthermore, the security considerations from OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and from EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> also apply to this specific use of the OSCORE and EDHOC protocols.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">As previously stated, once completed the EDHOC session, C and RS are mutually authenticated through their respective authentication credentials, whose retrieval has been facilitated by AS. Also once completed the EDHOC session, C and RS have established a long-term secret key PRK_out enjoying forward secrecy. This is in turn used by C and RS to establish an OSCORE Security Context.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Furthermore, RS achieves confirmation that C has PRK_out (proof-of-possession) when completing the EDHOC session. Rather, C achieves confirmation that RS has PRK_out (proof-of-possession) either when receiving the optional EDHOC message_4 from RS, or when successfully verifying a response from RS protected with the established OSCORE Security Context.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">OSCORE is designed to secure point-to-point communication, providing a secure binding between a request and the corresponding response(s). Thus, the basic OSCORE protocol is not intended for use in point-to-multipoint communication (e.g., enforced via multicast or a publish-subscribe model). Implementers of this profile should make sure that their use case of OSCORE corresponds to the expected one, in order to prevent weakening the security assurances provided by OSCORE.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">When using this profile, it is <span class="bcp14">RECOMMENDED</span> that RS stores only one access token per client. The use of multiple access tokens for a single client increases the strain on RS, since it must consider every access token associated with the client and calculate the actual permissions that client has. Also, access tokens indicating different or disjoint permissions from each other may lead RS to enforce wrong permissions.  If one of the access tokens expires earlier than others, the resulting permissions may offer insufficient protection. Developers <span class="bcp14">SHOULD</span> avoid using multiple access tokens for a same client. Furthermore, RS <span class="bcp14">MUST NOT</span> store more than one access token per client per PoP-key (i.e., per client's authentication credential).<a href="#section-8-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-9-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Thus, the general privacy considerations from the ACE framework also apply to this profile.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Furthermore, the privacy considerations from OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and from EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> also apply to this specific use of the OSCORE and EDHOC protocols.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">An unprotected response to an unauthorized request may disclose information about RS and/or its existing relationship with C. It is advisable to include as little information as possible in an unencrypted response. When an OSCORE Security Context already exists between C and RS, more detailed information may be included.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Except for the case where C attempts to update its access rights, the (encrypted) access token is sent in an unprotected POST request to the /authz-info endpoint at RS. Thus, if C uses the same single access token from multiple locations, it can risk being tracked by the access token's value even when the access token is encrypted.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">The identifiers used in OSCORE, i.e., the OSCORE Sender/Recipient IDs, are negotiated by C and RS during the EDHOC session. That is, the EDHOC Connection Identifier C_I of C is going to be the OSCORE Recipient ID of C (the OSCORE Sender ID of RS). Conversely, the EDHOC Connection Identifier C_R of RS is going to be the OSCORE Recipient ID of RS (the OSCORE Sender ID of C). These OSCORE identifiers are privacy sensitive (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-12.8" class="relref">Section 12.8</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>). In particular, they could reveal information about C, or may be used for correlating different requests from C, e.g., across different networks that C has joined and left over time. This can be mitigated if C and RS dynamically update their OSCORE identifiers, e.g., by using the method defined in <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>.<a href="#section-9-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has the following actions for IANA.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="iana-ace-oauth-profile">
<section id="section-10.1">
        <h3 id="name-ace-profiles-registry">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-ace-profiles-registry" class="section-name selfRef">ACE Profiles Registry</a>
        </h3>
<p id="section-10.1-1">IANA is asked to add the following entry to the "ACE Profiles" registry, following the procedure specified in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-2.1">
            <p id="section-10.1-2.1.1">Name: coap_edhoc_oscore<a href="#section-10.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-2.2">
            <p id="section-10.1-2.2.1">Description: Profile for delegating client authentication and authorization in a constrained environment by establishing an OSCORE Security Context <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> between resource-constrained nodes, through the execution of the lightweight authenticated key exchange protocol EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-10.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-2.3">
            <p id="section-10.1-2.3.1">CBOR Value:  TBD (value between 1 and 255)<a href="#section-10.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-2.4">
            <p id="section-10.1-2.4.1">Reference:  [RFC-XXXX]<a href="#section-10.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-params">
<section id="section-10.2">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-10.2-1">IANA is asked to add the following entry to the "OAuth Parameters" registry.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-2.1">
            <p id="section-10.2-2.1.1">Name: "edhoc_info"<a href="#section-10.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-2.2">
            <p id="section-10.2-2.2.1">Parameter Usage Location: token request and token response<a href="#section-10.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-2.3">
            <p id="section-10.2-2.3.1">Change Controller: IETF<a href="#section-10.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-2.4">
            <p id="section-10.2-2.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-cbor-mappings">
<section id="section-10.3">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings Registry</a>
        </h3>
<p id="section-10.3-1">IANA is asked to add the following entry to the "OAuth Parameters CBOR Mappings" registry, following the procedure specified in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">
            <p id="section-10.3-2.1.1">Name: "edhoc_info"<a href="#section-10.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.2">
            <p id="section-10.3-2.2.1">CBOR Key: TBD<a href="#section-10.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.3">
            <p id="section-10.3-2.3.1">Value Type: map<a href="#section-10.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.4">
            <p id="section-10.3-2.4.1">Reference: [RFC-XXXX]<a href="#section-10.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-json-claims">
<section id="section-10.4">
        <h3 id="name-json-web-token-claims-regis">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-json-web-token-claims-regis" class="section-name selfRef">JSON Web Token Claims Registry</a>
        </h3>
<p id="section-10.4-1">IANA is asked to add the following entries to the "JSON Web Token Claims" registry, following the procedure specified in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.4-2.1">
            <p id="section-10.4-2.1.1">Claim Name: "edhoc_info"<a href="#section-10.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.2">
            <p id="section-10.4-2.2.1">Claim Description: Information for EDHOC session<a href="#section-10.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.3">
            <p id="section-10.4-2.3.1">Change Controller: IETF<a href="#section-10.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.4">
            <p id="section-10.4-2.4.1">Reference: [RFC-XXXX]<a href="#section-10.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cwt-claims">
<section id="section-10.5">
        <h3 id="name-cbor-web-token-cwt-claims-r">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-cbor-web-token-cwt-claims-r" class="section-name selfRef">CBOR Web Token (CWT) Claims Registry</a>
        </h3>
<p id="section-10.5-1">IANA is asked to add the following entries to the "CBOR Web Token (CWT) Claims" registry, following the procedure specified in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.5-2.1">
            <p id="section-10.5-2.1.1">Claim Name: "edhoc_info"<a href="#section-10.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.2">
            <p id="section-10.5-2.2.1">Claim Description: Information for EDHOC session<a href="#section-10.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.3">
            <p id="section-10.5-2.3.1">JWT Claim Name: "edhoc_info"<a href="#section-10.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.4">
            <p id="section-10.5-2.4.1">Claim Key: TBD<a href="#section-10.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.5">
            <p id="section-10.5-2.5.1">Claim Value Type: map<a href="#section-10.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.6">
            <p id="section-10.5-2.6.1">Change Controller: IETF<a href="#section-10.5-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.7">
            <p id="section-10.5-2.7.1">Reference: [RFC-XXXX]<a href="#section-10.5-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-jwt-confirmation-methods">
<section id="section-10.6">
        <h3 id="name-jwt-confirmation-methods-re">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-jwt-confirmation-methods-re" class="section-name selfRef">JWT Confirmation Methods Registry</a>
        </h3>
<p id="section-10.6-1">IANA is asked to add the following entries to the "JWT Confirmation Methods" registry, following the procedure specified in <span>[<a href="#RFC7800" class="cite xref">RFC7800</a>]</span>.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.6-2.1">
            <p id="section-10.6-2.1.1">Confirmation Method Value: "x5c"<a href="#section-10.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-2.2">
            <p id="section-10.6-2.2.1">Confirmation Method Description: An ordered chain of X.509 certificates<a href="#section-10.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-2.3">
            <p id="section-10.6-2.3.1">Change Controller: IETF<a href="#section-10.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-2.4">
            <p id="section-10.6-2.4.1">Reference: <a href="#ssec-jwt-conf-x5c" class="auto internal xref">Section 7.1</a> of [RFC-XXXX]<a href="#section-10.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-3"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-4.1">
            <p id="section-10.6-4.1.1">Confirmation Method Value: "x5b"<a href="#section-10.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-4.2">
            <p id="section-10.6-4.2.1">Confirmation Method Description: An unordered bag of X.509 certificates<a href="#section-10.6-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-4.3">
            <p id="section-10.6-4.3.1">Change Controller: IETF<a href="#section-10.6-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-4.4">
            <p id="section-10.6-4.4.1">Reference: <a href="#ssec-jwt-conf-x5b" class="auto internal xref">Section 7.2</a> of [RFC-XXXX]<a href="#section-10.6-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-5"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-6.1">
            <p id="section-10.6-6.1.1">Confirmation Method Value: "x5t"<a href="#section-10.6-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-6.2">
            <p id="section-10.6-6.2.1">Confirmation Method Description: Hash of an X.509 certificate<a href="#section-10.6-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-6.3">
            <p id="section-10.6-6.3.1">Change Controller: IETF<a href="#section-10.6-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-6.4">
            <p id="section-10.6-6.4.1">Reference: <a href="#ssec-jwt-conf-x5t" class="auto internal xref">Section 7.3</a> of [RFC-XXXX]<a href="#section-10.6-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-7"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-8.1">
            <p id="section-10.6-8.1.1">Confirmation Method Value: "x5u"<a href="#section-10.6-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-8.2">
            <p id="section-10.6-8.2.1">Confirmation Method Description: URI pointing to an ordered chain of X.509 certificates<a href="#section-10.6-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-8.3">
            <p id="section-10.6-8.3.1">Change Controller: IETF<a href="#section-10.6-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-8.4">
            <p id="section-10.6-8.4.1">Reference: <a href="#ssec-jwt-conf-x5u" class="auto internal xref">Section 7.4</a> of [RFC-XXXX]<a href="#section-10.6-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-9"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-10.1">
            <p id="section-10.6-10.1.1">Confirmation Method Value: "c5c"<a href="#section-10.6-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-10.2">
            <p id="section-10.6-10.2.1">Confirmation Method Description: An ordered chain of C509 certificates<a href="#section-10.6-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-10.3">
            <p id="section-10.6-10.3.1">Change Controller: IETF<a href="#section-10.6-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-10.4">
            <p id="section-10.6-10.4.1">Reference: <a href="#ssec-jwt-conf-c5c" class="auto internal xref">Section 7.5</a> of [RFC-XXXX]<a href="#section-10.6-10.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-11"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-12.1">
            <p id="section-10.6-12.1.1">Confirmation Method Value: "c5b"<a href="#section-10.6-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-12.2">
            <p id="section-10.6-12.2.1">Confirmation Method Description: An unordered bag of C509 certificates<a href="#section-10.6-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-12.3">
            <p id="section-10.6-12.3.1">Change Controller: IETF<a href="#section-10.6-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-12.4">
            <p id="section-10.6-12.4.1">Reference: <a href="#ssec-jwt-conf-c5b" class="auto internal xref">Section 7.6</a> of [RFC-XXXX]<a href="#section-10.6-12.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-13"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-14.1">
            <p id="section-10.6-14.1.1">Confirmation Method Value: "c5t"<a href="#section-10.6-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-14.2">
            <p id="section-10.6-14.2.1">Confirmation Method Description: Hash of a C509 certificate<a href="#section-10.6-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-14.3">
            <p id="section-10.6-14.3.1">Change Controller: IETF<a href="#section-10.6-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-14.4">
            <p id="section-10.6-14.4.1">Reference: <a href="#ssec-jwt-conf-c5t" class="auto internal xref">Section 7.7</a> of [RFC-XXXX]<a href="#section-10.6-14.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-15"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-16.1">
            <p id="section-10.6-16.1.1">Confirmation Method Value: "c5u"<a href="#section-10.6-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-16.2">
            <p id="section-10.6-16.2.1">Confirmation Method Description: URI pointing to a COSE_C509 containing an ordered chain of C509 certificates<a href="#section-10.6-16.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-16.3">
            <p id="section-10.6-16.3.1">Change Controller: IETF<a href="#section-10.6-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-16.4">
            <p id="section-10.6-16.4.1">Reference: <a href="#ssec-jwt-conf-c5u" class="auto internal xref">Section 7.8</a> of [RFC-XXXX]<a href="#section-10.6-16.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-17"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-18.1">
            <p id="section-10.6-18.1.1">Confirmation Method Value: "kcwt"<a href="#section-10.6-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-18.2">
            <p id="section-10.6-18.2.1">Confirmation Method Description: A CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-10.6-18.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-18.3">
            <p id="section-10.6-18.3.1">Change Controller: IETF<a href="#section-10.6-18.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-18.4">
            <p id="section-10.6-18.4.1">Reference: <a href="#ssec-jwt-conf-kcwt" class="auto internal xref">Section 7.9</a> of [RFC-XXXX]<a href="#section-10.6-18.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-19"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-20.1">
            <p id="section-10.6-20.1.1">Confirmation Method Value: "kccs"<a href="#section-10.6-20.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-20.2">
            <p id="section-10.6-20.2.1">Confirmation Method Description: A CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-10.6-20.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-20.3">
            <p id="section-10.6-20.3.1">Change Controller: IETF<a href="#section-10.6-20.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-20.4">
            <p id="section-10.6-20.4.1">Reference: <a href="#ssec-jwt-conf-kccs" class="auto internal xref">Section 7.10</a> of [RFC-XXXX]<a href="#section-10.6-20.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-cwt-confirmation-methods">
<section id="section-10.7">
        <h3 id="name-cwt-confirmation-methods-re">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-cwt-confirmation-methods-re" class="section-name selfRef">CWT Confirmation Methods Registry</a>
        </h3>
<p id="section-10.7-1">IANA is asked to add the following entries to the "CWT Confirmation Methods" registry, following the procedure specified in <span>[<a href="#RFC8747" class="cite xref">RFC8747</a>]</span>.<a href="#section-10.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.7-2.1">
            <p id="section-10.7-2.1.1">Confirmation Method Name: x5chain<a href="#section-10.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.2">
            <p id="section-10.7-2.2.1">Confirmation Method Description: An ordered chain of X.509 certificates<a href="#section-10.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.3">
            <p id="section-10.7-2.3.1">JWT Confirmation Method Name: "x5c"<a href="#section-10.7-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.4">
            <p id="section-10.7-2.4.1">Confirmation Key: TBD<a href="#section-10.7-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.5">
            <p id="section-10.7-2.5.1">Confirmation Value Type: COSE_X509<a href="#section-10.7-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.6">
            <p id="section-10.7-2.6.1">Change Controller: IETF<a href="#section-10.7-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.7">
            <p id="section-10.7-2.7.1">Reference: <a href="#ssec-cwt-conf-x5chain" class="auto internal xref">Section 6.1</a> of [RFC-XXXX]<a href="#section-10.7-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-3"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-4.1">
            <p id="section-10.7-4.1.1">Confirmation Method Name: x5bag<a href="#section-10.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-4.2">
            <p id="section-10.7-4.2.1">Confirmation Method Description: An unordered bag of X.509 certificates<a href="#section-10.7-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-4.3">
            <p id="section-10.7-4.3.1">JWT Confirmation Method Name: "x5b"<a href="#section-10.7-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-4.4">
            <p id="section-10.7-4.4.1">Confirmation Key: TBD<a href="#section-10.7-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-4.5">
            <p id="section-10.7-4.5.1">Confirmation Value Type: COSE_X509<a href="#section-10.7-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-4.6">
            <p id="section-10.7-4.6.1">Change Controller: IETF<a href="#section-10.7-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-4.7">
            <p id="section-10.7-4.7.1">Reference: <a href="#ssec-cwt-conf-x5bag" class="auto internal xref">Section 6.2</a> of [RFC-XXXX]<a href="#section-10.7-4.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-5"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-6.1">
            <p id="section-10.7-6.1.1">Confirmation Method Name: x5t<a href="#section-10.7-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-6.2">
            <p id="section-10.7-6.2.1">Confirmation Method Description: Hash of an X.509 certificate<a href="#section-10.7-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-6.3">
            <p id="section-10.7-6.3.1">JWT Confirmation Method Name: "x5t"<a href="#section-10.7-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-6.4">
            <p id="section-10.7-6.4.1">Confirmation Key: TBD<a href="#section-10.7-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-6.5">
            <p id="section-10.7-6.5.1">Confirmation Value Type: COSE_CertHash<a href="#section-10.7-6.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-6.6">
            <p id="section-10.7-6.6.1">Change Controller: IETF<a href="#section-10.7-6.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-6.7">
            <p id="section-10.7-6.7.1">Reference: <a href="#ssec-cwt-conf-x5t" class="auto internal xref">Section 6.3</a> of [RFC-XXXX]<a href="#section-10.7-6.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-7"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-8.1">
            <p id="section-10.7-8.1.1">Confirmation Method Name: x5u<a href="#section-10.7-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-8.2">
            <p id="section-10.7-8.2.1">Confirmation Method Description: URI pointing to an ordered chain of X.509 certificates<a href="#section-10.7-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-8.3">
            <p id="section-10.7-8.3.1">JWT Confirmation Method Name: "x5u"<a href="#section-10.7-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-8.4">
            <p id="section-10.7-8.4.1">Confirmation Key: TBD<a href="#section-10.7-8.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-8.5">
            <p id="section-10.7-8.5.1">Confirmation Value Type: uri<a href="#section-10.7-8.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-8.6">
            <p id="section-10.7-8.6.1">Change Controller: IETF<a href="#section-10.7-8.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-8.7">
            <p id="section-10.7-8.7.1">Reference: <a href="#ssec-cwt-conf-x5u" class="auto internal xref">Section 6.4</a> of [RFC-XXXX]<a href="#section-10.7-8.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-9"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-10.1">
            <p id="section-10.7-10.1.1">Confirmation Method Name: c5c<a href="#section-10.7-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-10.2">
            <p id="section-10.7-10.2.1">Confirmation Method Description: An ordered chain of C509 certificates<a href="#section-10.7-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-10.3">
            <p id="section-10.7-10.3.1">JWT Confirmation Method Name: "c5c"<a href="#section-10.7-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-10.4">
            <p id="section-10.7-10.4.1">Confirmation Key: TBD<a href="#section-10.7-10.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-10.5">
            <p id="section-10.7-10.5.1">Confirmation Value Type: COSE_C509<a href="#section-10.7-10.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-10.6">
            <p id="section-10.7-10.6.1">Change Controller: IETF<a href="#section-10.7-10.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-10.7">
            <p id="section-10.7-10.7.1">Reference: <a href="#ssec-cwt-conf-c5c" class="auto internal xref">Section 6.5</a> of [RFC-XXXX]<a href="#section-10.7-10.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-11"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-12.1">
            <p id="section-10.7-12.1.1">Confirmation Method Name: c5b<a href="#section-10.7-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-12.2">
            <p id="section-10.7-12.2.1">Confirmation Method Description: An unordered bag of C509 certificates<a href="#section-10.7-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-12.3">
            <p id="section-10.7-12.3.1">JWT Confirmation Method Name: "c5b"<a href="#section-10.7-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-12.4">
            <p id="section-10.7-12.4.1">Confirmation Key: TBD<a href="#section-10.7-12.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-12.5">
            <p id="section-10.7-12.5.1">Confirmation Value Type: COSE_C509<a href="#section-10.7-12.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-12.6">
            <p id="section-10.7-12.6.1">Change Controller: IETF<a href="#section-10.7-12.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-12.7">
            <p id="section-10.7-12.7.1">Reference: <a href="#ssec-cwt-conf-c5b" class="auto internal xref">Section 6.6</a> of [RFC-XXXX]<a href="#section-10.7-12.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-13"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-14.1">
            <p id="section-10.7-14.1.1">Confirmation Method Name: c5t<a href="#section-10.7-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-14.2">
            <p id="section-10.7-14.2.1">Confirmation Method Description: Hash of a C509 certificate<a href="#section-10.7-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-14.3">
            <p id="section-10.7-14.3.1">JWT Confirmation Method Name: "c5t"<a href="#section-10.7-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-14.4">
            <p id="section-10.7-14.4.1">Confirmation Key: TBD<a href="#section-10.7-14.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-14.5">
            <p id="section-10.7-14.5.1">Confirmation Value Type: COSE_CertHash<a href="#section-10.7-14.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-14.6">
            <p id="section-10.7-14.6.1">Change Controller: IETF<a href="#section-10.7-14.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-14.7">
            <p id="section-10.7-14.7.1">Reference: <a href="#ssec-cwt-conf-c5t" class="auto internal xref">Section 6.7</a> of [RFC-XXXX]<a href="#section-10.7-14.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-15"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-16.1">
            <p id="section-10.7-16.1.1">Confirmation Method Name: c5u<a href="#section-10.7-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-16.2">
            <p id="section-10.7-16.2.1">Confirmation Method Description: URI pointing to a COSE_C509 containing an ordered chain of C509 certificates<a href="#section-10.7-16.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-16.3">
            <p id="section-10.7-16.3.1">JWT Confirmation Method Name: "c5u"<a href="#section-10.7-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-16.4">
            <p id="section-10.7-16.4.1">Confirmation Key: TBD<a href="#section-10.7-16.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-16.5">
            <p id="section-10.7-16.5.1">Confirmation Value Type: uri<a href="#section-10.7-16.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-16.6">
            <p id="section-10.7-16.6.1">Change Controller: IETF<a href="#section-10.7-16.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-16.7">
            <p id="section-10.7-16.7.1">Reference: <a href="#ssec-cwt-conf-c5u" class="auto internal xref">Section 6.8</a> of [RFC-XXXX]<a href="#section-10.7-16.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-17"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-18.1">
            <p id="section-10.7-18.1.1">Confirmation Method Name: kcwt<a href="#section-10.7-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-18.2">
            <p id="section-10.7-18.2.1">Confirmation Method Description: A CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-10.7-18.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-18.3">
            <p id="section-10.7-18.3.1">JWT Confirmation Method Name: "kcwt"<a href="#section-10.7-18.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-18.4">
            <p id="section-10.7-18.4.1">Confirmation Key: TBD<a href="#section-10.7-18.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-18.5">
            <p id="section-10.7-18.5.1">Confirmation Value Type: COSE_Messages<a href="#section-10.7-18.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-18.6">
            <p id="section-10.7-18.6.1">Change Controller: IETF<a href="#section-10.7-18.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-18.7">
            <p id="section-10.7-18.7.1">Reference: <a href="#ssec-cwt-conf-kcwt" class="auto internal xref">Section 6.9</a> of [RFC-XXXX]<a href="#section-10.7-18.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.7-19"><br></p>
<ul class="normal">
<li class="normal" id="section-10.7-20.1">
            <p id="section-10.7-20.1.1">Confirmation Method Name: kccs<a href="#section-10.7-20.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-20.2">
            <p id="section-10.7-20.2.1">Confirmation Method Description: A CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim and possibly other claims<a href="#section-10.7-20.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-20.3">
            <p id="section-10.7-20.3.1">JWT Confirmation Method Name: "kccs"<a href="#section-10.7-20.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-20.4">
            <p id="section-10.7-20.4.1">Confirmation Key: TBD<a href="#section-10.7-20.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-20.5">
            <p id="section-10.7-20.5.1">Confirmation Value Type: map / #6(map)<a href="#section-10.7-20.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-20.6">
            <p id="section-10.7-20.6.1">Change Controller: IETF<a href="#section-10.7-20.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-20.7">
            <p id="section-10.7-20.7.1">Reference: <a href="#ssec-cwt-conf-kccs" class="auto internal xref">Section 6.10</a> of [RFC-XXXX]<a href="#section-10.7-20.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-edhoc-ead">
<section id="section-10.8">
        <h3 id="name-edhoc-external-authorizatio">
<a href="#section-10.8" class="section-number selfRef">10.8. </a><a href="#name-edhoc-external-authorizatio" class="section-name selfRef">EDHOC External Authorization Data Registry</a>
        </h3>
<p id="section-10.8-1">IANA is asked to add the following entry to the "EDHOC External Authorization Data" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.5" class="relref">Section 10.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-10.8-1" class="pilcrow">¶</a></p>
<p id="section-10.8-2">The ead_label = TBD and the ead_value define an access token transferred in an EAD item of EDHOC message_3, with processing specified in <a href="#AT-in-EAD" class="auto internal xref">Section 4.3</a>.<a href="#section-10.8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.8-3.1">
            <p id="section-10.8-3.1.1">Name: ACE-OAuth Access Token<a href="#section-10.8-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-3.2">
            <p id="section-10.8-3.2.1">Label: TBD<a href="#section-10.8-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-3.3">
            <p id="section-10.8-3.3.1">Description: An Access Token as used in the ACE-OAuth framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span><a href="#section-10.8-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-3.4">
            <p id="section-10.8-3.4.1">Reference: [RFC-XXXX]<a href="#section-10.8-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-edhoc-parameters">
<section id="section-10.9">
        <h3 id="name-edhoc-information-registry">
<a href="#section-10.9" class="section-number selfRef">10.9. </a><a href="#name-edhoc-information-registry" class="section-name selfRef">EDHOC Information Registry</a>
        </h3>
<p id="section-10.9-1">IANA is requested to create a new "EDHOC Information" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-10.9-1" class="pilcrow">¶</a></p>
<p id="section-10.9-2">As registration policy, the registry uses either "Standards Action with Expert Review", or "Specification Required" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, or "Expert Review" per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Expert Review guidelines are provided in <a href="#iana-expert-review" class="auto internal xref">Section 10.10</a>.<a href="#section-10.9-2" class="pilcrow">¶</a></p>
<p id="section-10.9-3">All assignments according to "Standards Action with Expert Review" are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, with Expert Review additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of Standards Track code points defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also applies. When such a procedure is used, review and approval by the designated expert are also required, in order for the WG chairs to determine that the conditions for early allocation are met (see step 2 in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>).<a href="#section-10.9-3" class="pilcrow">¶</a></p>
<p id="section-10.9-4">The columns of the registry are:<a href="#section-10.9-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.9-5.1">
            <p id="section-10.9-5.1.1">Name: A descriptive name that enables easier reference to this item. Because a core goal of this document is for the resulting representations to be compact, it is <span class="bcp14">RECOMMENDED</span> that the name be short.<a href="#section-10.9-5.1.1" class="pilcrow">¶</a></p>
<p id="section-10.9-5.1.2">
This name is case sensitive. Names may not match other registered names in a case-insensitive manner unless the Designated Experts determine that there is a compelling reason to allow an exception. The name is not used in the CBOR encoding.<a href="#section-10.9-5.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.9-5.2">
            <p id="section-10.9-5.2.1">CBOR label: The value to be used as CBOR abbreviation of the item.<a href="#section-10.9-5.2.1" class="pilcrow">¶</a></p>
<p id="section-10.9-5.2.2">
The value <span class="bcp14">MUST</span> be unique. The value can be a positive integer, a negative integer or a string. Integer values between -256 and 255 and strings of length 1 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 and strings of maximum length 2 are designated as "Specification Required". Integer values greater than 65535 and strings of length greater than 2 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-10.9-5.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.9-5.3">
            <p id="section-10.9-5.3.1">CBOR type: The CBOR type of the item, or a pointer to the registry that defines its type, when that depends on another item.<a href="#section-10.9-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.9-5.4">
            <p id="section-10.9-5.4.1">Registry: The registry that values of the item may come from, if one exists.<a href="#section-10.9-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.9-5.5">
            <p id="section-10.9-5.5.1">Description: A brief description of this item.<a href="#section-10.9-5.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.9-5.6">
            <p id="section-10.9-5.6.1">Specification: A pointer to the public specification for the item, if one exists.<a href="#section-10.9-5.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.9-6">This registry will be initially populated by the values in <a href="#_table-cbor-key-edhoc-params" class="auto internal xref">Table 1</a>. In the "Specification" column, the value for all of these entries will be [RFC-XXXX] and <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-10.9-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-expert-review">
<section id="section-10.10">
        <h3 id="name-expert-review-instructions">
<a href="#section-10.10" class="section-number selfRef">10.10. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-10.10-1">The IANA registry established in this document is defined as "Standards Action with Expert Review", "Specification Required", or "Expert Review", depending on the range of values for which an assignment is requested. This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-10.10-1" class="pilcrow">¶</a></p>
<p id="section-10.10-2">Expert reviewers should take into consideration the following points:<a href="#section-10.10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.10-3.1">
            <p id="section-10.10-3.1.1">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as private use are intended for testing purposes and closed environments; code points in other ranges should not be assigned for testing.<a href="#section-10.10-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.10-3.2">
            <p id="section-10.10-3.2.1">Specifications are required for the Standards Action range of point assignment. Specifications should exist for Specification Required ranges, but early assignment before a specification is available is considered to be permissible. Specifications are needed for the first-come, first-serve range if they are expected to be used outside of closed environments in an interoperable way. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-10.10-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.10-3.3">
            <p id="section-10.10-3.3.1">Experts should take into account the expected usage of fields when approving point assignment. The fact that there is a range for Standards Track documents does not mean that a Standards Track document cannot have points assigned outside of that range. The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-10.10-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-workflow-and-params">[I-D.ietf-ace-workflow-and-params]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Alternative Workflow and OAuth Parameters for the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-workflow-and-params-01</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-workflow-and-params-01">https://datatracker.ietf.org/doc/html/draft-ietf-ace-workflow-and-params-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-edhoc">[I-D.ietf-core-oscore-edhoc]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, <span class="refAuthor">Hristozov, S.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Using Ephemeral Diffie-Hellman Over COSE (EDHOC) with the Constrained Application Protocol (CoAP) and Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-edhoc-11</span>, <time datetime="2024-04-09" class="refDate">9 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-edhoc-11">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-edhoc-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-09</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-09">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7120">[RFC7120]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refTitle">"Early IANA Allocation of Standards Track Code Points"</span>, <span class="seriesInfo">BCP 100</span>, <span class="seriesInfo">RFC 7120</span>, <span class="seriesInfo">DOI 10.17487/RFC7120</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7120">https://www.rfc-editor.org/rfc/rfc7120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8742">https://www.rfc-editor.org/rfc/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9200">https://www.rfc-editor.org/rfc/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9201">[RFC9201]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9201</span>, <span class="seriesInfo">DOI 10.17487/RFC9201</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9201">https://www.rfc-editor.org/rfc/rfc9201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9203">https://www.rfc-editor.org/rfc/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9360">[RFC9360]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9360">https://www.rfc-editor.org/rfc/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-coap-est-oscore">[I-D.ietf-ace-coap-est-oscore]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Furuhed, M.</span>, <span class="refAuthor">Vučinić, M.</span>, and <span class="refAuthor">T. Claeys</span>, <span class="refTitle">"Protecting EST Payloads with OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-coap-est-oscore-04</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-coap-est-oscore-04">https://datatracker.ietf.org/doc/html/draft-ietf-ace-coap-est-oscore-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-key-update">[I-D.ietf-core-oscore-key-update]</dt>
        <dd>
<span class="refAuthor">Höglund, R.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Update for OSCORE (KUDOS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-key-update-07</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-07">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lake-authz">[I-D.ietf-lake-authz]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Vučinić, M.</span>, <span class="refAuthor">Fedrecheski, G.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Lightweight Authorization using Ephemeral Diffie-Hellman Over COSE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-authz-01</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-authz-01">https://datatracker.ietf.org/doc/html/draft-ietf-lake-authz-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">This appendix provides examples where this profile of ACE is used. In particular:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1"><a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a> does not make use of use of any optimization.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1"><a href="#example-with-optimization" class="auto internal xref">Appendix A.2</a> makes use of the optimizations defined in this specification, hence reducing the roundtrips of the interactions between the Client and the Resource Server.<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-3">All these examples build on the following assumptions, as relying on expected early procedures performed at AS. These include the registration of RSs by the respective Resource Owners as well as the registrations of Clients authorized to request access token for those RSs.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-4.1">
          <p id="appendix-A-4.1.1">AS knows the authentication credential AUTH_CRED_C of the Client C.<a href="#appendix-A-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.2">
          <p id="appendix-A-4.2.1">The Client knows the authentication credential AUTH_CRED_AS of AS.<a href="#appendix-A-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.3">
          <p id="appendix-A-4.3.1">AS knows the authentication credential AUTH_CRED_RS of RS.<a href="#appendix-A-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.4">
          <p id="appendix-A-4.4.1">RS knows the authentication credential AUTH_CRED_AS of AS.<a href="#appendix-A-4.4.1" class="pilcrow">¶</a></p>
<p id="appendix-A-4.4.2">
This is relevant in case AS and RS actually require a secure association (e.g., for RS to perform token introspection at AS, or for AS to upload an access token to RS on behalf of the Client).<a href="#appendix-A-4.4.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-5">As a result of the assumptions above, it is possible to limit the transport of AUTH_CRED_C and AUTH_CRED_RS by value only to the following two cases, and only when the Client requests an access token for RS in question for the first time when considering the pair (AUTH_CRED_C, AUTH_CRED_RS).<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-6.1">
          <p id="appendix-A-6.1.1">In the Token Response from AS to the Client, where AUTH_CRED_RS is specified by the 'rs_cnf' parameter.<a href="#appendix-A-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.2">
          <p id="appendix-A-6.2.1">In the access token, where AUTH_CRED_C is specified by the 'cnf' claim.<a href="#appendix-A-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-7">Note that, even under the circumstances mentioned above, AUTH_CRED_C might rather be indicated by reference. This is possible if RS can effectively use such a reference from the access token to retrieve AUTH_CRED_C (e.g., from a trusted repository of authentication credentials reachable through a non-constrained link), and if AS is in turn aware of that.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<p id="appendix-A-8">In any other case, it is otherwise possible to indicate both AUTH_CRED_C and AUTH_CRED_RS by reference, when performing the ACE access control workflow as well as later on when the Client and RS run EDHOC.<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<div id="example-without-optimization">
<section id="appendix-A.1">
        <h3 id="name-workflow-without-optimizati">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-workflow-without-optimizati" class="section-name selfRef">Workflow without Optimizations</a>
        </h3>
<p id="appendix-A.1-1">The example below considers the simplest (though least efficient) interaction between the Client and RS. That is: first C uploads the access token to RS; then C and RS run EDHOC; and, finally, the Client accesses the protected resource at RS.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div id="appendix-A.1-2">
          <div class="alignLeft art-svg artwork" id="appendix-A.1-2.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="3216" width="576" viewBox="0 0 576 3216" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 40,48 L 40,816" fill="none" stroke="black"></path>
              <path d="M 40,912 L 40,976" fill="none" stroke="black"></path>
              <path d="M 40,1072 L 40,1616" fill="none" stroke="black"></path>
              <path d="M 40,1792 L 40,1808" fill="none" stroke="black"></path>
              <path d="M 40,1872 L 40,1888" fill="none" stroke="black"></path>
              <path d="M 40,2032 L 40,3200" fill="none" stroke="black"></path>
              <path d="M 320,48 L 320,816" fill="none" stroke="black"></path>
              <path d="M 320,912 L 320,952" fill="none" stroke="black"></path>
              <path d="M 320,1072 L 320,1112" fill="none" stroke="black"></path>
              <path d="M 320,1128 L 320,1192" fill="none" stroke="black"></path>
              <path d="M 320,1208 L 320,1256" fill="none" stroke="black"></path>
              <path d="M 320,1272 L 320,1384" fill="none" stroke="black"></path>
              <path d="M 320,1400 L 320,1528" fill="none" stroke="black"></path>
              <path d="M 320,1544 L 320,1592" fill="none" stroke="black"></path>
              <path d="M 320,1792 L 320,1808" fill="none" stroke="black"></path>
              <path d="M 320,1872 L 320,1888" fill="none" stroke="black"></path>
              <path d="M 320,2032 L 320,2584" fill="none" stroke="black"></path>
              <path d="M 320,2600 L 320,2664" fill="none" stroke="black"></path>
              <path d="M 320,2680 L 320,2744" fill="none" stroke="black"></path>
              <path d="M 320,2760 L 320,2824" fill="none" stroke="black"></path>
              <path d="M 320,2840 L 320,2952" fill="none" stroke="black"></path>
              <path d="M 320,2968 L 320,3096" fill="none" stroke="black"></path>
              <path d="M 320,3112 L 320,3176" fill="none" stroke="black"></path>
              <path d="M 568,48 L 568,816" fill="none" stroke="black"></path>
              <path d="M 568,912 L 568,976" fill="none" stroke="black"></path>
              <path d="M 568,1072 L 568,1616" fill="none" stroke="black"></path>
              <path d="M 568,1792 L 568,1808" fill="none" stroke="black"></path>
              <path d="M 568,1872 L 568,1888" fill="none" stroke="black"></path>
              <path d="M 568,2032 L 568,3200" fill="none" stroke="black"></path>
              <path d="M 48,80 L 312,80" fill="none" stroke="black"></path>
              <path d="M 48,144 L 312,144" fill="none" stroke="black"></path>
              <path d="M 48,256 L 312,256" fill="none" stroke="black"></path>
              <path d="M 48,384 L 312,384" fill="none" stroke="black"></path>
              <path d="M 48,496 L 312,496" fill="none" stroke="black"></path>
              <path d="M 48,960 L 560,960" fill="none" stroke="black"></path>
              <path d="M 48,1120 L 560,1120" fill="none" stroke="black"></path>
              <path d="M 48,1200 L 560,1200" fill="none" stroke="black"></path>
              <path d="M 48,1264 L 560,1264" fill="none" stroke="black"></path>
              <path d="M 48,1392 L 560,1392" fill="none" stroke="black"></path>
              <path d="M 48,1536 L 560,1536" fill="none" stroke="black"></path>
              <path d="M 48,1600 L 560,1600" fill="none" stroke="black"></path>
              <path d="M 48,2080 L 312,2080" fill="none" stroke="black"></path>
              <path d="M 48,2208 L 312,2208" fill="none" stroke="black"></path>
              <path d="M 48,2592 L 560,2592" fill="none" stroke="black"></path>
              <path d="M 48,2672 L 560,2672" fill="none" stroke="black"></path>
              <path d="M 48,2752 L 560,2752" fill="none" stroke="black"></path>
              <path d="M 48,2832 L 560,2832" fill="none" stroke="black"></path>
              <path d="M 48,2960 L 560,2960" fill="none" stroke="black"></path>
              <path d="M 48,3104 L 560,3104" fill="none" stroke="black"></path>
              <path d="M 48,3184 L 560,3184" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="568,3104 556,3098.4 556,3109.6" fill="black" transform="rotate(0,560,3104)"></polygon>
              <polygon class="arrowhead" points="568,2960 556,2954.4 556,2965.6" fill="black" transform="rotate(0,560,2960)"></polygon>
              <polygon class="arrowhead" points="568,2752 556,2746.4 556,2757.6" fill="black" transform="rotate(0,560,2752)"></polygon>
              <polygon class="arrowhead" points="568,2592 556,2586.4 556,2597.6" fill="black" transform="rotate(0,560,2592)"></polygon>
              <polygon class="arrowhead" points="568,1536 556,1530.4 556,1541.6" fill="black" transform="rotate(0,560,1536)"></polygon>
              <polygon class="arrowhead" points="568,1392 556,1386.4 556,1397.6" fill="black" transform="rotate(0,560,1392)"></polygon>
              <polygon class="arrowhead" points="568,1200 556,1194.4 556,1205.6" fill="black" transform="rotate(0,560,1200)"></polygon>
              <polygon class="arrowhead" points="568,960 556,954.4 556,965.6" fill="black" transform="rotate(0,560,960)"></polygon>
              <polygon class="arrowhead" points="320,2080 308,2074.4 308,2085.6" fill="black" transform="rotate(0,312,2080)"></polygon>
              <polygon class="arrowhead" points="320,384 308,378.4 308,389.6" fill="black" transform="rotate(0,312,384)"></polygon>
              <polygon class="arrowhead" points="320,256 308,250.4 308,261.6" fill="black" transform="rotate(0,312,256)"></polygon>
              <polygon class="arrowhead" points="320,80 308,74.4 308,85.6" fill="black" transform="rotate(0,312,80)"></polygon>
              <polygon class="arrowhead" points="56,3184 44,3178.4 44,3189.6" fill="black" transform="rotate(180,48,3184)"></polygon>
              <polygon class="arrowhead" points="56,2832 44,2826.4 44,2837.6" fill="black" transform="rotate(180,48,2832)"></polygon>
              <polygon class="arrowhead" points="56,2672 44,2666.4 44,2677.6" fill="black" transform="rotate(180,48,2672)"></polygon>
              <polygon class="arrowhead" points="56,2208 44,2202.4 44,2213.6" fill="black" transform="rotate(180,48,2208)"></polygon>
              <polygon class="arrowhead" points="56,1600 44,1594.4 44,1605.6" fill="black" transform="rotate(180,48,1600)"></polygon>
              <polygon class="arrowhead" points="56,1264 44,1258.4 44,1269.6" fill="black" transform="rotate(180,48,1264)"></polygon>
              <polygon class="arrowhead" points="56,1120 44,1114.4 44,1125.6" fill="black" transform="rotate(180,48,1120)"></polygon>
              <polygon class="arrowhead" points="56,496 44,490.4 44,501.6" fill="black" transform="rotate(180,48,496)"></polygon>
              <polygon class="arrowhead" points="56,144 44,138.4 44,149.6" fill="black" transform="rotate(180,48,144)"></polygon>
              <g class="text">
                <text x="40" y="36">C</text>
                <text x="316" y="36">AS</text>
                <text x="564" y="36">RS</text>
                <text x="80" y="68">EDHOC</text>
                <text x="144" y="68">message_1</text>
                <text x="196" y="68">to</text>
                <text x="236" y="68">/edhoc</text>
                <text x="16" y="84">M01</text>
                <text x="80" y="132">EDHOC</text>
                <text x="144" y="132">message_2</text>
                <text x="16" y="148">M02</text>
                <text x="96" y="164">ID_CRED_R</text>
                <text x="180" y="164">identifies</text>
                <text x="108" y="180">CRED_R</text>
                <text x="144" y="180">=</text>
                <text x="204" y="180">AUTH_CRED_AS</text>
                <text x="92" y="196">by</text>
                <text x="144" y="196">reference</text>
                <text x="80" y="244">EDHOC</text>
                <text x="144" y="244">message_3</text>
                <text x="196" y="244">to</text>
                <text x="236" y="244">/edhoc</text>
                <text x="16" y="260">M03</text>
                <text x="96" y="276">ID_CRED_I</text>
                <text x="180" y="276">identifies</text>
                <text x="108" y="292">CRED_I</text>
                <text x="144" y="292">=</text>
                <text x="200" y="292">AUTH_CRED_C</text>
                <text x="92" y="308">by</text>
                <text x="144" y="308">reference</text>
                <text x="80" y="356">Token</text>
                <text x="136" y="356">request</text>
                <text x="180" y="356">to</text>
                <text x="220" y="356">/token</text>
                <text x="128" y="372">(OSCORE-protected</text>
                <text x="236" y="372">message)</text>
                <text x="16" y="388">M04</text>
                <text x="96" y="404">'req_cnf'</text>
                <text x="180" y="404">identifies</text>
                <text x="128" y="420">AUTH_CRED_C</text>
                <text x="188" y="420">by</text>
                <text x="240" y="420">reference</text>
                <text x="80" y="468">Token</text>
                <text x="140" y="468">response</text>
                <text x="128" y="484">(OSCORE-protected</text>
                <text x="236" y="484">message)</text>
                <text x="16" y="500">M05</text>
                <text x="92" y="516">'rs_cnf'</text>
                <text x="168" y="516">specifies</text>
                <text x="132" y="532">AUTH_CRED_RS</text>
                <text x="196" y="532">by</text>
                <text x="232" y="532">value</text>
                <text x="112" y="564">'ace_profile'</text>
                <text x="208" y="564">specifies</text>
                <text x="264" y="564">the</text>
                <text x="72" y="580">ACE</text>
                <text x="120" y="580">profile</text>
                <text x="232" y="580">"coap_edhoc_oscore"</text>
                <text x="108" y="612">'edhoc_info'</text>
                <text x="204" y="612">specifies:</text>
                <text x="88" y="628">{</text>
                <text x="152" y="644">e'session_id'</text>
                <text x="216" y="644">:</text>
                <text x="252" y="644">h'01',</text>
                <text x="164" y="660">e'cipher_suites'</text>
                <text x="240" y="660">:</text>
                <text x="260" y="660">2,</text>
                <text x="140" y="676">e'methods'</text>
                <text x="192" y="676">:</text>
                <text x="208" y="676">3</text>
                <text x="88" y="692">}</text>
                <text x="68" y="724">In</text>
                <text x="96" y="724">the</text>
                <text x="140" y="724">access</text>
                <text x="196" y="724">token:</text>
                <text x="64" y="740">-</text>
                <text x="88" y="740">the</text>
                <text x="128" y="740">'cnf'</text>
                <text x="176" y="740">claim</text>
                <text x="240" y="740">specifies</text>
                <text x="120" y="756">AUTH_CRED_C</text>
                <text x="180" y="756">by</text>
                <text x="216" y="756">value</text>
                <text x="64" y="772">-</text>
                <text x="88" y="772">the</text>
                <text x="156" y="772">'edhoc_info'</text>
                <text x="232" y="772">claim</text>
                <text x="112" y="788">specifies</text>
                <text x="168" y="788">the</text>
                <text x="204" y="788">same</text>
                <text x="236" y="788">as</text>
                <text x="124" y="804">'edhoc_info'</text>
                <text x="200" y="804">above</text>
                <text x="76" y="852">Possibly</text>
                <text x="136" y="852">after</text>
                <text x="184" y="852">chain</text>
                <text x="264" y="852">verification,</text>
                <text x="336" y="852">the</text>
                <text x="380" y="852">Client</text>
                <text x="428" y="852">adds</text>
                <text x="500" y="852">AUTH_CRED_RS</text>
                <text x="52" y="868">to</text>
                <text x="80" y="868">the</text>
                <text x="112" y="868">set</text>
                <text x="140" y="868">of</text>
                <text x="168" y="868">its</text>
                <text x="216" y="868">trusted</text>
                <text x="268" y="868">peer</text>
                <text x="348" y="868">authentication</text>
                <text x="460" y="868">credentials,</text>
                <text x="72" y="884">relying</text>
                <text x="116" y="884">on</text>
                <text x="140" y="884">AS</text>
                <text x="164" y="884">as</text>
                <text x="208" y="884">trusted</text>
                <text x="280" y="884">provider/</text>
                <text x="80" y="932">Token</text>
                <text x="132" y="932">upload</text>
                <text x="172" y="932">to</text>
                <text x="232" y="932">/authz-info</text>
                <text x="108" y="948">(unprotected</text>
                <text x="196" y="948">message)</text>
                <text x="16" y="964">M06</text>
                <text x="320" y="980">|</text>
                <text x="76" y="1012">Possibly</text>
                <text x="136" y="1012">after</text>
                <text x="184" y="1012">chain</text>
                <text x="264" y="1012">verification,</text>
                <text x="332" y="1012">RS</text>
                <text x="364" y="1012">adds</text>
                <text x="432" y="1012">AUTH_CRED_C</text>
                <text x="52" y="1028">to</text>
                <text x="80" y="1028">the</text>
                <text x="112" y="1028">set</text>
                <text x="140" y="1028">of</text>
                <text x="168" y="1028">its</text>
                <text x="216" y="1028">trusted</text>
                <text x="268" y="1028">peer</text>
                <text x="348" y="1028">authentication</text>
                <text x="460" y="1028">credentials,</text>
                <text x="72" y="1044">relying</text>
                <text x="116" y="1044">on</text>
                <text x="140" y="1044">AS</text>
                <text x="164" y="1044">as</text>
                <text x="208" y="1044">trusted</text>
                <text x="280" y="1044">provider/</text>
                <text x="84" y="1092">2.01</text>
                <text x="144" y="1092">(Created)</text>
                <text x="116" y="1108">(unprotected</text>
                <text x="204" y="1108">message)</text>
                <text x="16" y="1124">M07</text>
                <text x="80" y="1172">EDHOC</text>
                <text x="144" y="1172">message_1</text>
                <text x="196" y="1172">to</text>
                <text x="236" y="1172">/edhoc</text>
                <text x="72" y="1188">(no</text>
                <text x="116" y="1188">access</text>
                <text x="176" y="1188">control</text>
                <text x="220" y="1188">is</text>
                <text x="272" y="1188">enforced)</text>
                <text x="16" y="1204">M08</text>
                <text x="80" y="1252">EDHOC</text>
                <text x="144" y="1252">message_2</text>
                <text x="16" y="1268">M09</text>
                <text x="96" y="1284">ID_CRED_R</text>
                <text x="180" y="1284">identifies</text>
                <text x="108" y="1300">CRED_R</text>
                <text x="144" y="1300">=</text>
                <text x="204" y="1300">AUTH_CRED_RS</text>
                <text x="92" y="1316">by</text>
                <text x="144" y="1316">reference</text>
                <text x="80" y="1364">EDHOC</text>
                <text x="144" y="1364">message_3</text>
                <text x="196" y="1364">to</text>
                <text x="236" y="1364">/edhoc</text>
                <text x="72" y="1380">(no</text>
                <text x="116" y="1380">access</text>
                <text x="176" y="1380">control</text>
                <text x="220" y="1380">is</text>
                <text x="272" y="1380">enforced)</text>
                <text x="16" y="1396">M10</text>
                <text x="96" y="1412">ID_CRED_I</text>
                <text x="180" y="1412">identifies</text>
                <text x="108" y="1428">CRED_I</text>
                <text x="144" y="1428">=</text>
                <text x="200" y="1428">AUTH_CRED_C</text>
                <text x="92" y="1444">by</text>
                <text x="144" y="1444">reference</text>
                <text x="84" y="1492">Access</text>
                <text x="124" y="1492">to</text>
                <text x="176" y="1492">protected</text>
                <text x="252" y="1492">resource</text>
                <text x="128" y="1508">(OSCORE-protected</text>
                <text x="236" y="1508">message)</text>
                <text x="88" y="1524">(access</text>
                <text x="152" y="1524">control</text>
                <text x="196" y="1524">is</text>
                <text x="248" y="1524">enforced)</text>
                <text x="16" y="1540">M11</text>
                <text x="92" y="1572">Response</text>
                <text x="128" y="1588">(OSCORE-protected</text>
                <text x="236" y="1588">message)</text>
                <text x="16" y="1604">M12</text>
                <text x="320" y="1620">|</text>
                <text x="64" y="1652">Later</text>
                <text x="104" y="1652">on,</text>
                <text x="136" y="1652">the</text>
                <text x="180" y="1652">access</text>
                <text x="232" y="1652">token</text>
                <text x="288" y="1652">expires</text>
                <text x="336" y="1652">...</text>
                <text x="56" y="1668">-</text>
                <text x="80" y="1668">The</text>
                <text x="124" y="1668">Client</text>
                <text x="168" y="1668">and</text>
                <text x="196" y="1668">RS</text>
                <text x="236" y="1668">delete</text>
                <text x="288" y="1668">their</text>
                <text x="340" y="1668">OSCORE</text>
                <text x="404" y="1668">Security</text>
                <text x="472" y="1668">Context</text>
                <text x="520" y="1668">and</text>
                <text x="88" y="1684">purge</text>
                <text x="128" y="1684">the</text>
                <text x="168" y="1684">EDHOC</text>
                <text x="224" y="1684">session</text>
                <text x="276" y="1684">used</text>
                <text x="308" y="1684">to</text>
                <text x="348" y="1684">derive</text>
                <text x="388" y="1684">it</text>
                <text x="432" y="1684">(unless</text>
                <text x="480" y="1684">the</text>
                <text x="516" y="1684">same</text>
                <text x="96" y="1700">session</text>
                <text x="140" y="1700">is</text>
                <text x="172" y="1700">also</text>
                <text x="212" y="1700">used</text>
                <text x="248" y="1700">for</text>
                <text x="288" y="1700">other</text>
                <text x="352" y="1700">reasons).</text>
                <text x="56" y="1716">-</text>
                <text x="76" y="1716">RS</text>
                <text x="120" y="1716">retains</text>
                <text x="200" y="1716">AUTH_CRED_C</text>
                <text x="260" y="1716">as</text>
                <text x="296" y="1716">still</text>
                <text x="348" y="1716">valid,</text>
                <text x="80" y="1732">and</text>
                <text x="108" y="1732">AS</text>
                <text x="144" y="1732">knows</text>
                <text x="192" y="1732">about</text>
                <text x="232" y="1732">it.</text>
                <text x="56" y="1748">-</text>
                <text x="80" y="1748">The</text>
                <text x="124" y="1748">Client</text>
                <text x="184" y="1748">retains</text>
                <text x="268" y="1748">AUTH_CRED_RS</text>
                <text x="332" y="1748">as</text>
                <text x="368" y="1748">still</text>
                <text x="420" y="1748">valid,</text>
                <text x="80" y="1764">and</text>
                <text x="108" y="1764">AS</text>
                <text x="144" y="1764">knows</text>
                <text x="192" y="1764">about</text>
                <text x="232" y="1764">it.</text>
                <text x="60" y="1844">Time</text>
                <text x="108" y="1844">passes</text>
                <text x="152" y="1844">...</text>
                <text x="56" y="1924">The</text>
                <text x="100" y="1924">Client</text>
                <text x="148" y="1924">asks</text>
                <text x="184" y="1924">for</text>
                <text x="208" y="1924">a</text>
                <text x="232" y="1924">new</text>
                <text x="276" y="1924">access</text>
                <text x="332" y="1924">token;</text>
                <text x="376" y="1924">now</text>
                <text x="408" y="1924">all</text>
                <text x="440" y="1924">the</text>
                <text x="100" y="1940">authentication</text>
                <text x="208" y="1940">credentials</text>
                <text x="272" y="1940">can</text>
                <text x="300" y="1940">be</text>
                <text x="352" y="1940">indicated</text>
                <text x="404" y="1940">by</text>
                <text x="456" y="1940">reference</text>
                <text x="56" y="1972">The</text>
                <text x="96" y="1972">price</text>
                <text x="132" y="1972">to</text>
                <text x="160" y="1972">pay</text>
                <text x="188" y="1972">is</text>
                <text x="212" y="1972">on</text>
                <text x="240" y="1972">AS,</text>
                <text x="280" y="1972">about</text>
                <text x="352" y="1972">remembering</text>
                <text x="420" y="1972">that</text>
                <text x="452" y="1972">at</text>
                <text x="488" y="1972">least</text>
                <text x="56" y="1988">one</text>
                <text x="100" y="1988">access</text>
                <text x="152" y="1988">token</text>
                <text x="192" y="1988">has</text>
                <text x="228" y="1988">been</text>
                <text x="276" y="1988">issued</text>
                <text x="320" y="1988">for</text>
                <text x="352" y="1988">the</text>
                <text x="388" y="1988">pair</text>
                <text x="444" y="1988">(Client,</text>
                <text x="496" y="1988">RS)</text>
                <text x="56" y="2004">and</text>
                <text x="120" y="2004">considering</text>
                <text x="184" y="2004">the</text>
                <text x="220" y="2004">pair</text>
                <text x="296" y="2004">(AUTH_CRED_C,</text>
                <text x="408" y="2004">AUTH_CRED_RS)</text>
                <text x="80" y="2052">Token</text>
                <text x="136" y="2052">request</text>
                <text x="180" y="2052">to</text>
                <text x="220" y="2052">/token</text>
                <text x="128" y="2068">(OSCORE-protected</text>
                <text x="236" y="2068">message)</text>
                <text x="16" y="2084">M13</text>
                <text x="96" y="2100">'req_cnf'</text>
                <text x="180" y="2100">identifies</text>
                <text x="108" y="2116">CRED_I</text>
                <text x="144" y="2116">=</text>
                <text x="200" y="2116">AUTH_CRED_C</text>
                <text x="92" y="2132">by</text>
                <text x="144" y="2132">reference</text>
                <text x="80" y="2180">Token</text>
                <text x="140" y="2180">response</text>
                <text x="128" y="2196">(OSCORE-protected</text>
                <text x="236" y="2196">message)</text>
                <text x="16" y="2212">M14</text>
                <text x="92" y="2228">'rs_cnf'</text>
                <text x="172" y="2228">identifies</text>
                <text x="132" y="2244">AUTH_CRED_RS</text>
                <text x="196" y="2244">by</text>
                <text x="248" y="2244">reference</text>
                <text x="112" y="2276">'ace_profile'</text>
                <text x="208" y="2276">specifies</text>
                <text x="264" y="2276">the</text>
                <text x="72" y="2292">ACE</text>
                <text x="120" y="2292">profile</text>
                <text x="232" y="2292">"coap_edhoc_oscore"</text>
                <text x="108" y="2324">'edhoc_info'</text>
                <text x="204" y="2324">specifies:</text>
                <text x="88" y="2340">{</text>
                <text x="152" y="2356">e'session_id'</text>
                <text x="216" y="2356">:</text>
                <text x="252" y="2356">h'05',</text>
                <text x="164" y="2372">e'cipher_suites'</text>
                <text x="240" y="2372">:</text>
                <text x="260" y="2372">2,</text>
                <text x="140" y="2388">e'methods'</text>
                <text x="192" y="2388">:</text>
                <text x="208" y="2388">3</text>
                <text x="88" y="2404">}</text>
                <text x="68" y="2436">In</text>
                <text x="96" y="2436">the</text>
                <text x="140" y="2436">access</text>
                <text x="196" y="2436">token:</text>
                <text x="64" y="2452">-</text>
                <text x="88" y="2452">the</text>
                <text x="128" y="2452">'cnf'</text>
                <text x="176" y="2452">claim</text>
                <text x="240" y="2452">specifies</text>
                <text x="120" y="2468">AUTH_CRED_C</text>
                <text x="180" y="2468">by</text>
                <text x="232" y="2468">reference</text>
                <text x="64" y="2484">-</text>
                <text x="88" y="2484">the</text>
                <text x="156" y="2484">'edhoc_info'</text>
                <text x="232" y="2484">claim</text>
                <text x="112" y="2500">specifies</text>
                <text x="168" y="2500">the</text>
                <text x="204" y="2500">same</text>
                <text x="236" y="2500">as</text>
                <text x="124" y="2516">'edhoc_info'</text>
                <text x="200" y="2516">above</text>
                <text x="80" y="2564">Token</text>
                <text x="132" y="2564">upload</text>
                <text x="172" y="2564">to</text>
                <text x="232" y="2564">/authz-info</text>
                <text x="108" y="2580">(unprotected</text>
                <text x="196" y="2580">message)</text>
                <text x="16" y="2596">M15</text>
                <text x="76" y="2644">2.01</text>
                <text x="136" y="2644">(Created)</text>
                <text x="108" y="2660">(unprotected</text>
                <text x="196" y="2660">message)</text>
                <text x="16" y="2676">M16</text>
                <text x="80" y="2724">EDHOC</text>
                <text x="144" y="2724">message_1</text>
                <text x="196" y="2724">to</text>
                <text x="236" y="2724">/edhoc</text>
                <text x="72" y="2740">(no</text>
                <text x="116" y="2740">access</text>
                <text x="176" y="2740">control</text>
                <text x="220" y="2740">is</text>
                <text x="272" y="2740">enforced)</text>
                <text x="16" y="2756">M17</text>
                <text x="80" y="2804">EDHOC</text>
                <text x="144" y="2804">message_2</text>
                <text x="72" y="2820">(no</text>
                <text x="116" y="2820">access</text>
                <text x="176" y="2820">control</text>
                <text x="220" y="2820">is</text>
                <text x="272" y="2820">enforced)</text>
                <text x="16" y="2836">M18</text>
                <text x="96" y="2852">ID_CRED_R</text>
                <text x="176" y="2852">specifies</text>
                <text x="108" y="2868">CRED_R</text>
                <text x="144" y="2868">=</text>
                <text x="204" y="2868">AUTH_CRED_RS</text>
                <text x="92" y="2884">by</text>
                <text x="144" y="2884">reference</text>
                <text x="80" y="2932">EDHOC</text>
                <text x="144" y="2932">message_3</text>
                <text x="196" y="2932">to</text>
                <text x="236" y="2932">/edhoc</text>
                <text x="72" y="2948">(no</text>
                <text x="116" y="2948">access</text>
                <text x="176" y="2948">control</text>
                <text x="220" y="2948">is</text>
                <text x="272" y="2948">enforced)</text>
                <text x="16" y="2964">M19</text>
                <text x="96" y="2980">ID_CRED_I</text>
                <text x="180" y="2980">identifies</text>
                <text x="108" y="2996">CRED_I</text>
                <text x="144" y="2996">=</text>
                <text x="200" y="2996">AUTH_CRED_C</text>
                <text x="92" y="3012">by</text>
                <text x="144" y="3012">reference</text>
                <text x="84" y="3060">Access</text>
                <text x="124" y="3060">to</text>
                <text x="176" y="3060">protected</text>
                <text x="252" y="3060">resource</text>
                <text x="300" y="3060">/r</text>
                <text x="128" y="3076">(OSCORE-protected</text>
                <text x="236" y="3076">message)</text>
                <text x="88" y="3092">(access</text>
                <text x="152" y="3092">control</text>
                <text x="196" y="3092">is</text>
                <text x="248" y="3092">enforced)</text>
                <text x="16" y="3108">M20</text>
                <text x="92" y="3156">Response</text>
                <text x="128" y="3172">(OSCORE-protected</text>
                <text x="236" y="3172">message)</text>
                <text x="16" y="3188">M21</text>
                <text x="320" y="3204">|</text>
              </g>
            </svg><a href="#appendix-A.1-2.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-with-optimization">
<section id="appendix-A.2">
        <h3 id="name-workflow-with-optimizations">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-workflow-with-optimizations" class="section-name selfRef">Workflow with Optimizations</a>
        </h3>
<p id="appendix-A.2-1">The example below builds on the example in <a href="#example-without-optimization" class="auto internal xref">Appendix A.1</a>, while additionally relying on the two following optimizations.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-2.1">
            <p id="appendix-A.2-2.1.1">The access token is not separately uploaded to the /authz-info endpoint at RS, but rather included in the EAD_3 field of EDHOC message_3 sent by C to RS.<a href="#appendix-A.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-2.2">
            <p id="appendix-A.2-2.2.1">The Client uses the EDHOC+OSCORE request defined in <span>[<a href="#I-D.ietf-core-oscore-edhoc" class="cite xref">I-D.ietf-core-oscore-edhoc</a>]</span> is used, when running EDHOC both with AS and with RS.<a href="#appendix-A.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.2-3">These two optimizations used together result in the most efficient interaction between C and RS, as consisting of only two roundtrips to upload the access token, run EDHOC and access the protected resource at RS.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<div id="appendix-A.2-4">
          <div class="alignLeft art-svg artwork" id="appendix-A.2-4.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1520" width="576" viewBox="0 0 576 1520" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 40,48 L 40,800" fill="none" stroke="black"></path>
              <path d="M 40,896 L 40,960" fill="none" stroke="black"></path>
              <path d="M 40,1056 L 40,1344" fill="none" stroke="black"></path>
              <path d="M 40,1440 L 40,1504" fill="none" stroke="black"></path>
              <path d="M 320,48 L 320,800" fill="none" stroke="black"></path>
              <path d="M 320,896 L 320,936" fill="none" stroke="black"></path>
              <path d="M 320,1056 L 320,1080" fill="none" stroke="black"></path>
              <path d="M 320,1096 L 320,1192" fill="none" stroke="black"></path>
              <path d="M 320,1208 L 320,1344" fill="none" stroke="black"></path>
              <path d="M 320,1440 L 320,1480" fill="none" stroke="black"></path>
              <path d="M 568,48 L 568,800" fill="none" stroke="black"></path>
              <path d="M 568,896 L 568,960" fill="none" stroke="black"></path>
              <path d="M 568,1056 L 568,1344" fill="none" stroke="black"></path>
              <path d="M 568,1440 L 568,1504" fill="none" stroke="black"></path>
              <path d="M 48,80 L 312,80" fill="none" stroke="black"></path>
              <path d="M 48,144 L 312,144" fill="none" stroke="black"></path>
              <path d="M 48,256 L 312,256" fill="none" stroke="black"></path>
              <path d="M 64,336 L 80,336" fill="none" stroke="black"></path>
              <path d="M 96,336 L 112,336" fill="none" stroke="black"></path>
              <path d="M 128,336 L 144,336" fill="none" stroke="black"></path>
              <path d="M 48,480 L 312,480" fill="none" stroke="black"></path>
              <path d="M 48,944 L 560,944" fill="none" stroke="black"></path>
              <path d="M 48,1088 L 560,1088" fill="none" stroke="black"></path>
              <path d="M 48,1200 L 560,1200" fill="none" stroke="black"></path>
              <path d="M 64,1296 L 80,1296" fill="none" stroke="black"></path>
              <path d="M 96,1296 L 112,1296" fill="none" stroke="black"></path>
              <path d="M 128,1296 L 144,1296" fill="none" stroke="black"></path>
              <path d="M 48,1488 L 560,1488" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="568,1200 556,1194.4 556,1205.6" fill="black" transform="rotate(0,560,1200)"></polygon>
              <polygon class="arrowhead" points="568,944 556,938.4 556,949.6" fill="black" transform="rotate(0,560,944)"></polygon>
              <polygon class="arrowhead" points="320,256 308,250.4 308,261.6" fill="black" transform="rotate(0,312,256)"></polygon>
              <polygon class="arrowhead" points="320,80 308,74.4 308,85.6" fill="black" transform="rotate(0,312,80)"></polygon>
              <polygon class="arrowhead" points="56,1488 44,1482.4 44,1493.6" fill="black" transform="rotate(180,48,1488)"></polygon>
              <polygon class="arrowhead" points="56,1088 44,1082.4 44,1093.6" fill="black" transform="rotate(180,48,1088)"></polygon>
              <polygon class="arrowhead" points="56,480 44,474.4 44,485.6" fill="black" transform="rotate(180,48,480)"></polygon>
              <polygon class="arrowhead" points="56,144 44,138.4 44,149.6" fill="black" transform="rotate(180,48,144)"></polygon>
              <g class="text">
                <text x="40" y="36">C</text>
                <text x="316" y="36">AS</text>
                <text x="564" y="36">RS</text>
                <text x="80" y="68">EDHOC</text>
                <text x="144" y="68">message_1</text>
                <text x="196" y="68">to</text>
                <text x="236" y="68">/edhoc</text>
                <text x="16" y="84">M01</text>
                <text x="80" y="132">EDHOC</text>
                <text x="144" y="132">message_2</text>
                <text x="16" y="148">M02</text>
                <text x="96" y="164">ID_CRED_R</text>
                <text x="180" y="164">identifies</text>
                <text x="108" y="180">CRED_R</text>
                <text x="144" y="180">=</text>
                <text x="204" y="180">AUTH_CRED_AS</text>
                <text x="92" y="196">by</text>
                <text x="144" y="196">reference</text>
                <text x="108" y="244">EDHOC+OSCORE</text>
                <text x="192" y="244">request</text>
                <text x="236" y="244">to</text>
                <text x="276" y="244">/token</text>
                <text x="16" y="260">M03</text>
                <text x="64" y="276">-</text>
                <text x="96" y="276">EDHOC</text>
                <text x="160" y="276">message_3</text>
                <text x="128" y="292">ID_CRED_I</text>
                <text x="212" y="292">identifies</text>
                <text x="140" y="308">CRED_I</text>
                <text x="176" y="308">=</text>
                <text x="232" y="308">AUTH_CRED_C</text>
                <text x="124" y="324">by</text>
                <text x="176" y="324">reference</text>
                <text x="64" y="356">-</text>
                <text x="140" y="356">OSCORE-protected</text>
                <text x="228" y="356">part</text>
                <text x="112" y="372">Token</text>
                <text x="168" y="372">request</text>
                <text x="152" y="388">'req_cnf'</text>
                <text x="236" y="388">identifies</text>
                <text x="160" y="404">AUTH_CRED_C</text>
                <text x="220" y="404">by</text>
                <text x="272" y="404">reference</text>
                <text x="80" y="452">Token</text>
                <text x="140" y="452">response</text>
                <text x="128" y="468">(OSCORE-protected</text>
                <text x="236" y="468">message)</text>
                <text x="16" y="484">M04</text>
                <text x="92" y="500">'rs_cnf'</text>
                <text x="168" y="500">specifies</text>
                <text x="132" y="516">AUTH_CRED_RS</text>
                <text x="196" y="516">by</text>
                <text x="232" y="516">value</text>
                <text x="112" y="548">'ace_profile'</text>
                <text x="208" y="548">specifies</text>
                <text x="264" y="548">the</text>
                <text x="72" y="564">ACE</text>
                <text x="120" y="564">profile</text>
                <text x="232" y="564">"coap_edhoc_oscore"</text>
                <text x="108" y="596">'edhoc_info'</text>
                <text x="204" y="596">specifies:</text>
                <text x="88" y="612">{</text>
                <text x="152" y="628">e'session_id'</text>
                <text x="216" y="628">:</text>
                <text x="252" y="628">h'01',</text>
                <text x="164" y="644">e'cipher_suites'</text>
                <text x="240" y="644">:</text>
                <text x="260" y="644">2,</text>
                <text x="140" y="660">e'methods'</text>
                <text x="192" y="660">:</text>
                <text x="208" y="660">3</text>
                <text x="88" y="676">}</text>
                <text x="68" y="708">In</text>
                <text x="96" y="708">the</text>
                <text x="140" y="708">access</text>
                <text x="196" y="708">token:</text>
                <text x="64" y="724">-</text>
                <text x="88" y="724">the</text>
                <text x="128" y="724">'cnf'</text>
                <text x="176" y="724">claim</text>
                <text x="240" y="724">specifies</text>
                <text x="120" y="740">AUTH_CRED_C</text>
                <text x="180" y="740">by</text>
                <text x="216" y="740">value</text>
                <text x="64" y="756">-</text>
                <text x="88" y="756">the</text>
                <text x="156" y="756">'edhoc_info'</text>
                <text x="232" y="756">claim</text>
                <text x="112" y="772">specifies</text>
                <text x="168" y="772">the</text>
                <text x="204" y="772">same</text>
                <text x="236" y="772">as</text>
                <text x="124" y="788">'edhoc_info'</text>
                <text x="200" y="788">above</text>
                <text x="76" y="836">Possibly</text>
                <text x="136" y="836">after</text>
                <text x="184" y="836">chain</text>
                <text x="264" y="836">verification,</text>
                <text x="336" y="836">the</text>
                <text x="380" y="836">Client</text>
                <text x="428" y="836">adds</text>
                <text x="500" y="836">AUTH_CRED_RS</text>
                <text x="52" y="852">to</text>
                <text x="80" y="852">the</text>
                <text x="112" y="852">set</text>
                <text x="140" y="852">of</text>
                <text x="168" y="852">its</text>
                <text x="216" y="852">trusted</text>
                <text x="268" y="852">peer</text>
                <text x="348" y="852">authentication</text>
                <text x="460" y="852">credentials,</text>
                <text x="72" y="868">relying</text>
                <text x="116" y="868">on</text>
                <text x="140" y="868">AS</text>
                <text x="164" y="868">as</text>
                <text x="208" y="868">trusted</text>
                <text x="276" y="868">provider</text>
                <text x="80" y="916">EDHOC</text>
                <text x="144" y="916">message_1</text>
                <text x="196" y="916">to</text>
                <text x="236" y="916">/edhoc</text>
                <text x="72" y="932">(no</text>
                <text x="116" y="932">access</text>
                <text x="176" y="932">control</text>
                <text x="220" y="932">is</text>
                <text x="272" y="932">enforced)</text>
                <text x="16" y="948">M05</text>
                <text x="320" y="964">|</text>
                <text x="76" y="996">Possibly</text>
                <text x="136" y="996">after</text>
                <text x="184" y="996">chain</text>
                <text x="264" y="996">verification,</text>
                <text x="332" y="996">RS</text>
                <text x="364" y="996">adds</text>
                <text x="432" y="996">AUTH_CRED_C</text>
                <text x="52" y="1012">to</text>
                <text x="80" y="1012">the</text>
                <text x="112" y="1012">set</text>
                <text x="140" y="1012">of</text>
                <text x="168" y="1012">its</text>
                <text x="216" y="1012">trusted</text>
                <text x="268" y="1012">peer</text>
                <text x="348" y="1012">authentication</text>
                <text x="460" y="1012">credentials,</text>
                <text x="72" y="1028">relying</text>
                <text x="116" y="1028">on</text>
                <text x="140" y="1028">AS</text>
                <text x="164" y="1028">as</text>
                <text x="208" y="1028">trusted</text>
                <text x="276" y="1028">provider</text>
                <text x="80" y="1076">EDHOC</text>
                <text x="144" y="1076">message_2</text>
                <text x="16" y="1092">M06</text>
                <text x="96" y="1108">ID_CRED_R</text>
                <text x="180" y="1108">identifies</text>
                <text x="108" y="1124">CRED_R</text>
                <text x="144" y="1124">=</text>
                <text x="204" y="1124">AUTH_CRED_RS</text>
                <text x="92" y="1140">by</text>
                <text x="144" y="1140">reference</text>
                <text x="108" y="1188">EDHOC+OSCORE</text>
                <text x="192" y="1188">request</text>
                <text x="236" y="1188">to</text>
                <text x="260" y="1188">/r</text>
                <text x="16" y="1204">M07</text>
                <text x="64" y="1220">-</text>
                <text x="96" y="1220">EDHOC</text>
                <text x="160" y="1220">message_3</text>
                <text x="112" y="1236">EAD_3</text>
                <text x="172" y="1236">contains</text>
                <text x="236" y="1236">access</text>
                <text x="288" y="1236">token</text>
                <text x="128" y="1252">ID_CRED_I</text>
                <text x="212" y="1252">identifies</text>
                <text x="140" y="1268">CRED_I</text>
                <text x="176" y="1268">=</text>
                <text x="232" y="1268">AUTH_CRED_C</text>
                <text x="124" y="1284">by</text>
                <text x="176" y="1284">reference</text>
                <text x="64" y="1316">-</text>
                <text x="140" y="1316">OSCORE-protected</text>
                <text x="228" y="1316">part</text>
                <text x="136" y="1332">Application</text>
                <text x="216" y="1332">request</text>
                <text x="260" y="1332">to</text>
                <text x="284" y="1332">/r</text>
                <text x="64" y="1380">After</text>
                <text x="104" y="1380">the</text>
                <text x="144" y="1380">EDHOC</text>
                <text x="212" y="1380">processing</text>
                <text x="268" y="1380">is</text>
                <text x="324" y="1380">completed,</text>
                <text x="396" y="1380">access</text>
                <text x="456" y="1380">control</text>
                <text x="52" y="1396">is</text>
                <text x="100" y="1396">enforced</text>
                <text x="148" y="1396">on</text>
                <text x="176" y="1396">the</text>
                <text x="224" y="1396">rebuilt</text>
                <text x="324" y="1396">OSCORE-protected</text>
                <text x="428" y="1396">request,</text>
                <text x="60" y="1412">like</text>
                <text x="92" y="1412">if</text>
                <text x="116" y="1412">it</text>
                <text x="144" y="1412">had</text>
                <text x="180" y="1412">been</text>
                <text x="220" y="1412">sent</text>
                <text x="288" y="1412">stand-alone</text>
                <text x="92" y="1460">Response</text>
                <text x="128" y="1476">(OSCORE-protected</text>
                <text x="236" y="1476">message)</text>
                <text x="16" y="1492">M08</text>
                <text x="320" y="1508">|</text>
              </g>
            </svg><a href="#appendix-A.2-4.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
<div id="sec-profile-requirements">
<section id="appendix-B">
      <h2 id="name-profile-requirements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-profile-requirements" class="section-name selfRef">Profile Requirements</a>
      </h2>
<p id="appendix-B-1">This section lists the specifications of this profile based on the requirements of the framework, as requested in <span><a href="https://rfc-editor.org/rfc/rfc9200#appendix-C" class="relref">Appendix C</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">
          <p id="appendix-B-2.1.1">Optionally, define new methods for the client to discover the necessary permissions and AS for accessing a resource, different from the one proposed in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>: Not specified<a href="#appendix-B-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1">Optionally, specify new grant types: Not specified<a href="#appendix-B-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.3">
          <p id="appendix-B-2.3.1">Optionally, define the use of client certificates as client credential type: C can use authentication credentials of any type admitted by the EDHOC protocol, including public key certificates such as X.509 and C509 certificates.<a href="#appendix-B-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.4">
          <p id="appendix-B-2.4.1">Specify the communication protocol the client and RS must use: CoAP<a href="#appendix-B-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.5">
          <p id="appendix-B-2.5.1">Specify the security protocol the client and RS must use to protect their communication: OSCORE<a href="#appendix-B-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.6">
          <p id="appendix-B-2.6.1">Specify how the client and RS mutually authenticate: Explicitly, by successfully executing the EDHOC protocol, after which a common OSCORE Security Context is exported from the EDHOC session. As per the EDHOC authentication method used during the EDHOC session, authentication is provided by digital signatures, or by Message Authentication Codes (MACs) computed from an ephemeral-static ECDH shared secret.<a href="#appendix-B-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.7">
          <p id="appendix-B-2.7.1">Specify the proof-of-possession protocol(s) and how to select one, if several are available. Also specify which key types (e.g., symmetric/asymmetric) are supported by a specific proof-of-possession protocol: proof-of-possession is first achieved by RS when successfully processing EDHOC message_3 during the EDHOC session with C, through EDHOC algorithms and symmetric EDHOC session keys. Also, proof-of-possession is later achieved by C when receiving from RS: i) the optional EDHOC message_4 during the EDHOC session with RS, through EDHOC algorithms and symmetric EDHOC session keys; or ii) the first response protected with the OSCORE Security Context established after the EDHOC session with RS, through OSCORE algorithms and OSCORE symmetric keys derived from the completed EDHOC session.<a href="#appendix-B-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.8">
          <p id="appendix-B-2.8.1">Specify a unique ace_profile identifier: coap_edhoc_oscore<a href="#appendix-B-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.9">
          <p id="appendix-B-2.9.1">If introspection is supported, specify the communication and security protocol for introspection: HTTP/CoAP (+ TLS/DTLS/OSCORE)<a href="#appendix-B-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.10">
          <p id="appendix-B-2.10.1">Specify the communication and security protocol for interactions between client and AS: HTTP/CoAP (+ TLS/DTLS/OSCORE)<a href="#appendix-B-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.11">
          <p id="appendix-B-2.11.1">Specify if/how the authz-info endpoint is protected, including how error responses are protected: Not protected<a href="#appendix-B-2.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.12">
          <p id="appendix-B-2.12.1">Optionally, define methods of token transport other than the authz-info endpoint: C can upload the access token when executing EDHOC with RS, by including the access token in the EAD_3 field of EDHOC message_3 (see <a href="#edhoc-exec" class="auto internal xref">Section 4.4</a>).<a href="#appendix-B-2.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-cddl-model">
<section id="appendix-C">
      <h2 id="name-cddl-model">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-cddl-model" class="section-name selfRef">CDDL Model</a>
      </h2>
<p id="appendix-C-1">This section is to be removed before publishing as an RFC.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<span id="name-cddl-model-2"></span><div id="fig-cddl-model">
<figure id="figure-7">
        <div class="alignLeft art-CDDL art-text artwork" id="appendix-C-2.1">
<pre>
; ACE Profiles
coap_edhoc_oscore = 4

; OAuth Parameters CBOR Mappings
edhoc_info_param = 47

; CBOR Web Token (CWT) Claims
edhoc_info_claim = 41

; CWT Confirmation Methods
x5chain = 5
x5bag = 6
x5t = 7
x5u = 8
c5c = 9
c5b = 10
c5t = 11
c5u = 12
kcwt = 13
kccs = 14

; EDHOC Information
session_id = 0
methods = 1
cipher_suites = 2
message_4 = 3
comb_req = 4
uri_path = 5
osc_ms_len = 6
osc_salt_len = 7
osc_version = 8
cred_types = 9
id_cred_types = 10
eads = 11
initiator = 12
responder = 13
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-cddl-model-2" class="selfRef">CDDL model</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-D">
      <h2 id="name-document-updates">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-D-1">This section is to be removed before publishing as an RFC.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="sec-04-05">
<section id="appendix-D.1">
        <h3 id="name-version-04-to-05">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.1-1.1">
            <p id="appendix-D.1-1.1.1">CBOR diagnostic notation uses placeholders from a CDDL model.<a href="#appendix-D.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.2">
            <p id="appendix-D.1-1.2.1">Explicit registration policies for the new IANA registry.<a href="#appendix-D.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.3">
            <p id="appendix-D.1-1.3.1">Editorial fixes and improvements.<a href="#appendix-D.1-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-D.2">
        <h3 id="name-version-03-to-04">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.2-1.1">
            <p id="appendix-D.2-1.1.1">Fixed column name and prefilling of the "EDHOC Information" registry.<a href="#appendix-D.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.2">
            <p id="appendix-D.2-1.2.1">Added EDHOC_Information Parameters originally in draft-tiloca-lake-app-profiles-00.<a href="#appendix-D.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.3">
            <p id="appendix-D.2-1.3.1">Removed the case of transporting access token in EAD_1<a href="#appendix-D.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.4">
            <p id="appendix-D.2-1.4.1">Removed redundant normative text<a href="#appendix-D.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.5">
            <p id="appendix-D.2-1.5.1">Clarifications of association between access token, session_id, EDHOC session and OSCORE security context<a href="#appendix-D.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.6">
            <p id="appendix-D.2-1.6.1">Updated references.<a href="#appendix-D.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.2-1.7">
            <p id="appendix-D.2-1.7.1">Editorial fixes and improvements.<a href="#appendix-D.2-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-D.3">
        <h3 id="name-version-02-to-03">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.3-1.1">
            <p id="appendix-D.3-1.1.1">Restructured presentation of content.<a href="#appendix-D.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.2">
            <p id="appendix-D.3-1.2.1">Simplified description of the use of EDHOC_Information.<a href="#appendix-D.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.3">
            <p id="appendix-D.3-1.3.1">Merged the concepts of EDHOC "session_id" and identifier of token series.<a href="#appendix-D.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.4">
            <p id="appendix-D.3-1.4.1">Enabled the transport of the access token also in EDHOC EAD_3.<a href="#appendix-D.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.5">
            <p id="appendix-D.3-1.5.1">Defined semantics of the newly defined CWT/JWT Confirmation Methods.<a href="#appendix-D.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.3-1.6">
            <p id="appendix-D.3-1.6.1">Clarifications and editorial improvements.<a href="#appendix-D.3-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-D.4">
        <h3 id="name-version-01-to-02">
<a href="#appendix-D.4" class="section-number selfRef">D.4. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.4-1.1">
            <p id="appendix-D.4-1.1.1">Removed use of EDHOC_KeyUpdate.<a href="#appendix-D.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.2">
            <p id="appendix-D.4-1.2.1">The Security Context is updated either by KUDOS or a rerun of EDHOC.<a href="#appendix-D.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.3">
            <p id="appendix-D.4-1.3.1">The alternative workflow (AS token posting) is specified in separate draft.<a href="#appendix-D.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.4">
            <p id="appendix-D.4-1.4.1">Fixed and updated examples.<a href="#appendix-D.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.5">
            <p id="appendix-D.4-1.5.1">Editorial improvements.<a href="#appendix-D.4-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-D.5">
        <h3 id="name-version-00-to-01">
<a href="#appendix-D.5" class="section-number selfRef">D.5. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.5-1.1">
            <p id="appendix-D.5-1.1.1">Fixed semantics of the ead_value for transporting an Access Token in the EAD_1 field.<a href="#appendix-D.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.2">
            <p id="appendix-D.5-1.2.1">Error handling aligned with EDHOC.<a href="#appendix-D.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.3">
            <p id="appendix-D.5-1.3.1">Precise characterization of the EDHOC execution considered for EDHOC-KeyUpdate.<a href="#appendix-D.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.4">
            <p id="appendix-D.5-1.4.1">Fixed message exchange examples.<a href="#appendix-D.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.5">
            <p id="appendix-D.5-1.5.1">Added appendix with profile requirements.<a href="#appendix-D.5-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.6">
            <p id="appendix-D.5-1.6.1">Updated references.<a href="#appendix-D.5-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.5-1.7">
            <p id="appendix-D.5-1.7.1">Clarifications and editorial improvements.<a href="#appendix-D.5-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-E">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-E-1">The authors sincerely thank <span class="contact-name">Christian Amsüss</span> and <span class="contact-name">Carsten Bormann</span> for their comments and feedback.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">This work was supported by the Sweden's Innovation Agency VINNOVA within the EUREKA CELTIC-NEXT project CYPRESS; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-E-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Göran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
